"use strict";(self["webpackChunkdans_ma_bulle"]=self["webpackChunkdans_ma_bulle"]||[]).push([[926],{780:function(e,t,n){e.exports=n.p+"90417d4d75a9711f.wasm"},5926:function(e,t,n){n.r(t),n.d(t,{createPdfiumEngine:function(){return U}});n(4114),n(6573),n(8100),n(7936),n(8111),n(2489),n(7588),n(9577),n(1549),n(9797),n(9631),n(5623),n(4603),n(7566),n(8721);var r=(()=>{var e="file:///E:/dev/node_projects/dans-ma-bulle/node_modules/@embedpdf/pdfium/dist/index.browser.js";return async function(t={}){var r,o,a,i=t,s=new Promise((e,t)=>{o=e,a=t});["_EPDF_GetMetaKeyCount","_EPDF_GetMetaKeyName","_EPDF_GetMetaTrapped","_EPDF_GetPageRotationByIndex","_EPDF_HasMetaText","_EPDF_PNG_EncodeRGBA","_EPDF_RenderAnnotBitmap","_EPDF_SetMetaText","_EPDF_SetMetaTrapped","_EPDFAction_CreateGoTo","_EPDFAction_CreateGoToNamed","_EPDFAction_CreateLaunch","_EPDFAction_CreateRemoteGoToByName","_EPDFAction_CreateRemoteGoToDest","_EPDFAction_CreateURI","_EPDFAnnot_ClearColor","_EPDFAnnot_GenerateAppearance","_EPDFAnnot_GenerateAppearanceWithBlend","_EPDFAnnot_GetBlendMode","_EPDFAnnot_GetBorderDashPattern","_EPDFAnnot_GetBorderDashPatternCount","_EPDFAnnot_GetBorderEffect","_EPDFAnnot_GetBorderStyle","_EPDFAnnot_GetColor","_EPDFAnnot_GetDefaultAppearance","_EPDFAnnot_GetIcon","_EPDFAnnot_GetIntent","_EPDFAnnot_GetLineEndings","_EPDFAnnot_GetOpacity","_EPDFAnnot_GetRectangleDifferences","_EPDFAnnot_GetRichContent","_EPDFAnnot_GetTextAlignment","_EPDFAnnot_GetVerticalAlignment","_EPDFAnnot_SetBorderDashPattern","_EPDFAnnot_SetBorderStyle","_EPDFAnnot_SetColor","_EPDFAnnot_SetDefaultAppearance","_EPDFAnnot_SetIcon","_EPDFAnnot_SetIntent","_EPDFAnnot_SetLine","_EPDFAnnot_SetLineEndings","_EPDFAnnot_SetLinkedAnnot","_EPDFAnnot_SetOpacity","_EPDFAnnot_SetTextAlignment","_EPDFAnnot_SetVerticalAlignment","_EPDFAnnot_SetVertices","_EPDFAnnot_UpdateAppearanceToRect","_EPDFAttachment_GetDescription","_EPDFAttachment_GetIntegerValue","_EPDFAttachment_SetDescription","_EPDFAttachment_SetSubtype","_EPDFBookmark_AppendChild","_EPDFBookmark_Clear","_EPDFBookmark_ClearTarget","_EPDFBookmark_Create","_EPDFBookmark_Delete","_EPDFBookmark_InsertAfter","_EPDFBookmark_SetAction","_EPDFBookmark_SetDest","_EPDFBookmark_SetTitle","_EPDFCatalog_GetLanguage","_EPDFDest_CreateRemoteView","_EPDFDest_CreateRemoteXYZ","_EPDFDest_CreateView","_EPDFDest_CreateXYZ","_EPDFNamedDest_Remove","_EPDFNamedDest_SetDest","_EPDFPage_CreateAnnot","_EPDFPage_GetAnnotByName","_EPDFPage_GetAnnotCountRaw","_EPDFPage_GetAnnotRaw","_EPDFPage_RemoveAnnotByName","_EPDFPage_RemoveAnnotRaw","_EPDFText_RedactInQuads","_EPDFText_RedactInRect","_FORM_CanRedo","_FORM_CanUndo","_FORM_DoDocumentAAction","_FORM_DoDocumentJSAction","_FORM_DoDocumentOpenAction","_FORM_DoPageAAction","_FORM_ForceToKillFocus","_FORM_GetFocusedAnnot","_FORM_GetFocusedText","_FORM_GetSelectedText","_FORM_IsIndexSelected","_FORM_OnAfterLoadPage","_FORM_OnBeforeClosePage","_FORM_OnChar","_FORM_OnFocus","_FORM_OnKeyDown","_FORM_OnKeyUp","_FORM_OnLButtonDoubleClick","_FORM_OnLButtonDown","_FORM_OnLButtonUp","_FORM_OnMouseMove","_FORM_OnMouseWheel","_FORM_OnRButtonDown","_FORM_OnRButtonUp","_FORM_Redo","_FORM_ReplaceAndKeepSelection","_FORM_ReplaceSelection","_FORM_SelectAllText","_FORM_SetFocusedAnnot","_FORM_SetIndexSelected","_FORM_Undo","_FPDF_AddInstalledFont","_FPDF_CloseDocument","_FPDF_ClosePage","_FPDF_CloseXObject","_FPDF_CopyViewerPreferences","_FPDF_CountNamedDests","_FPDF_CreateClipPath","_FPDF_CreateNewDocument","_FPDF_DestroyClipPath","_FPDF_DestroyLibrary","_FPDF_DeviceToPage","_FPDF_DocumentHasValidCrossReferenceTable","_FPDF_FFLDraw","_FPDF_FreeDefaultSystemFontInfo","_FPDF_GetDefaultSystemFontInfo","_FPDF_GetDefaultTTFMap","_FPDF_GetDefaultTTFMapCount","_FPDF_GetDefaultTTFMapEntry","_FPDF_GetDocPermissions","_FPDF_GetDocUserPermissions","_FPDF_GetFileIdentifier","_FPDF_GetFileVersion","_FPDF_GetFormType","_FPDF_GetLastError","_FPDF_GetMetaText","_FPDF_GetNamedDest","_FPDF_GetNamedDestByName","_FPDF_GetPageAAction","_FPDF_GetPageBoundingBox","_FPDF_GetPageCount","_FPDF_GetPageHeight","_FPDF_GetPageHeightF","_FPDF_GetPageLabel","_FPDF_GetPageSizeByIndex","_FPDF_GetPageSizeByIndexF","_FPDF_GetPageWidth","_FPDF_GetPageWidthF","_FPDF_GetSecurityHandlerRevision","_FPDF_GetSignatureCount","_FPDF_GetSignatureObject","_FPDF_GetTrailerEnds","_FPDF_GetXFAPacketContent","_FPDF_GetXFAPacketCount","_FPDF_GetXFAPacketName","_FPDF_ImportNPagesToOne","_FPDF_ImportPages","_FPDF_ImportPagesByIndex","_FPDF_InitLibrary","_FPDF_InitLibraryWithConfig","_FPDF_LoadCustomDocument","_FPDF_LoadDocument","_FPDF_LoadMemDocument","_FPDF_LoadMemDocument64","_FPDF_LoadPage","_FPDF_LoadXFA","_FPDF_MovePages","_FPDF_NewFormObjectFromXObject","_FPDF_NewXObjectFromPage","_FPDF_PageToDevice","_FPDF_RemoveFormFieldHighlight","_FPDF_RenderPage_Close","_FPDF_RenderPage_Continue","_FPDF_RenderPageBitmap","_FPDF_RenderPageBitmap_Start","_FPDF_RenderPageBitmapWithColorScheme_Start","_FPDF_RenderPageBitmapWithMatrix","_FPDF_SaveAsCopy","_FPDF_SaveWithVersion","_FPDF_SetFormFieldHighlightAlpha","_FPDF_SetFormFieldHighlightColor","_FPDF_SetSandBoxPolicy","_FPDF_SetSystemFontInfo","_FPDF_StructElement_Attr_CountChildren","_FPDF_StructElement_Attr_GetBlobValue","_FPDF_StructElement_Attr_GetBooleanValue","_FPDF_StructElement_Attr_GetChildAtIndex","_FPDF_StructElement_Attr_GetCount","_FPDF_StructElement_Attr_GetName","_FPDF_StructElement_Attr_GetNumberValue","_FPDF_StructElement_Attr_GetStringValue","_FPDF_StructElement_Attr_GetType","_FPDF_StructElement_Attr_GetValue","_FPDF_StructElement_CountChildren","_FPDF_StructElement_GetActualText","_FPDF_StructElement_GetAltText","_FPDF_StructElement_GetAttributeAtIndex","_FPDF_StructElement_GetAttributeCount","_FPDF_StructElement_GetChildAtIndex","_FPDF_StructElement_GetChildMarkedContentID","_FPDF_StructElement_GetID","_FPDF_StructElement_GetLang","_FPDF_StructElement_GetMarkedContentID","_FPDF_StructElement_GetMarkedContentIdAtIndex","_FPDF_StructElement_GetMarkedContentIdCount","_FPDF_StructElement_GetObjType","_FPDF_StructElement_GetParent","_FPDF_StructElement_GetStringAttribute","_FPDF_StructElement_GetTitle","_FPDF_StructElement_GetType","_FPDF_StructTree_Close","_FPDF_StructTree_CountChildren","_FPDF_StructTree_GetChildAtIndex","_FPDF_StructTree_GetForPage","_FPDF_VIEWERREF_GetDuplex","_FPDF_VIEWERREF_GetName","_FPDF_VIEWERREF_GetNumCopies","_FPDF_VIEWERREF_GetPrintPageRange","_FPDF_VIEWERREF_GetPrintPageRangeCount","_FPDF_VIEWERREF_GetPrintPageRangeElement","_FPDF_VIEWERREF_GetPrintScaling","_FPDFAction_GetDest","_FPDFAction_GetFilePath","_FPDFAction_GetType","_FPDFAction_GetURIPath","_FPDFAnnot_AddFileAttachment","_FPDFAnnot_AddInkStroke","_FPDFAnnot_AppendAttachmentPoints","_FPDFAnnot_AppendObject","_FPDFAnnot_CountAttachmentPoints","_FPDFAnnot_GetAP","_FPDFAnnot_GetAttachmentPoints","_FPDFAnnot_GetBorder","_FPDFAnnot_GetColor","_FPDFAnnot_GetFileAttachment","_FPDFAnnot_GetFlags","_FPDFAnnot_GetFocusableSubtypes","_FPDFAnnot_GetFocusableSubtypesCount","_FPDFAnnot_GetFontColor","_FPDFAnnot_GetFontSize","_FPDFAnnot_GetFormAdditionalActionJavaScript","_FPDFAnnot_GetFormControlCount","_FPDFAnnot_GetFormControlIndex","_FPDFAnnot_GetFormFieldAlternateName","_FPDFAnnot_GetFormFieldAtPoint","_FPDFAnnot_GetFormFieldExportValue","_FPDFAnnot_GetFormFieldFlags","_FPDFAnnot_GetFormFieldName","_FPDFAnnot_GetFormFieldType","_FPDFAnnot_GetFormFieldValue","_FPDFAnnot_GetInkListCount","_FPDFAnnot_GetInkListPath","_FPDFAnnot_GetLine","_FPDFAnnot_GetLink","_FPDFAnnot_GetLinkedAnnot","_FPDFAnnot_GetNumberValue","_FPDFAnnot_GetObject","_FPDFAnnot_GetObjectCount","_FPDFAnnot_GetOptionCount","_FPDFAnnot_GetOptionLabel","_FPDFAnnot_GetRect","_FPDFAnnot_GetStringValue","_FPDFAnnot_GetSubtype","_FPDFAnnot_GetValueType","_FPDFAnnot_GetVertices","_FPDFAnnot_HasAttachmentPoints","_FPDFAnnot_HasKey","_FPDFAnnot_IsChecked","_FPDFAnnot_IsObjectSupportedSubtype","_FPDFAnnot_IsOptionSelected","_FPDFAnnot_IsSupportedSubtype","_FPDFAnnot_RemoveInkList","_FPDFAnnot_RemoveObject","_FPDFAnnot_SetAP","_FPDFAnnot_SetAttachmentPoints","_FPDFAnnot_SetBorder","_FPDFAnnot_SetColor","_FPDFAnnot_SetFlags","_FPDFAnnot_SetFocusableSubtypes","_FPDFAnnot_SetFontColor","_FPDFAnnot_SetFormFieldFlags","_FPDFAnnot_SetRect","_FPDFAnnot_SetStringValue","_FPDFAnnot_SetURI","_FPDFAnnot_UpdateObject","_FPDFAttachment_GetFile","_FPDFAttachment_GetName","_FPDFAttachment_GetStringValue","_FPDFAttachment_GetSubtype","_FPDFAttachment_GetValueType","_FPDFAttachment_HasKey","_FPDFAttachment_SetFile","_FPDFAttachment_SetStringValue","_FPDFAvail_Create","_FPDFAvail_Destroy","_FPDFAvail_GetDocument","_FPDFAvail_GetFirstPageNum","_FPDFAvail_IsDocAvail","_FPDFAvail_IsFormAvail","_FPDFAvail_IsLinearized","_FPDFAvail_IsPageAvail","_FPDFBitmap_Create","_FPDFBitmap_CreateEx","_FPDFBitmap_Destroy","_FPDFBitmap_FillRect","_FPDFBitmap_GetBuffer","_FPDFBitmap_GetFormat","_FPDFBitmap_GetHeight","_FPDFBitmap_GetStride","_FPDFBitmap_GetWidth","_FPDFBookmark_Find","_FPDFBookmark_GetAction","_FPDFBookmark_GetCount","_FPDFBookmark_GetDest","_FPDFBookmark_GetFirstChild","_FPDFBookmark_GetNextSibling","_FPDFBookmark_GetTitle","_FPDFCatalog_IsTagged","_FPDFCatalog_SetLanguage","_FPDFClipPath_CountPaths","_FPDFClipPath_CountPathSegments","_FPDFClipPath_GetPathSegment","_FPDFDest_GetDestPageIndex","_FPDFDest_GetLocationInPage","_FPDFDest_GetView","_FPDFDoc_AddAttachment","_FPDFDoc_CloseJavaScriptAction","_FPDFDoc_DeleteAttachment","_FPDFDOC_ExitFormFillEnvironment","_FPDFDoc_GetAttachment","_FPDFDoc_GetAttachmentCount","_FPDFDoc_GetJavaScriptAction","_FPDFDoc_GetJavaScriptActionCount","_FPDFDoc_GetPageMode","_FPDFDOC_InitFormFillEnvironment","_FPDFFont_Close","_FPDFFont_GetAscent","_FPDFFont_GetBaseFontName","_FPDFFont_GetDescent","_FPDFFont_GetFamilyName","_FPDFFont_GetFlags","_FPDFFont_GetFontData","_FPDFFont_GetGlyphPath","_FPDFFont_GetGlyphWidth","_FPDFFont_GetIsEmbedded","_FPDFFont_GetItalicAngle","_FPDFFont_GetWeight","_FPDFFormObj_CountObjects","_FPDFFormObj_GetObject","_FPDFFormObj_RemoveObject","_FPDFGlyphPath_CountGlyphSegments","_FPDFGlyphPath_GetGlyphPathSegment","_FPDFImageObj_GetBitmap","_FPDFImageObj_GetIccProfileDataDecoded","_FPDFImageObj_GetImageDataDecoded","_FPDFImageObj_GetImageDataRaw","_FPDFImageObj_GetImageFilter","_FPDFImageObj_GetImageFilterCount","_FPDFImageObj_GetImageMetadata","_FPDFImageObj_GetImagePixelSize","_FPDFImageObj_GetRenderedBitmap","_FPDFImageObj_LoadJpegFile","_FPDFImageObj_LoadJpegFileInline","_FPDFImageObj_SetBitmap","_FPDFImageObj_SetMatrix","_FPDFJavaScriptAction_GetName","_FPDFJavaScriptAction_GetScript","_FPDFLink_CloseWebLinks","_FPDFLink_CountQuadPoints","_FPDFLink_CountRects","_FPDFLink_CountWebLinks","_FPDFLink_Enumerate","_FPDFLink_GetAction","_FPDFLink_GetAnnot","_FPDFLink_GetAnnotRect","_FPDFLink_GetDest","_FPDFLink_GetLinkAtPoint","_FPDFLink_GetLinkZOrderAtPoint","_FPDFLink_GetQuadPoints","_FPDFLink_GetRect","_FPDFLink_GetTextRange","_FPDFLink_GetURL","_FPDFLink_LoadWebLinks","_FPDFPage_CloseAnnot","_FPDFPage_CountObjects","_FPDFPage_CreateAnnot","_FPDFPage_Delete","_FPDFPage_Flatten","_FPDFPage_FormFieldZOrderAtPoint","_FPDFPage_GenerateContent","_FPDFPage_GetAnnot","_FPDFPage_GetAnnotCount","_FPDFPage_GetAnnotIndex","_FPDFPage_GetArtBox","_FPDFPage_GetBleedBox","_FPDFPage_GetCropBox","_FPDFPage_GetDecodedThumbnailData","_FPDFPage_GetMediaBox","_FPDFPage_GetObject","_FPDFPage_GetRawThumbnailData","_FPDFPage_GetRotation","_FPDFPage_GetThumbnailAsBitmap","_FPDFPage_GetTrimBox","_FPDFPage_HasFormFieldAtPoint","_FPDFPage_HasTransparency","_FPDFPage_InsertClipPath","_FPDFPage_InsertObject","_FPDFPage_InsertObjectAtIndex","_FPDFPage_New","_FPDFPage_RemoveAnnot","_FPDFPage_RemoveObject","_FPDFPage_SetArtBox","_FPDFPage_SetBleedBox","_FPDFPage_SetCropBox","_FPDFPage_SetMediaBox","_FPDFPage_SetRotation","_FPDFPage_SetTrimBox","_FPDFPage_TransformAnnots","_FPDFPage_TransFormWithClip","_FPDFPageObj_AddMark","_FPDFPageObj_CountMarks","_FPDFPageObj_CreateNewPath","_FPDFPageObj_CreateNewRect","_FPDFPageObj_CreateTextObj","_FPDFPageObj_Destroy","_FPDFPageObj_GetBounds","_FPDFPageObj_GetClipPath","_FPDFPageObj_GetDashArray","_FPDFPageObj_GetDashCount","_FPDFPageObj_GetDashPhase","_FPDFPageObj_GetFillColor","_FPDFPageObj_GetIsActive","_FPDFPageObj_GetLineCap","_FPDFPageObj_GetLineJoin","_FPDFPageObj_GetMark","_FPDFPageObj_GetMarkedContentID","_FPDFPageObj_GetMatrix","_FPDFPageObj_GetRotatedBounds","_FPDFPageObj_GetStrokeColor","_FPDFPageObj_GetStrokeWidth","_FPDFPageObj_GetType","_FPDFPageObj_HasTransparency","_FPDFPageObj_NewImageObj","_FPDFPageObj_NewTextObj","_FPDFPageObj_RemoveMark","_FPDFPageObj_SetBlendMode","_FPDFPageObj_SetDashArray","_FPDFPageObj_SetDashPhase","_FPDFPageObj_SetFillColor","_FPDFPageObj_SetIsActive","_FPDFPageObj_SetLineCap","_FPDFPageObj_SetLineJoin","_FPDFPageObj_SetMatrix","_FPDFPageObj_SetStrokeColor","_FPDFPageObj_SetStrokeWidth","_FPDFPageObj_Transform","_FPDFPageObj_TransformClipPath","_FPDFPageObj_TransformF","_FPDFPageObjMark_CountParams","_FPDFPageObjMark_GetName","_FPDFPageObjMark_GetParamBlobValue","_FPDFPageObjMark_GetParamIntValue","_FPDFPageObjMark_GetParamKey","_FPDFPageObjMark_GetParamStringValue","_FPDFPageObjMark_GetParamValueType","_FPDFPageObjMark_RemoveParam","_FPDFPageObjMark_SetBlobParam","_FPDFPageObjMark_SetIntParam","_FPDFPageObjMark_SetStringParam","_FPDFPath_BezierTo","_FPDFPath_Close","_FPDFPath_CountSegments","_FPDFPath_GetDrawMode","_FPDFPath_GetPathSegment","_FPDFPath_LineTo","_FPDFPath_MoveTo","_FPDFPath_SetDrawMode","_FPDFPathSegment_GetClose","_FPDFPathSegment_GetPoint","_FPDFPathSegment_GetType","_FPDFSignatureObj_GetByteRange","_FPDFSignatureObj_GetContents","_FPDFSignatureObj_GetDocMDPPermission","_FPDFSignatureObj_GetReason","_FPDFSignatureObj_GetSubFilter","_FPDFSignatureObj_GetTime","_FPDFText_ClosePage","_FPDFText_CountChars","_FPDFText_CountRects","_FPDFText_FindClose","_FPDFText_FindNext","_FPDFText_FindPrev","_FPDFText_FindStart","_FPDFText_GetBoundedText","_FPDFText_GetCharAngle","_FPDFText_GetCharBox","_FPDFText_GetCharIndexAtPos","_FPDFText_GetCharIndexFromTextIndex","_FPDFText_GetCharOrigin","_FPDFText_GetFillColor","_FPDFText_GetFontInfo","_FPDFText_GetFontSize","_FPDFText_GetFontWeight","_FPDFText_GetLooseCharBox","_FPDFText_GetMatrix","_FPDFText_GetRect","_FPDFText_GetSchCount","_FPDFText_GetSchResultIndex","_FPDFText_GetStrokeColor","_FPDFText_GetText","_FPDFText_GetTextIndexFromCharIndex","_FPDFText_GetTextObject","_FPDFText_GetUnicode","_FPDFText_HasUnicodeMapError","_FPDFText_IsGenerated","_FPDFText_IsHyphen","_FPDFText_LoadCidType2Font","_FPDFText_LoadFont","_FPDFText_LoadPage","_FPDFText_LoadStandardFont","_FPDFText_SetCharcodes","_FPDFText_SetText","_FPDFTextObj_GetFont","_FPDFTextObj_GetFontSize","_FPDFTextObj_GetRenderedBitmap","_FPDFTextObj_GetText","_FPDFTextObj_GetTextRenderMode","_FPDFTextObj_SetTextRenderMode","_PDFiumExt_CloseFileWriter","_PDFiumExt_CloseFormFillInfo","_PDFiumExt_ExitFormFillEnvironment","_PDFiumExt_GetFileWriterData","_PDFiumExt_GetFileWriterSize","_PDFiumExt_Init","_PDFiumExt_InitFormFillEnvironment","_PDFiumExt_OpenFileWriter","_PDFiumExt_OpenFormFillInfo","_PDFiumExt_SaveAsCopy","_malloc","_free","_memory","___indirect_function_table","onRuntimeInitialized"].forEach(e=>{Object.getOwnPropertyDescriptor(s,e)||Object.defineProperty(s,e,{get:()=>q("You are getting "+e+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js"),set:()=>q("You are setting "+e+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")})});var u="object"==typeof window,m="function"==typeof importScripts;"object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node&&process.type;var F,l,d,_=!u&&!m,c=Object.assign({},i),P="./this.program",g="";function h(e){return i["locateFile"]?i["locateFile"](e,g):g+e}if(_){if("object"==typeof process&&"function"===typeof F||"object"==typeof window||"function"==typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");d=e=>{if("function"==typeof readbuffer)return new Uint8Array(readbuffer(e));let t=read(e,"binary");return v("object"==typeof t),t},l=e=>new Promise((t,n)=>{setTimeout(()=>t(d(e)))}),globalThis.clearTimeout??=e=>{},globalThis.setTimeout??=e=>"function"==typeof e?e():q(),"undefined"!=typeof print&&(globalThis.console??={},console.log=print,console.warn=console.error=globalThis.printErr??print)}else{if(!u&&!m)throw new Error("environment detection error");if(m?g=self.location.href:"undefined"!=typeof document&&document.currentScript&&(g=document.currentScript.src),e&&(g=e),g=g.startsWith("blob:")?"":g.substr(0,g.replace(/[?#].*/,"").lastIndexOf("/")+1),"object"!=typeof window&&"function"!=typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");m&&(d=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),l=e=>(v(!oe(e),"readAsync does not work with file:// URLs"),fetch(e,{credentials:"same-origin"}).then(e=>e.ok?e.arrayBuffer():Promise.reject(new Error(e.status+" : "+e.url))))}var D=i["print"]||console.log.bind(console),b=i["printErr"]||console.error.bind(console);Object.assign(i,c),c=null,Pn(),i["arguments"]&&i["arguments"],_e("arguments","arguments_"),i["thisProgram"]&&(P=i["thisProgram"]),_e("thisProgram","thisProgram"),v("undefined"==typeof i["memoryInitializerPrefixURL"],"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),v("undefined"==typeof i["pthreadMainPrefixURL"],"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),v("undefined"==typeof i["cdInitializerPrefixURL"],"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),v("undefined"==typeof i["filePackagePrefixURL"],"Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),v("undefined"==typeof i["read"],"Module.read option was removed"),v("undefined"==typeof i["readAsync"],"Module.readAsync option was removed (modify readAsync in JS)"),v("undefined"==typeof i["readBinary"],"Module.readBinary option was removed (modify readBinary in JS)"),v("undefined"==typeof i["setWindowTitle"],"Module.setWindowTitle option was removed (modify emscripten_set_window_title in JS)"),v("undefined"==typeof i["TOTAL_MEMORY"],"Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),_e("asm","wasmExports"),_e("readAsync","readAsync"),_e("readBinary","readBinary"),_e("setWindowTitle","setWindowTitle");var f,p=i["wasmBinary"];_e("wasmBinary","wasmBinary"),"object"!=typeof WebAssembly&&b("no native wasm support detected");var A,E,y,M,G,C,S,T,x=!1;function v(e,t){e||q("Assertion failed"+(t?": "+t:""))}function O(){var e=f.buffer;i["HEAP8"]=A=new Int8Array(e),i["HEAP16"]=y=new Int16Array(e),i["HEAPU8"]=E=new Uint8Array(e),i["HEAPU16"]=M=new Uint16Array(e),i["HEAP32"]=G=new Int32Array(e),i["HEAPU32"]=C=new Uint32Array(e),i["HEAPF32"]=S=new Float32Array(e),i["HEAPF64"]=T=new Float64Array(e)}function w(){var e=En();v(0==(3&e)),0==e&&(e+=4),C[e>>2]=34821223,C[e+4>>2]=2310721022,C[0]=1668509029}function k(){if(!x){var e=En();0==e&&(e+=4);var t=C[e>>2],n=C[e+4>>2];34821223==t&&2310721022==n||q(`Stack overflow! Stack cookie has been overwritten at ${Ae(e)}, expected hex dwords 0x89BACDFE and 0x2135467, but received ${Ae(n)} ${Ae(t)}`),1668509029!=C[0]&&q("Runtime error: The application has corrupted its heap memory area (address zero)!")}}v(!i["STACK_SIZE"],"STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time"),v("undefined"!=typeof Int32Array&&"undefined"!==typeof Float64Array&&void 0!=Int32Array.prototype.subarray&&void 0!=Int32Array.prototype.set,"JS engine does not provide full typed array support"),v(!i["wasmMemory"],"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally"),v(!i["INITIAL_MEMORY"],"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically");var R=[],I=[],j=[],B=!1;function L(){var e=i["preRun"];e&&("function"==typeof e&&(e=[e]),e.forEach(U)),fe(R)}function N(){v(!B),B=!0,k(),i["noFSInit"]||nt.initialized||nt.init(),nt.ignorePermissions=!1,fe(I)}function V(){k();var e=i["postRun"];e&&("function"==typeof e&&(e=[e]),e.forEach(z)),fe(j)}function U(e){R.unshift(e)}function W(e){I.unshift(e)}function z(e){j.unshift(e)}v(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),v(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),v(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),v(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var $=0,H=null,X=null,Y={};function K(e){var t=e;while(1){if(!Y[e])return e;e=t+Math.random()}}function J(e){$++,i["monitorRunDependencies"]?.($),e?(v(!Y[e]),Y[e]=1,null===H&&"undefined"!=typeof setInterval&&(H=setInterval(()=>{if(x)return clearInterval(H),void(H=null);var e=!1;for(var t in Y)e||(e=!0,b("still waiting on run dependencies:")),b(`dependency: ${t}`);e&&b("(end of list)")},1e4))):b("warning: run dependency added without ID")}function Z(e){if($--,i["monitorRunDependencies"]?.($),e?(v(Y[e]),delete Y[e]):b("warning: run dependency removed without ID"),0==$&&(null!==H&&(clearInterval(H),H=null),X)){var t=X;X=null,t()}}function q(e){i["onAbort"]?.(e),e="Aborted("+e+")",b(e),x=!0;var t=new WebAssembly.RuntimeError(e);throw a(t),t}var Q,ee,te,ne="data:application/octet-stream;base64,",re=e=>e.startsWith(ne),oe=e=>e.startsWith("file://");function ae(e,t){return(...n)=>{v(B,`native function \`${e}\` called before runtime initialization`);var r=hn[e];return v(r,`exported native function \`${e}\` not found`),v(n.length<=t,`native function \`${e}\` called with ${n.length} args but expects ${t}`),r(...n)}}function ie(){if(i["locateFile"]){var e="pdfium.wasm";return re(e)?e:h(e)}return _?"pdfium.wasm":new URL(n(780),n.b).href}function se(e){if(e==Q&&p)return new Uint8Array(p);if(d)return d(e);throw"both async and sync fetching of the wasm failed"}function ue(e){return p?Promise.resolve().then(()=>se(e)):l(e).then(e=>new Uint8Array(e),()=>se(e))}function me(e,t,n){return ue(e).then(e=>WebAssembly.instantiate(e,t)).then(n,e=>{b(`failed to asynchronously prepare wasm: ${e}`),oe(Q)&&b(`warning: Loading from a file URI (${Q}) is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing`),q(e)})}function Fe(e,t,n,r){return e||"function"!=typeof WebAssembly.instantiateStreaming||re(t)||"function"!=typeof fetch?me(t,n,r):fetch(t,{credentials:"same-origin"}).then(e=>{var o=WebAssembly.instantiateStreaming(e,n);return o.then(r,function(e){return b(`wasm streaming compile failed: ${e}`),b("falling back to ArrayBuffer instantiation"),me(t,n,r)})})}function le(){return{env:gn,wasi_snapshot_preview1:gn}}function de(){var e=le();function t(e,t){return hn=e.exports,i["wasmExports"]=hn,f=hn["memory"],v(f,"memory not found in wasm exports"),O(),zt=hn["__indirect_function_table"],v(zt,"table not found in wasm exports"),W(hn["__wasm_call_ctors"]),Z("wasm-instantiate"),hn}J("wasm-instantiate");var n=i;function r(e){v(i===n,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),n=null,t(e["instance"])}if(i["instantiateWasm"])try{return i["instantiateWasm"](e,t)}catch(o){b(`Module.instantiateWasm callback failed with error: ${o}`),a(o)}return Q??=ie(),Fe(p,Q,e,r).catch(a),{}}if((()=>{var e=new Int16Array(1),t=new Int8Array(e.buffer);if(e[0]=25459,115!==t[0]||99!==t[1])throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)"})(),i["ENVIRONMENT"])throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)");function _e(e,t,n=!0){Object.getOwnPropertyDescriptor(i,e)||Object.defineProperty(i,e,{configurable:!0,get(){let r=n?" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)":"";q(`\`Module.${e}\` has been replaced by \`${t}\``+r)}})}function ce(e){Object.getOwnPropertyDescriptor(i,e)&&q(`\`Module.${e}\` was supplied but \`${e}\` not included in INCOMING_MODULE_JS_API`)}function Pe(e){return"FS_createPath"===e||"FS_createDataFile"===e||"FS_createPreloadedFile"===e||"FS_unlink"===e||"addRunDependency"===e||"FS_createLazyFile"===e||"FS_createDevice"===e||"removeRunDependency"===e}function ge(e,t){"undefined"==typeof globalThis||Object.getOwnPropertyDescriptor(globalThis,e)||Object.defineProperty(globalThis,e,{configurable:!0,get(){t()}})}function he(e,t){ge(e,()=>{Ge(`\`${e}\` is not longer defined by emscripten. ${t}`)})}function De(e){ge(e,()=>{var t=`\`${e}\` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line`,n=e;n.startsWith("_")||(n="$"+e),t+=` (e.g. -sDEFAULT_LIBRARY_FUNCS_TO_INCLUDE='${n}')`,Pe(e)&&(t+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),Ge(t)}),be(e)}function be(e){Object.getOwnPropertyDescriptor(i,e)||Object.defineProperty(i,e,{configurable:!0,get(){var t=`'${e}' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)`;Pe(e)&&(t+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),q(t)}})}he("buffer","Please use HEAP8.buffer or wasmMemory.buffer"),he("asm","Please use wasmExports instead");var fe=e=>{e.forEach(e=>e(i))};function pe(e,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":return A[e];case"i8":return A[e];case"i16":return y[e>>1];case"i32":return G[e>>2];case"i64":q("to do getValue(i64) use WASM_BIGINT");case"float":return S[e>>2];case"double":return T[e>>3];case"*":return C[e>>2];default:q(`invalid type for getValue: ${t}`)}}i["noExitRuntime"];var Ae=e=>(v("number"===typeof e),e>>>=0,"0x"+e.toString(16).padStart(8,"0"));function Ee(e,t,n="i8"){switch(n.endsWith("*")&&(n="*"),n){case"i1":A[e]=t;break;case"i8":A[e]=t;break;case"i16":y[e>>1]=t;break;case"i32":G[e>>2]=t;break;case"i64":q("to do setValue(i64) use WASM_BIGINT");case"float":S[e>>2]=t;break;case"double":T[e>>3]=t;break;case"*":C[e>>2]=t;break;default:q(`invalid type for setValue: ${n}`)}}var ye=e=>yn(e),Me=()=>Gn(),Ge=e=>{Ge.shown||={},Ge.shown[e]||(Ge.shown[e]=1,b(e))},Ce="undefined"!=typeof TextDecoder?new TextDecoder:void 0,Se=(e,t=0,n=NaN)=>{var r=t+n,o=t;while(e[o]&&!(o>=r))++o;if(o-t>16&&e.buffer&&Ce)return Ce.decode(e.subarray(t,o));var a="";while(t<o){var i=e[t++];if(128&i){var s=63&e[t++];if(192!=(224&i)){var u=63&e[t++];if(224==(240&i)?i=(15&i)<<12|s<<6|u:(240!=(248&i)&&Ge("Invalid UTF-8 leading byte "+Ae(i)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),i=(7&i)<<18|s<<12|u<<6|63&e[t++]),i<65536)a+=String.fromCharCode(i);else{var m=i-65536;a+=String.fromCharCode(55296|m>>10,56320|1023&m)}}else a+=String.fromCharCode((31&i)<<6|s)}else a+=String.fromCharCode(i)}return a},Te=(e,t)=>(v("number"==typeof e,`UTF8ToString expects a number (got ${typeof e})`),e?Se(E,e,t):""),xe=(e,t,n,r)=>{q(`Assertion failed: ${Te(e)}, at: `+[t?Te(t):"unknown filename",n,r?Te(r):"unknown function"])};function ve(){v(void 0!=rt.varargs);var e=G[+rt.varargs>>2];return rt.varargs+=4,e}var Oe=ve,we={isAbs:e=>"/"===e.charAt(0),splitPath:e=>{var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return t.exec(e).slice(1)},normalizeArray:(e,t)=>{for(var n=0,r=e.length-1;r>=0;r--){var o=e[r];"."===o?e.splice(r,1):".."===o?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n;n--)e.unshift("..");return e},normalize:e=>{var t=we.isAbs(e),n="/"===e.substr(-1);return e=we.normalizeArray(e.split("/").filter(e=>!!e),!t).join("/"),e||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=we.splitPath(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},basename:e=>{if("/"===e)return"/";e=we.normalize(e),e=e.replace(/\/$/,"");var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)},join:(...e)=>we.normalize(e.join("/")),join2:(e,t)=>we.normalize(e+"/"+t)},ke=()=>{if("object"==typeof crypto&&"function"==typeof crypto["getRandomValues"])return e=>crypto.getRandomValues(e);q("no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: (array) => { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };")},Re=e=>(Re=ke())(e),Ie={resolve:(...e)=>{for(var t="",n=!1,r=e.length-1;r>=-1&&!n;r--){var o=r>=0?e[r]:nt.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");if(!o)return"";t=o+"/"+t,n=we.isAbs(o)}return t=we.normalizeArray(t.split("/").filter(e=>!!e),!n).join("/"),(n?"/":"")+t||"."},relative:(e,t)=>{function n(e){for(var t=0;t<e.length;t++)if(""!==e[t])break;for(var n=e.length-1;n>=0;n--)if(""!==e[n])break;return t>n?[]:e.slice(t,n-t+1)}e=Ie.resolve(e).substr(1),t=Ie.resolve(t).substr(1);for(var r=n(e.split("/")),o=n(t.split("/")),a=Math.min(r.length,o.length),i=a,s=0;s<a;s++)if(r[s]!==o[s]){i=s;break}var u=[];for(s=i;s<r.length;s++)u.push("..");return u=u.concat(o.slice(i)),u.join("/")}},je=[],Be=e=>{for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r<=127?t++:r<=2047?t+=2:r>=55296&&r<=57343?(t+=4,++n):t+=3}return t},Le=(e,t,n,r)=>{if(v("string"===typeof e,`stringToUTF8Array expects a string (got ${typeof e})`),!(r>0))return 0;for(var o=n,a=n+r-1,i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s>=55296&&s<=57343){var u=e.charCodeAt(++i);s=65536+((1023&s)<<10)|1023&u}if(s<=127){if(n>=a)break;t[n++]=s}else if(s<=2047){if(n+1>=a)break;t[n++]=192|s>>6,t[n++]=128|63&s}else if(s<=65535){if(n+2>=a)break;t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s}else{if(n+3>=a)break;s>1114111&&Ge("Invalid Unicode code point "+Ae(s)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF)."),t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}}return t[n]=0,n-o};function Ne(e,t,n){var r=Be(e)+1,o=new Array(r),a=Le(e,o,0,o.length);return o.length=a,o}var Ve=()=>{if(!je.length){var e=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?(e=window.prompt("Input: "),null!==e&&(e+="\n")):"function"==typeof readline&&(e=readline(),e&&(e+="\n")),!e)return null;je=Ne(e)}return je.shift()},Ue={ttys:[],init(){},shutdown(){},register(e,t){Ue.ttys[e]={input:[],output:[],ops:t},nt.registerDevice(e,Ue.stream_ops)},stream_ops:{open(e){var t=Ue.ttys[e.node.rdev];if(!t)throw new nt.ErrnoError(43);e.tty=t,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,n,r,o){if(!e.tty||!e.tty.ops.get_char)throw new nt.ErrnoError(60);for(var a=0,i=0;i<r;i++){var s;try{s=e.tty.ops.get_char(e.tty)}catch(u){throw new nt.ErrnoError(29)}if(void 0===s&&0===a)throw new nt.ErrnoError(6);if(null===s||void 0===s)break;a++,t[n+i]=s}return a&&(e.node.timestamp=Date.now()),a},write(e,t,n,r,o){if(!e.tty||!e.tty.ops.put_char)throw new nt.ErrnoError(60);try{for(var a=0;a<r;a++)e.tty.ops.put_char(e.tty,t[n+a])}catch(i){throw new nt.ErrnoError(29)}return r&&(e.node.timestamp=Date.now()),a}},default_tty_ops:{get_char(e){return Ve()},put_char(e,t){null===t||10===t?(D(Se(e.output)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(D(Se(e.output)),e.output=[])},ioctl_tcgets(e){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(e,t,n){return 0},ioctl_tiocgwinsz(e){return[24,80]}},default_tty1_ops:{put_char(e,t){null===t||10===t?(b(Se(e.output)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(b(Se(e.output)),e.output=[])}}},We=(e,t)=>{E.fill(0,e,e+t)},ze=(e,t)=>(v(t,"alignment argument is required"),Math.ceil(e/t)*t),$e=e=>{e=ze(e,65536);var t=bn(65536,e);return t&&We(t,e),t},He={ops_table:null,mount(e){return He.createNode(null,"/",16895,0)},createNode(e,t,n,r){if(nt.isBlkdev(n)||nt.isFIFO(n))throw new nt.ErrnoError(63);He.ops_table||={dir:{node:{getattr:He.node_ops.getattr,setattr:He.node_ops.setattr,lookup:He.node_ops.lookup,mknod:He.node_ops.mknod,rename:He.node_ops.rename,unlink:He.node_ops.unlink,rmdir:He.node_ops.rmdir,readdir:He.node_ops.readdir,symlink:He.node_ops.symlink},stream:{llseek:He.stream_ops.llseek}},file:{node:{getattr:He.node_ops.getattr,setattr:He.node_ops.setattr},stream:{llseek:He.stream_ops.llseek,read:He.stream_ops.read,write:He.stream_ops.write,allocate:He.stream_ops.allocate,mmap:He.stream_ops.mmap,msync:He.stream_ops.msync}},link:{node:{getattr:He.node_ops.getattr,setattr:He.node_ops.setattr,readlink:He.node_ops.readlink},stream:{}},chrdev:{node:{getattr:He.node_ops.getattr,setattr:He.node_ops.setattr},stream:nt.chrdev_stream_ops}};var o=nt.createNode(e,t,n,r);return nt.isDir(o.mode)?(o.node_ops=He.ops_table.dir.node,o.stream_ops=He.ops_table.dir.stream,o.contents={}):nt.isFile(o.mode)?(o.node_ops=He.ops_table.file.node,o.stream_ops=He.ops_table.file.stream,o.usedBytes=0,o.contents=null):nt.isLink(o.mode)?(o.node_ops=He.ops_table.link.node,o.stream_ops=He.ops_table.link.stream):nt.isChrdev(o.mode)&&(o.node_ops=He.ops_table.chrdev.node,o.stream_ops=He.ops_table.chrdev.stream),o.timestamp=Date.now(),e&&(e.contents[t]=o,e.timestamp=o.timestamp),o},getFileDataAsTypedArray(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage(e,t){var n=e.contents?e.contents.length:0;if(!(n>=t)){var r=1048576;t=Math.max(t,n*(n<r?2:1.125)>>>0),0!=n&&(t=Math.max(t,256));var o=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(o.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var n=e.contents;e.contents=new Uint8Array(t),n&&e.contents.set(n.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr(e){var t={};return t.dev=nt.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,nt.isDir(e.mode)?t.size=4096:nt.isFile(e.mode)?t.size=e.usedBytes:nt.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&He.resizeFileStorage(e,t.size)},lookup(e,t){throw nt.genericErrors[44]},mknod(e,t,n,r){return He.createNode(e,t,n,r)},rename(e,t,n){if(nt.isDir(e.mode)){var r;try{r=nt.lookupNode(t,n)}catch(a){}if(r)for(var o in r.contents)throw new nt.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=n,t.contents[n]=e,t.timestamp=e.parent.timestamp},unlink(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir(e,t){var n=nt.lookupNode(e,t);for(var r in n.contents)throw new nt.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir(e){var t=[".",".."];for(var n of Object.keys(e.contents))t.push(n);return t},symlink(e,t,n){var r=He.createNode(e,t,41471,0);return r.link=n,r},readlink(e){if(!nt.isLink(e.mode))throw new nt.ErrnoError(28);return e.link}},stream_ops:{read(e,t,n,r,o){var a=e.node.contents;if(o>=e.node.usedBytes)return 0;var i=Math.min(e.node.usedBytes-o,r);if(v(i>=0),i>8&&a.subarray)t.set(a.subarray(o,o+i),n);else for(var s=0;s<i;s++)t[n+s]=a[o+s];return i},write(e,t,n,r,o,a){if(v(!(t instanceof ArrayBuffer)),t.buffer===A.buffer&&(a=!1),!r)return 0;var i=e.node;if(i.timestamp=Date.now(),t.subarray&&(!i.contents||i.contents.subarray)){if(a)return v(0===o,"canOwn must imply no weird position inside the file"),i.contents=t.subarray(n,n+r),i.usedBytes=r,r;if(0===i.usedBytes&&0===o)return i.contents=t.slice(n,n+r),i.usedBytes=r,r;if(o+r<=i.usedBytes)return i.contents.set(t.subarray(n,n+r),o),r}if(He.expandFileStorage(i,o+r),i.contents.subarray&&t.subarray)i.contents.set(t.subarray(n,n+r),o);else for(var s=0;s<r;s++)i.contents[o+s]=t[n+s];return i.usedBytes=Math.max(i.usedBytes,o+r),r},llseek(e,t,n){var r=t;if(1===n?r+=e.position:2===n&&nt.isFile(e.node.mode)&&(r+=e.node.usedBytes),r<0)throw new nt.ErrnoError(28);return r},allocate(e,t,n){He.expandFileStorage(e.node,t+n),e.node.usedBytes=Math.max(e.node.usedBytes,t+n)},mmap(e,t,n,r,o){if(!nt.isFile(e.node.mode))throw new nt.ErrnoError(43);var a,i,s=e.node.contents;if(2&o||!s||s.buffer!==A.buffer){if(i=!0,a=$e(t),!a)throw new nt.ErrnoError(48);s&&((n>0||n+t<s.length)&&(s=s.subarray?s.subarray(n,n+t):Array.prototype.slice.call(s,n,n+t)),A.set(s,a))}else i=!1,a=s.byteOffset;return{ptr:a,allocated:i}},msync(e,t,n,r,o){return He.stream_ops.write(e,t,0,r,n,!1),0}}},Xe=(e,t,n,r)=>{var o=K(`al ${e}`);l(e).then(n=>{v(n,`Loading data file "${e}" failed (no arrayBuffer).`),t(new Uint8Array(n)),o&&Z(o)},t=>{if(!n)throw`Loading data file "${e}" failed.`;n()}),o&&J(o)},Ye=(e,t,n,r,o,a)=>{nt.createDataFile(e,t,n,r,o,a)},Ke=i["preloadPlugins"]||[],Je=(e,t,n,r)=>{"undefined"!=typeof Browser&&Browser.init();var o=!1;return Ke.forEach(a=>{o||a["canHandle"](t)&&(a["handle"](e,t,n,r),o=!0)}),o},Ze=(e,t,n,r,o,a,i,s,u,m)=>{var F=t?Ie.resolve(we.join2(e,t)):e,l=K(`cp ${F}`);function d(n){function d(n){m?.(),s||Ye(e,t,n,r,o,u),a?.(),Z(l)}Je(n,F,d,()=>{i?.(),Z(l)})||d(n)}J(l),"string"==typeof n?Xe(n,d,i):d(n)},qe=e=>{var t={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},n=t[e];if("undefined"==typeof n)throw new Error(`Unknown file open mode: ${e}`);return n},Qe=(e,t)=>{var n=0;return e&&(n|=365),t&&(n|=146),n},et=e=>Te(fn(e)),tt={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135},nt={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:class extends Error{constructor(e){for(var t in super(B?et(e):""),this.name="ErrnoError",this.errno=e,tt)if(tt[t]===e){this.code=t;break}}},genericErrors:{},filesystems:null,syncFSRequests:0,readFiles:{},FSStream:class{constructor(){this.shared={}}get object(){return this.node}set object(e){this.node=e}get isRead(){return 1!==(2097155&this.flags)}get isWrite(){return 0!==(2097155&this.flags)}get isAppend(){return 1024&this.flags}get flags(){return this.shared.flags}set flags(e){this.shared.flags=e}get position(){return this.shared.position}set position(e){this.shared.position=e}},FSNode:class{constructor(e,t,n,r){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=nt.nextInode++,this.name=t,this.mode=n,this.node_ops={},this.stream_ops={},this.rdev=r,this.readMode=365,this.writeMode=146}get read(){return(this.mode&this.readMode)===this.readMode}set read(e){e?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(e){e?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return nt.isDir(this.mode)}get isDevice(){return nt.isChrdev(this.mode)}},lookupPath(e,t={}){if(e=Ie.resolve(e),!e)return{path:"",node:null};var n={follow_mount:!0,recurse_count:0};if(t=Object.assign(n,t),t.recurse_count>8)throw new nt.ErrnoError(32);for(var r=e.split("/").filter(e=>!!e),o=nt.root,a="/",i=0;i<r.length;i++){var s=i===r.length-1;if(s&&t.parent)break;if(o=nt.lookupNode(o,r[i]),a=we.join2(a,r[i]),nt.isMountpoint(o)&&(!s||s&&t.follow_mount)&&(o=o.mounted.root),!s||t.follow){var u=0;while(nt.isLink(o.mode)){var m=nt.readlink(a);a=Ie.resolve(we.dirname(a),m);var F=nt.lookupPath(a,{recurse_count:t.recurse_count+1});if(o=F.node,u++>40)throw new nt.ErrnoError(32)}}}return{path:a,node:o}},getPath(e){var t;while(1){if(nt.isRoot(e)){var n=e.mount.mountpoint;return t?"/"!==n[n.length-1]?`${n}/${t}`:n+t:n}t=t?`${e.name}/${t}`:e.name,e=e.parent}},hashName(e,t){for(var n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r)|0;return(e+n>>>0)%nt.nameTable.length},hashAddNode(e){var t=nt.hashName(e.parent.id,e.name);e.name_next=nt.nameTable[t],nt.nameTable[t]=e},hashRemoveNode(e){var t=nt.hashName(e.parent.id,e.name);if(nt.nameTable[t]===e)nt.nameTable[t]=e.name_next;else{var n=nt.nameTable[t];while(n){if(n.name_next===e){n.name_next=e.name_next;break}n=n.name_next}}},lookupNode(e,t){var n=nt.mayLookup(e);if(n)throw new nt.ErrnoError(n);for(var r=nt.hashName(e.id,t),o=nt.nameTable[r];o;o=o.name_next){var a=o.name;if(o.parent.id===e.id&&a===t)return o}return nt.lookup(e,t)},createNode(e,t,n,r){v("object"==typeof e);var o=new nt.FSNode(e,t,n,r);return nt.hashAddNode(o),o},destroyNode(e){nt.hashRemoveNode(e)},isRoot(e){return e===e.parent},isMountpoint(e){return!!e.mounted},isFile(e){return 32768===(61440&e)},isDir(e){return 16384===(61440&e)},isLink(e){return 40960===(61440&e)},isChrdev(e){return 8192===(61440&e)},isBlkdev(e){return 24576===(61440&e)},isFIFO(e){return 4096===(61440&e)},isSocket(e){return 49152===(49152&e)},flagsToPermissionString(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions(e,t){return nt.ignorePermissions||(!t.includes("r")||292&e.mode)&&(!t.includes("w")||146&e.mode)&&(!t.includes("x")||73&e.mode)?0:2},mayLookup(e){if(!nt.isDir(e.mode))return 54;var t=nt.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate(e,t){try{nt.lookupNode(e,t);return 20}catch(n){}return nt.nodePermissions(e,"wx")},mayDelete(e,t,n){var r;try{r=nt.lookupNode(e,t)}catch(a){return a.errno}var o=nt.nodePermissions(e,"wx");if(o)return o;if(n){if(!nt.isDir(r.mode))return 54;if(nt.isRoot(r)||nt.getPath(r)===nt.cwd())return 10}else if(nt.isDir(r.mode))return 31;return 0},mayOpen(e,t){return e?nt.isLink(e.mode)?32:nt.isDir(e.mode)&&("r"!==nt.flagsToPermissionString(t)||512&t)?31:nt.nodePermissions(e,nt.flagsToPermissionString(t)):44},MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=nt.MAX_OPEN_FDS;e++)if(!nt.streams[e])return e;throw new nt.ErrnoError(33)},getStreamChecked(e){var t=nt.getStream(e);if(!t)throw new nt.ErrnoError(8);return t},getStream:e=>nt.streams[e],createStream(e,t=-1){return v(t>=-1),e=Object.assign(new nt.FSStream,e),-1==t&&(t=nt.nextfd()),e.fd=t,nt.streams[t]=e,e},closeStream(e){nt.streams[e]=null},dupStream(e,t=-1){var n=nt.createStream(e,t);return n.stream_ops?.dup?.(n),n},chrdev_stream_ops:{open(e){var t=nt.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open?.(e)},llseek(){throw new nt.ErrnoError(70)}},major:e=>e>>8,minor:e=>255&e,makedev:(e,t)=>e<<8|t,registerDevice(e,t){nt.devices[e]={stream_ops:t}},getDevice:e=>nt.devices[e],getMounts(e){var t=[],n=[e];while(n.length){var r=n.pop();t.push(r),n.push(...r.mounts)}return t},syncfs(e,t){"function"==typeof e&&(t=e,e=!1),nt.syncFSRequests++,nt.syncFSRequests>1&&b(`warning: ${nt.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var n=nt.getMounts(nt.root.mount),r=0;function o(e){return v(nt.syncFSRequests>0),nt.syncFSRequests--,t(e)}function a(e){if(e)return a.errored?void 0:(a.errored=!0,o(e));++r>=n.length&&o(null)}n.forEach(t=>{if(!t.type.syncfs)return a(null);t.type.syncfs(t,e,a)})},mount(e,t,n){if("string"==typeof e)throw e;var r,o="/"===n,a=!n;if(o&&nt.root)throw new nt.ErrnoError(10);if(!o&&!a){var i=nt.lookupPath(n,{follow_mount:!1});if(n=i.path,r=i.node,nt.isMountpoint(r))throw new nt.ErrnoError(10);if(!nt.isDir(r.mode))throw new nt.ErrnoError(54)}var s={type:e,opts:t,mountpoint:n,mounts:[]},u=e.mount(s);return u.mount=s,s.root=u,o?nt.root=u:r&&(r.mounted=s,r.mount&&r.mount.mounts.push(s)),u},unmount(e){var t=nt.lookupPath(e,{follow_mount:!1});if(!nt.isMountpoint(t.node))throw new nt.ErrnoError(28);var n=t.node,r=n.mounted,o=nt.getMounts(r);Object.keys(nt.nameTable).forEach(e=>{var t=nt.nameTable[e];while(t){var n=t.name_next;o.includes(t.mount)&&nt.destroyNode(t),t=n}}),n.mounted=null;var a=n.mount.mounts.indexOf(r);v(-1!==a),n.mount.mounts.splice(a,1)},lookup(e,t){return e.node_ops.lookup(e,t)},mknod(e,t,n){var r=nt.lookupPath(e,{parent:!0}),o=r.node,a=we.basename(e);if(!a||"."===a||".."===a)throw new nt.ErrnoError(28);var i=nt.mayCreate(o,a);if(i)throw new nt.ErrnoError(i);if(!o.node_ops.mknod)throw new nt.ErrnoError(63);return o.node_ops.mknod(o,a,t,n)},create(e,t){return t=void 0!==t?t:438,t&=4095,t|=32768,nt.mknod(e,t,0)},mkdir(e,t){return t=void 0!==t?t:511,t&=1023,t|=16384,nt.mknod(e,t,0)},mkdirTree(e,t){for(var n=e.split("/"),r="",o=0;o<n.length;++o)if(n[o]){r+="/"+n[o];try{nt.mkdir(r,t)}catch(a){if(20!=a.errno)throw a}}},mkdev(e,t,n){return"undefined"==typeof n&&(n=t,t=438),t|=8192,nt.mknod(e,t,n)},symlink(e,t){if(!Ie.resolve(e))throw new nt.ErrnoError(44);var n=nt.lookupPath(t,{parent:!0}),r=n.node;if(!r)throw new nt.ErrnoError(44);var o=we.basename(t),a=nt.mayCreate(r,o);if(a)throw new nt.ErrnoError(a);if(!r.node_ops.symlink)throw new nt.ErrnoError(63);return r.node_ops.symlink(r,o,e)},rename(e,t){var n,r,o,a=we.dirname(e),i=we.dirname(t),s=we.basename(e),u=we.basename(t);if(n=nt.lookupPath(e,{parent:!0}),r=n.node,n=nt.lookupPath(t,{parent:!0}),o=n.node,!r||!o)throw new nt.ErrnoError(44);if(r.mount!==o.mount)throw new nt.ErrnoError(75);var m,F=nt.lookupNode(r,s),l=Ie.relative(e,i);if("."!==l.charAt(0))throw new nt.ErrnoError(28);if(l=Ie.relative(t,a),"."!==l.charAt(0))throw new nt.ErrnoError(55);try{m=nt.lookupNode(o,u)}catch(c){}if(F!==m){var d=nt.isDir(F.mode),_=nt.mayDelete(r,s,d);if(_)throw new nt.ErrnoError(_);if(_=m?nt.mayDelete(o,u,d):nt.mayCreate(o,u),_)throw new nt.ErrnoError(_);if(!r.node_ops.rename)throw new nt.ErrnoError(63);if(nt.isMountpoint(F)||m&&nt.isMountpoint(m))throw new nt.ErrnoError(10);if(o!==r&&(_=nt.nodePermissions(r,"w"),_))throw new nt.ErrnoError(_);nt.hashRemoveNode(F);try{r.node_ops.rename(F,o,u),F.parent=o}catch(c){throw c}finally{nt.hashAddNode(F)}}},rmdir(e){var t=nt.lookupPath(e,{parent:!0}),n=t.node,r=we.basename(e),o=nt.lookupNode(n,r),a=nt.mayDelete(n,r,!0);if(a)throw new nt.ErrnoError(a);if(!n.node_ops.rmdir)throw new nt.ErrnoError(63);if(nt.isMountpoint(o))throw new nt.ErrnoError(10);n.node_ops.rmdir(n,r),nt.destroyNode(o)},readdir(e){var t=nt.lookupPath(e,{follow:!0}),n=t.node;if(!n.node_ops.readdir)throw new nt.ErrnoError(54);return n.node_ops.readdir(n)},unlink(e){var t=nt.lookupPath(e,{parent:!0}),n=t.node;if(!n)throw new nt.ErrnoError(44);var r=we.basename(e),o=nt.lookupNode(n,r),a=nt.mayDelete(n,r,!1);if(a)throw new nt.ErrnoError(a);if(!n.node_ops.unlink)throw new nt.ErrnoError(63);if(nt.isMountpoint(o))throw new nt.ErrnoError(10);n.node_ops.unlink(n,r),nt.destroyNode(o)},readlink(e){var t=nt.lookupPath(e),n=t.node;if(!n)throw new nt.ErrnoError(44);if(!n.node_ops.readlink)throw new nt.ErrnoError(28);return Ie.resolve(nt.getPath(n.parent),n.node_ops.readlink(n))},stat(e,t){var n=nt.lookupPath(e,{follow:!t}),r=n.node;if(!r)throw new nt.ErrnoError(44);if(!r.node_ops.getattr)throw new nt.ErrnoError(63);return r.node_ops.getattr(r)},lstat(e){return nt.stat(e,!0)},chmod(e,t,n){var r;if("string"==typeof e){var o=nt.lookupPath(e,{follow:!n});r=o.node}else r=e;if(!r.node_ops.setattr)throw new nt.ErrnoError(63);r.node_ops.setattr(r,{mode:4095&t|-4096&r.mode,timestamp:Date.now()})},lchmod(e,t){nt.chmod(e,t,!0)},fchmod(e,t){var n=nt.getStreamChecked(e);nt.chmod(n.node,t)},chown(e,t,n,r){var o;if("string"==typeof e){var a=nt.lookupPath(e,{follow:!r});o=a.node}else o=e;if(!o.node_ops.setattr)throw new nt.ErrnoError(63);o.node_ops.setattr(o,{timestamp:Date.now()})},lchown(e,t,n){nt.chown(e,t,n,!0)},fchown(e,t,n){var r=nt.getStreamChecked(e);nt.chown(r.node,t,n)},truncate(e,t){if(t<0)throw new nt.ErrnoError(28);var n;if("string"==typeof e){var r=nt.lookupPath(e,{follow:!0});n=r.node}else n=e;if(!n.node_ops.setattr)throw new nt.ErrnoError(63);if(nt.isDir(n.mode))throw new nt.ErrnoError(31);if(!nt.isFile(n.mode))throw new nt.ErrnoError(28);var o=nt.nodePermissions(n,"w");if(o)throw new nt.ErrnoError(o);n.node_ops.setattr(n,{size:t,timestamp:Date.now()})},ftruncate(e,t){var n=nt.getStreamChecked(e);if(0===(2097155&n.flags))throw new nt.ErrnoError(28);nt.truncate(n.node,t)},utime(e,t,n){var r=nt.lookupPath(e,{follow:!0}),o=r.node;o.node_ops.setattr(o,{timestamp:Math.max(t,n)})},open(e,t,n){if(""===e)throw new nt.ErrnoError(44);var r;if(t="string"==typeof t?qe(t):t,64&t?(n="undefined"==typeof n?438:n,n=4095&n|32768):n=0,"object"==typeof e)r=e;else{e=we.normalize(e);try{var o=nt.lookupPath(e,{follow:!(131072&t)});r=o.node}catch(m){}}var a=!1;if(64&t)if(r){if(128&t)throw new nt.ErrnoError(20)}else r=nt.mknod(e,n,0),a=!0;if(!r)throw new nt.ErrnoError(44);if(nt.isChrdev(r.mode)&&(t&=-513),65536&t&&!nt.isDir(r.mode))throw new nt.ErrnoError(54);if(!a){var s=nt.mayOpen(r,t);if(s)throw new nt.ErrnoError(s)}512&t&&!a&&nt.truncate(r,0),t&=-131713;var u=nt.createStream({node:r,path:nt.getPath(r),flags:t,seekable:!0,position:0,stream_ops:r.stream_ops,ungotten:[],error:!1});return u.stream_ops.open&&u.stream_ops.open(u),!i["logReadFiles"]||1&t||e in nt.readFiles||(nt.readFiles[e]=1),u},close(e){if(nt.isClosed(e))throw new nt.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{nt.closeStream(e.fd)}e.fd=null},isClosed(e){return null===e.fd},llseek(e,t,n){if(nt.isClosed(e))throw new nt.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new nt.ErrnoError(70);if(0!=n&&1!=n&&2!=n)throw new nt.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,n),e.ungotten=[],e.position},read(e,t,n,r,o){if(v(n>=0),r<0||o<0)throw new nt.ErrnoError(28);if(nt.isClosed(e))throw new nt.ErrnoError(8);if(1===(2097155&e.flags))throw new nt.ErrnoError(8);if(nt.isDir(e.node.mode))throw new nt.ErrnoError(31);if(!e.stream_ops.read)throw new nt.ErrnoError(28);var a="undefined"!=typeof o;if(a){if(!e.seekable)throw new nt.ErrnoError(70)}else o=e.position;var i=e.stream_ops.read(e,t,n,r,o);return a||(e.position+=i),i},write(e,t,n,r,o,a){if(v(n>=0),r<0||o<0)throw new nt.ErrnoError(28);if(nt.isClosed(e))throw new nt.ErrnoError(8);if(0===(2097155&e.flags))throw new nt.ErrnoError(8);if(nt.isDir(e.node.mode))throw new nt.ErrnoError(31);if(!e.stream_ops.write)throw new nt.ErrnoError(28);e.seekable&&1024&e.flags&&nt.llseek(e,0,2);var i="undefined"!=typeof o;if(i){if(!e.seekable)throw new nt.ErrnoError(70)}else o=e.position;var s=e.stream_ops.write(e,t,n,r,o,a);return i||(e.position+=s),s},allocate(e,t,n){if(nt.isClosed(e))throw new nt.ErrnoError(8);if(t<0||n<=0)throw new nt.ErrnoError(28);if(0===(2097155&e.flags))throw new nt.ErrnoError(8);if(!nt.isFile(e.node.mode)&&!nt.isDir(e.node.mode))throw new nt.ErrnoError(43);if(!e.stream_ops.allocate)throw new nt.ErrnoError(138);e.stream_ops.allocate(e,t,n)},mmap(e,t,n,r,o){if(0!==(2&r)&&0===(2&o)&&2!==(2097155&e.flags))throw new nt.ErrnoError(2);if(1===(2097155&e.flags))throw new nt.ErrnoError(2);if(!e.stream_ops.mmap)throw new nt.ErrnoError(43);if(!t)throw new nt.ErrnoError(28);return e.stream_ops.mmap(e,t,n,r,o)},msync(e,t,n,r,o){return v(n>=0),e.stream_ops.msync?e.stream_ops.msync(e,t,n,r,o):0},ioctl(e,t,n){if(!e.stream_ops.ioctl)throw new nt.ErrnoError(59);return e.stream_ops.ioctl(e,t,n)},readFile(e,t={}){if(t.flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error(`Invalid encoding type "${t.encoding}"`);var n,r=nt.open(e,t.flags),o=nt.stat(e),a=o.size,i=new Uint8Array(a);return nt.read(r,i,0,a,0),"utf8"===t.encoding?n=Se(i):"binary"===t.encoding&&(n=i),nt.close(r),n},writeFile(e,t,n={}){n.flags=n.flags||577;var r=nt.open(e,n.flags,n.mode);if("string"==typeof t){var o=new Uint8Array(Be(t)+1),a=Le(t,o,0,o.length);nt.write(r,o,0,a,void 0,n.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");nt.write(r,t,0,t.byteLength,void 0,n.canOwn)}nt.close(r)},cwd:()=>nt.currentPath,chdir(e){var t=nt.lookupPath(e,{follow:!0});if(null===t.node)throw new nt.ErrnoError(44);if(!nt.isDir(t.node.mode))throw new nt.ErrnoError(54);var n=nt.nodePermissions(t.node,"x");if(n)throw new nt.ErrnoError(n);nt.currentPath=t.path},createDefaultDirectories(){nt.mkdir("/tmp"),nt.mkdir("/home"),nt.mkdir("/home/web_user")},createDefaultDevices(){nt.mkdir("/dev"),nt.registerDevice(nt.makedev(1,3),{read:()=>0,write:(e,t,n,r,o)=>r}),nt.mkdev("/dev/null",nt.makedev(1,3)),Ue.register(nt.makedev(5,0),Ue.default_tty_ops),Ue.register(nt.makedev(6,0),Ue.default_tty1_ops),nt.mkdev("/dev/tty",nt.makedev(5,0)),nt.mkdev("/dev/tty1",nt.makedev(6,0));var e=new Uint8Array(1024),t=0,n=()=>(0===t&&(t=Re(e).byteLength),e[--t]);nt.createDevice("/dev","random",n),nt.createDevice("/dev","urandom",n),nt.mkdir("/dev/shm"),nt.mkdir("/dev/shm/tmp")},createSpecialDirectories(){nt.mkdir("/proc");var e=nt.mkdir("/proc/self");nt.mkdir("/proc/self/fd"),nt.mount({mount(){var t=nt.createNode(e,"fd",16895,73);return t.node_ops={lookup(e,t){var n=+t,r=nt.getStreamChecked(n),o={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>r.path}};return o.parent=o,o}},t}},{},"/proc/self/fd")},createStandardStreams(e,t,n){e?nt.createDevice("/dev","stdin",e):nt.symlink("/dev/tty","/dev/stdin"),t?nt.createDevice("/dev","stdout",null,t):nt.symlink("/dev/tty","/dev/stdout"),n?nt.createDevice("/dev","stderr",null,n):nt.symlink("/dev/tty1","/dev/stderr");var r=nt.open("/dev/stdin",0),o=nt.open("/dev/stdout",1),a=nt.open("/dev/stderr",1);v(0===r.fd,`invalid handle for stdin (${r.fd})`),v(1===o.fd,`invalid handle for stdout (${o.fd})`),v(2===a.fd,`invalid handle for stderr (${a.fd})`)},staticInit(){[44].forEach(e=>{nt.genericErrors[e]=new nt.ErrnoError(e),nt.genericErrors[e].stack="<generic error, no stack>"}),nt.nameTable=new Array(4096),nt.mount(He,{},"/"),nt.createDefaultDirectories(),nt.createDefaultDevices(),nt.createSpecialDirectories(),nt.filesystems={MEMFS:He}},init(e,t,n){v(!nt.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),nt.initialized=!0,e??=i["stdin"],t??=i["stdout"],n??=i["stderr"],nt.createStandardStreams(e,t,n)},quit(){nt.initialized=!1,Dn(0);for(var e=0;e<nt.streams.length;e++){var t=nt.streams[e];t&&nt.close(t)}},findObject(e,t){var n=nt.analyzePath(e,t);return n.exists?n.object:null},analyzePath(e,t){try{var n=nt.lookupPath(e,{follow:!t});e=n.path}catch(o){}var r={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{n=nt.lookupPath(e,{parent:!0});r.parentExists=!0,r.parentPath=n.path,r.parentObject=n.node,r.name=we.basename(e),n=nt.lookupPath(e,{follow:!t}),r.exists=!0,r.path=n.path,r.object=n.node,r.name=n.node.name,r.isRoot="/"===n.path}catch(o){r.error=o.errno}return r},createPath(e,t,n,r){e="string"==typeof e?e:nt.getPath(e);var o=t.split("/").reverse();while(o.length){var a=o.pop();if(a){var i=we.join2(e,a);try{nt.mkdir(i)}catch(s){}e=i}}return i},createFile(e,t,n,r,o){var a=we.join2("string"==typeof e?e:nt.getPath(e),t),i=Qe(r,o);return nt.create(a,i)},createDataFile(e,t,n,r,o,a){var i=t;e&&(e="string"==typeof e?e:nt.getPath(e),i=t?we.join2(e,t):e);var s=Qe(r,o),u=nt.create(i,s);if(n){if("string"==typeof n){for(var m=new Array(n.length),F=0,l=n.length;F<l;++F)m[F]=n.charCodeAt(F);n=m}nt.chmod(u,146|s);var d=nt.open(u,577);nt.write(d,n,0,n.length,0,a),nt.close(d),nt.chmod(u,s)}},createDevice(e,t,n,r){var o=we.join2("string"==typeof e?e:nt.getPath(e),t),a=Qe(!!n,!!r);nt.createDevice.major??=64;var i=nt.makedev(nt.createDevice.major++,0);return nt.registerDevice(i,{open(e){e.seekable=!1},close(e){r?.buffer?.length&&r(10)},read(e,t,r,o,a){for(var i=0,s=0;s<o;s++){var u;try{u=n()}catch(m){throw new nt.ErrnoError(29)}if(void 0===u&&0===i)throw new nt.ErrnoError(6);if(null===u||void 0===u)break;i++,t[r+s]=u}return i&&(e.node.timestamp=Date.now()),i},write(e,t,n,o,a){for(var i=0;i<o;i++)try{r(t[n+i])}catch(s){throw new nt.ErrnoError(29)}return o&&(e.node.timestamp=Date.now()),i}}),nt.mkdev(o,a,i)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{e.contents=d(e.url),e.usedBytes=e.contents.length}catch(t){throw new nt.ErrnoError(29)}},createLazyFile(e,t,n,r,o){class a{constructor(){this.lengthKnown=!1,this.chunks=[]}get(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,n=e/this.chunkSize|0;return this.getter(n)[t]}}setDataGetter(e){this.getter=e}cacheLength(){var e=new XMLHttpRequest;if(e.open("HEAD",n,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+n+". Status: "+e.status);var t,r=Number(e.getResponseHeader("Content-length")),o=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,a=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,i=1048576;o||(i=r);var s=(e,t)=>{if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>r-1)throw new Error("only "+r+" bytes available! programmer error!");var o=new XMLHttpRequest;if(o.open("GET",n,!1),r!==i&&o.setRequestHeader("Range","bytes="+e+"-"+t),o.responseType="arraybuffer",o.overrideMimeType&&o.overrideMimeType("text/plain; charset=x-user-defined"),o.send(null),!(o.status>=200&&o.status<300||304===o.status))throw new Error("Couldn't load "+n+". Status: "+o.status);return void 0!==o.response?new Uint8Array(o.response||[]):Ne(o.responseText||"")},u=this;u.setDataGetter(e=>{var t=e*i,n=(e+1)*i-1;if(n=Math.min(n,r-1),"undefined"==typeof u.chunks[e]&&(u.chunks[e]=s(t,n)),"undefined"==typeof u.chunks[e])throw new Error("doXHR failed!");return u.chunks[e]}),!a&&r||(i=r=1,r=this.getter(0).length,i=r,D("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=r,this._chunkSize=i,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if("undefined"!=typeof XMLHttpRequest){if(!m)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var i=new a,s={isDevice:!1,contents:i}}else s={isDevice:!1,url:n};var u=nt.createFile(e,t,s,r,o);s.contents?u.contents=s.contents:s.url&&(u.contents=null,u.url=s.url),Object.defineProperties(u,{usedBytes:{get:function(){return this.contents.length}}});var F={},l=Object.keys(u.stream_ops);function d(e,t,n,r,o){var a=e.node.contents;if(o>=a.length)return 0;var i=Math.min(a.length-o,r);if(v(i>=0),a.slice)for(var s=0;s<i;s++)t[n+s]=a[o+s];else for(s=0;s<i;s++)t[n+s]=a.get(o+s);return i}return l.forEach(e=>{var t=u.stream_ops[e];F[e]=(...e)=>(nt.forceLoadFile(u),t(...e))}),F.read=(e,t,n,r,o)=>(nt.forceLoadFile(u),d(e,t,n,r,o)),F.mmap=(e,t,n,r,o)=>{nt.forceLoadFile(u);var a=$e(t);if(!a)throw new nt.ErrnoError(48);return d(e,A,a,t,n),{ptr:a,allocated:!0}},u.stream_ops=F,u},absolutePath(){q("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder(){q("FS.createFolder has been removed; use FS.mkdir instead")},createLink(){q("FS.createLink has been removed; use FS.symlink instead")},joinPath(){q("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc(){q("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath(){q("FS.standardizePath has been removed; use PATH.normalize instead")}},rt={DEFAULT_POLLMASK:5,calculateAt(e,t,n){if(we.isAbs(t))return t;var r;if(-100===e)r=nt.cwd();else{var o=rt.getStreamFromFD(e);r=o.path}if(0==t.length){if(!n)throw new nt.ErrnoError(44);return r}return we.join2(r,t)},doStat(e,t,n){var r=e(t);G[n>>2]=r.dev,G[n+4>>2]=r.mode,C[n+8>>2]=r.nlink,G[n+12>>2]=r.uid,G[n+16>>2]=r.gid,G[n+20>>2]=r.rdev,te=[r.size>>>0,(ee=r.size,+Math.abs(ee)>=1?ee>0?+Math.floor(ee/4294967296)>>>0:~~+Math.ceil((ee-+(~~ee>>>0))/4294967296)>>>0:0)],G[n+24>>2]=te[0],G[n+28>>2]=te[1],G[n+32>>2]=4096,G[n+36>>2]=r.blocks;var o=r.atime.getTime(),a=r.mtime.getTime(),i=r.ctime.getTime();return te=[Math.floor(o/1e3)>>>0,(ee=Math.floor(o/1e3),+Math.abs(ee)>=1?ee>0?+Math.floor(ee/4294967296)>>>0:~~+Math.ceil((ee-+(~~ee>>>0))/4294967296)>>>0:0)],G[n+40>>2]=te[0],G[n+44>>2]=te[1],C[n+48>>2]=o%1e3*1e3*1e3,te=[Math.floor(a/1e3)>>>0,(ee=Math.floor(a/1e3),+Math.abs(ee)>=1?ee>0?+Math.floor(ee/4294967296)>>>0:~~+Math.ceil((ee-+(~~ee>>>0))/4294967296)>>>0:0)],G[n+56>>2]=te[0],G[n+60>>2]=te[1],C[n+64>>2]=a%1e3*1e3*1e3,te=[Math.floor(i/1e3)>>>0,(ee=Math.floor(i/1e3),+Math.abs(ee)>=1?ee>0?+Math.floor(ee/4294967296)>>>0:~~+Math.ceil((ee-+(~~ee>>>0))/4294967296)>>>0:0)],G[n+72>>2]=te[0],G[n+76>>2]=te[1],C[n+80>>2]=i%1e3*1e3*1e3,te=[r.ino>>>0,(ee=r.ino,+Math.abs(ee)>=1?ee>0?+Math.floor(ee/4294967296)>>>0:~~+Math.ceil((ee-+(~~ee>>>0))/4294967296)>>>0:0)],G[n+88>>2]=te[0],G[n+92>>2]=te[1],0},doMsync(e,t,n,r,o){if(!nt.isFile(t.node.mode))throw new nt.ErrnoError(43);if(2&r)return 0;var a=E.slice(e,e+n);nt.msync(t,a,o,n,r)},getStreamFromFD(e){var t=nt.getStreamChecked(e);return t},varargs:void 0,getStr(e){var t=Te(e);return t}};function ot(e,t,n){rt.varargs=n;try{var r=rt.getStreamFromFD(e);switch(t){case 0:var o,a=ve();if(a<0)return-28;while(nt.streams[a])a++;return o=nt.dupStream(r,a),o.fd;case 1:case 2:return 0;case 3:return r.flags;case 4:a=ve();return r.flags|=a,0;case 12:a=Oe();var i=0;return y[a+i>>1]=2,0;case 13:case 14:return 0}return-28}catch(s){if("undefined"==typeof nt||"ErrnoError"!==s.name)throw s;return-s.errno}}function at(e,t){try{var n=rt.getStreamFromFD(e);return rt.doStat(nt.stat,n.path,t)}catch(r){if("undefined"==typeof nt||"ErrnoError"!==r.name)throw r;return-r.errno}}var it=(e,t)=>(v(e==e>>>0||e==(0|e)),v(t===(0|t)),t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN);function st(e,t,n){var r=it(t,n);try{return isNaN(r)?61:(nt.ftruncate(e,r),0)}catch(o){if("undefined"==typeof nt||"ErrnoError"!==o.name)throw o;return-o.errno}}var ut=(e,t,n)=>(v("number"==typeof n,"stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),Le(e,E,t,n));function mt(e,t,n){try{var r=rt.getStreamFromFD(e);r.getdents||=nt.readdir(r.path);var o=280,a=0,i=nt.llseek(r,0,1),s=Math.floor(i/o);while(s<r.getdents.length&&a+o<=n){var u,m,F=r.getdents[s];if("."===F)u=r.node.id,m=4;else if(".."===F){var l=nt.lookupPath(r.path,{parent:!0});u=l.node.id,m=4}else{var d=nt.lookupNode(r.node,F);u=d.id,m=nt.isChrdev(d.mode)?2:nt.isDir(d.mode)?4:nt.isLink(d.mode)?10:8}v(u),te=[u>>>0,(ee=u,+Math.abs(ee)>=1?ee>0?+Math.floor(ee/4294967296)>>>0:~~+Math.ceil((ee-+(~~ee>>>0))/4294967296)>>>0:0)],G[t+a>>2]=te[0],G[t+a+4>>2]=te[1],te=[(s+1)*o>>>0,(ee=(s+1)*o,+Math.abs(ee)>=1?ee>0?+Math.floor(ee/4294967296)>>>0:~~+Math.ceil((ee-+(~~ee>>>0))/4294967296)>>>0:0)],G[t+a+8>>2]=te[0],G[t+a+12>>2]=te[1],y[t+a+16>>1]=280,A[t+a+18]=m,ut(F,t+a+19,256),a+=o,s+=1}return nt.llseek(r,s*o,0),a}catch(_){if("undefined"==typeof nt||"ErrnoError"!==_.name)throw _;return-_.errno}}function Ft(e,t,n){rt.varargs=n;try{var r=rt.getStreamFromFD(e);switch(t){case 21509:return r.tty?0:-59;case 21505:if(!r.tty)return-59;if(r.tty.ops.ioctl_tcgets){var o=r.tty.ops.ioctl_tcgets(r),a=Oe();G[a>>2]=o.c_iflag||0,G[a+4>>2]=o.c_oflag||0,G[a+8>>2]=o.c_cflag||0,G[a+12>>2]=o.c_lflag||0;for(var i=0;i<32;i++)A[a+i+17]=o.c_cc[i]||0;return 0}return 0;case 21510:case 21511:case 21512:return r.tty?0:-59;case 21506:case 21507:case 21508:if(!r.tty)return-59;if(r.tty.ops.ioctl_tcsets){a=Oe();var s=G[a>>2],u=G[a+4>>2],m=G[a+8>>2],F=G[a+12>>2],l=[];for(i=0;i<32;i++)l.push(A[a+i+17]);return r.tty.ops.ioctl_tcsets(r.tty,t,{c_iflag:s,c_oflag:u,c_cflag:m,c_lflag:F,c_cc:l})}return 0;case 21519:if(!r.tty)return-59;a=Oe();return G[a>>2]=0,0;case 21520:return r.tty?-28:-59;case 21531:a=Oe();return nt.ioctl(r,t,a);case 21523:if(!r.tty)return-59;if(r.tty.ops.ioctl_tiocgwinsz){var d=r.tty.ops.ioctl_tiocgwinsz(r.tty);a=Oe();y[a>>1]=d[0],y[a+2>>1]=d[1]}return 0;case 21524:return r.tty?0:-59;case 21515:return r.tty?0:-59;default:return-28}}catch(_){if("undefined"==typeof nt||"ErrnoError"!==_.name)throw _;return-_.errno}}function lt(e,t){try{return e=rt.getStr(e),rt.doStat(nt.lstat,e,t)}catch(n){if("undefined"==typeof nt||"ErrnoError"!==n.name)throw n;return-n.errno}}function dt(e,t,n,r){try{t=rt.getStr(t);var o=256&r,a=4096&r;return r&=-6401,v(!r,`unknown flags in __syscall_newfstatat: ${r}`),t=rt.calculateAt(e,t,a),rt.doStat(o?nt.lstat:nt.stat,t,n)}catch(i){if("undefined"==typeof nt||"ErrnoError"!==i.name)throw i;return-i.errno}}function _t(e,t,n,r){rt.varargs=r;try{t=rt.getStr(t),t=rt.calculateAt(e,t);var o=r?ve():0;return nt.open(t,n,o).fd}catch(a){if("undefined"==typeof nt||"ErrnoError"!==a.name)throw a;return-a.errno}}function ct(e){try{return e=rt.getStr(e),nt.rmdir(e),0}catch(t){if("undefined"==typeof nt||"ErrnoError"!==t.name)throw t;return-t.errno}}function Pt(e,t){try{return e=rt.getStr(e),rt.doStat(nt.stat,e,t)}catch(n){if("undefined"==typeof nt||"ErrnoError"!==n.name)throw n;return-n.errno}}function gt(e,t,n){try{return t=rt.getStr(t),t=rt.calculateAt(e,t),0===n?nt.unlink(t):512===n?nt.rmdir(t):q("Invalid flags passed to unlinkat"),0}catch(r){if("undefined"==typeof nt||"ErrnoError"!==r.name)throw r;return-r.errno}}var ht=()=>{q("native code called abort()")},Dt=(e,t,n)=>E.copyWithin(e,t,t+n),bt=()=>{throw 1/0};function ft(e,t,n){var r=it(e,t),o=new Date(1e3*r);G[n>>2]=o.getUTCSeconds(),G[n+4>>2]=o.getUTCMinutes(),G[n+8>>2]=o.getUTCHours(),G[n+12>>2]=o.getUTCDate(),G[n+16>>2]=o.getUTCMonth(),G[n+20>>2]=o.getUTCFullYear()-1900,G[n+24>>2]=o.getUTCDay();var a=Date.UTC(o.getUTCFullYear(),0,1,0,0,0,0),i=(o.getTime()-a)/864e5|0;G[n+28>>2]=i}var pt=e=>e%4===0&&(e%100!==0||e%400===0),At=[0,31,60,91,121,152,182,213,244,274,305,335],Et=[0,31,59,90,120,151,181,212,243,273,304,334],yt=e=>{var t=pt(e.getFullYear()),n=t?At:Et,r=n[e.getMonth()]+e.getDate()-1;return r};function Mt(e,t,n){var r=it(e,t),o=new Date(1e3*r);G[n>>2]=o.getSeconds(),G[n+4>>2]=o.getMinutes(),G[n+8>>2]=o.getHours(),G[n+12>>2]=o.getDate(),G[n+16>>2]=o.getMonth(),G[n+20>>2]=o.getFullYear()-1900,G[n+24>>2]=o.getDay();var a=0|yt(o);G[n+28>>2]=a,G[n+36>>2]=-60*o.getTimezoneOffset();var i=new Date(o.getFullYear(),0,1),s=new Date(o.getFullYear(),6,1).getTimezoneOffset(),u=i.getTimezoneOffset(),m=0|(s!=u&&o.getTimezoneOffset()==Math.min(u,s));G[n+32>>2]=m}var Gt=(e,t,n,r)=>{var o=(new Date).getFullYear(),a=new Date(o,0,1),i=new Date(o,6,1),s=a.getTimezoneOffset(),u=i.getTimezoneOffset(),m=Math.max(s,u);C[e>>2]=60*m,G[t>>2]=Number(s!=u);var F=e=>{var t=e>=0?"-":"+",n=Math.abs(e),r=String(Math.floor(n/60)).padStart(2,"0"),o=String(n%60).padStart(2,"0");return`UTC${t}${r}${o}`},l=F(s),d=F(u);v(l),v(d),v(Be(l)<=16,`timezone name truncated to fit in TZNAME_MAX (${l})`),v(Be(d)<=16,`timezone name truncated to fit in TZNAME_MAX (${d})`),u<s?(ut(l,n,17),ut(d,r,17)):(ut(l,r,17),ut(d,n,17))},Ct=()=>Date.now(),St=()=>2147483648,Tt=e=>{var t=f.buffer,n=(e-t.byteLength+65535)/65536|0;try{return f.grow(n),O(),1}catch(r){b(`growMemory: Attempted to grow heap from ${t.byteLength} bytes to ${e} bytes, but got error: ${r}`)}},xt=e=>{var t=E.length;e>>>=0,v(e>t);var n=St();if(e>n)return b(`Cannot enlarge memory, requested ${e} bytes, but the limit is ${n} bytes!`),!1;for(var r=1;r<=4;r*=2){var o=t*(1+.2/r);o=Math.min(o,e+100663296);var a=Math.min(n,ze(Math.max(e,o),65536)),i=Tt(a);if(i)return!0}return b(`Failed to grow the heap from ${t} bytes to ${a} bytes, not enough memory!`),!1},vt={},Ot=()=>P||"./this.program",wt=()=>{if(!wt.strings){var e=("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:Ot()};for(var n in vt)void 0===vt[n]?delete t[n]:t[n]=vt[n];var r=[];for(var n in t)r.push(`${n}=${t[n]}`);wt.strings=r}return wt.strings},kt=(e,t)=>{for(var n=0;n<e.length;++n)v(e.charCodeAt(n)===(255&e.charCodeAt(n))),A[t++]=e.charCodeAt(n);A[t]=0},Rt=(e,t)=>{var n=0;return wt().forEach((r,o)=>{var a=t+n;C[e+4*o>>2]=a,kt(r,a),n+=r.length+1}),0},It=(e,t)=>{var n=wt();C[e>>2]=n.length;var r=0;return n.forEach(e=>r+=e.length+1),C[t>>2]=r,0};function jt(e){try{var t=rt.getStreamFromFD(e);return nt.close(t),0}catch(n){if("undefined"==typeof nt||"ErrnoError"!==n.name)throw n;return n.errno}}var Bt=(e,t,n,r)=>{for(var o=0,a=0;a<n;a++){var i=C[t>>2],s=C[t+4>>2];t+=8;var u=nt.read(e,A,i,s,r);if(u<0)return-1;if(o+=u,u<s)break}return o};function Lt(e,t,n,r){try{var o=rt.getStreamFromFD(e),a=Bt(o,t,n);return C[r>>2]=a,0}catch(i){if("undefined"==typeof nt||"ErrnoError"!==i.name)throw i;return i.errno}}function Nt(e,t,n,r,o){var a=it(t,n);try{if(isNaN(a))return 61;var i=rt.getStreamFromFD(e);return nt.llseek(i,a,r),te=[i.position>>>0,(ee=i.position,+Math.abs(ee)>=1?ee>0?+Math.floor(ee/4294967296)>>>0:~~+Math.ceil((ee-+(~~ee>>>0))/4294967296)>>>0:0)],G[o>>2]=te[0],G[o+4>>2]=te[1],i.getdents&&0===a&&0===r&&(i.getdents=null),0}catch(s){if("undefined"==typeof nt||"ErrnoError"!==s.name)throw s;return s.errno}}function Vt(e){try{var t=rt.getStreamFromFD(e);return t.stream_ops?.fsync?t.stream_ops.fsync(t):0}catch(n){if("undefined"==typeof nt||"ErrnoError"!==n.name)throw n;return n.errno}}var Ut=(e,t,n,r)=>{for(var o=0,a=0;a<n;a++){var i=C[t>>2],s=C[t+4>>2];t+=8;var u=nt.write(e,A,i,s,r);if(u<0)return-1;if(o+=u,u<s)break}return o};function Wt(e,t,n,r){try{var o=rt.getStreamFromFD(e),a=Ut(o,t,n);return C[r>>2]=a,0}catch(i){if("undefined"==typeof nt||"ErrnoError"!==i.name)throw i;return i.errno}}var zt,$t,Ht=[],Xt=e=>{var t=Ht[e];return t||(e>=Ht.length&&(Ht.length=e+1),Ht[e]=t=zt.get(e)),v(zt.get(e)==t,"JavaScript-side Wasm function table mirror is out of date!"),t},Yt="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0,Kt=(e,t)=>{v(e%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");var n=e,r=n>>1,o=r+t/2;while(!(r>=o)&&M[r])++r;if(n=r<<1,n-e>32&&Yt)return Yt.decode(E.subarray(e,n));for(var a="",i=0;!(i>=t/2);++i){var s=y[e+2*i>>1];if(0==s)break;a+=String.fromCharCode(s)}return a},Jt=(e,t)=>{v(e<16384),e<128?t.push(e):t.push(e%128|128,e>>7)},Zt=e=>{v(!e.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled");for(var t={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},n={parameters:[],results:"v"==e[0]?[]:[t[e[0]]]},r=1;r<e.length;++r)v(e[r]in t,"invalid signature char: "+e[r]),n.parameters.push(t[e[r]]);return n},qt=(e,t)=>{var n=e.slice(0,1),r=e.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111};t.push(96),Jt(r.length,t);for(var a=0;a<r.length;++a)v(r[a]in o,"invalid signature char: "+r[a]),t.push(o[r[a]]);"v"==n?t.push(0):t.push(1,o[n])},Qt=(e,t)=>{if(v(!t.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled"),"function"==typeof WebAssembly.Function)return new WebAssembly.Function(Zt(t),e);var n=[1];qt(t,n);var r=[0,97,115,109,1,0,0,0,1];Jt(n.length,r),r.push(...n),r.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var o=new WebAssembly.Module(new Uint8Array(r)),a=new WebAssembly.Instance(o,{e:{f:e}}),i=a.exports["f"];return i},en=(e,t)=>{if($t)for(var n=e;n<e+t;n++){var r=Xt(n);r&&$t.set(r,n)}},tn=e=>($t||($t=new WeakMap,en(0,zt.length)),$t.get(e)||0),nn=[],rn=()=>{if(nn.length)return nn.pop();try{zt.grow(1)}catch(b){if(!(b instanceof RangeError))throw b;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return zt.length-1},on=(e,t)=>{zt.set(e,t),Ht[e]=zt.get(e)},an=(e,t)=>{v("undefined"!=typeof e);var n=tn(e);if(n)return n;var r=rn();try{on(r,e)}catch(b){if(!(b instanceof TypeError))throw b;v("undefined"!=typeof t,"Missing signature argument to addFunction: "+e);var o=Qt(e,t);on(r,o)}return $t.set(e,r),r},sn=e=>{var t=i["_"+e];return v(t,"Cannot call unknown function "+e+", make sure it is exported"),t},un=(e,t)=>{v(e.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),A.set(e,t)},mn=e=>Mn(e),Fn=e=>{var t=Be(e)+1,n=mn(t);return ut(e,n,t),n},ln=(e,t,n,r,o)=>{var a={string:e=>{var t=0;return null!==e&&void 0!==e&&0!==e&&(t=Fn(e)),t},array:e=>{var t=mn(e.length);return un(e,t),t}};function i(e){return"string"===t?Te(e):"boolean"===t?Boolean(e):e}var s=sn(e),u=[],m=0;if(v("array"!==t,'Return type should not be "array".'),r)for(var F=0;F<r.length;F++){var l=a[n[F]];l?(0===m&&(m=Me()),u[F]=l(r[F])):u[F]=r[F]}var d=s(...u);function _(e){return 0!==m&&ye(m),i(e)}return d=_(d),d},dn=(e,t,n,r)=>(...r)=>ln(e,t,n,r),_n=e=>{$t.delete(Xt(e)),on(e,null),nn.push(e)},cn=(e,t,n)=>{if(v(t%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!"),v("number"==typeof n,"stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),n??=2147483647,n<2)return 0;n-=2;for(var r=t,o=n<2*e.length?n/2:e.length,a=0;a<o;++a){var i=e.charCodeAt(a);y[t>>1]=i,t+=2}return y[t>>1]=0,t-r};function Pn(){ce("fetchSettings")}nt.createPreloadedFile=Ze,nt.staticInit();var gn={__assert_fail:xe,__syscall_fcntl64:ot,__syscall_fstat64:at,__syscall_ftruncate64:st,__syscall_getdents64:mt,__syscall_ioctl:Ft,__syscall_lstat64:lt,__syscall_newfstatat:dt,__syscall_openat:_t,__syscall_rmdir:ct,__syscall_stat64:Pt,__syscall_unlinkat:gt,_abort_js:ht,_emscripten_memcpy_js:Dt,_emscripten_throw_longjmp:bt,_gmtime_js:ft,_localtime_js:Mt,_tzset_js:Gt,emscripten_date_now:Ct,emscripten_resize_heap:xt,environ_get:Rt,environ_sizes_get:It,fd_close:jt,fd_read:Lt,fd_seek:Nt,fd_sync:Vt,fd_write:Wt,invoke_ii:Sn,invoke_iii:Tn,invoke_iiii:xn,invoke_iiiii:On,invoke_v:wn,invoke_vii:kn,invoke_viii:Cn,invoke_viiii:vn,invoke_viiiiiiiii:Rn},hn=de();i["_PDFiumExt_Init"]=ae("PDFiumExt_Init",0),i["_FPDF_InitLibraryWithConfig"]=ae("FPDF_InitLibraryWithConfig",1),i["_PDFiumExt_OpenFileWriter"]=ae("PDFiumExt_OpenFileWriter",0),i["_PDFiumExt_GetFileWriterSize"]=ae("PDFiumExt_GetFileWriterSize",1),i["_PDFiumExt_GetFileWriterData"]=ae("PDFiumExt_GetFileWriterData",3),i["_PDFiumExt_CloseFileWriter"]=ae("PDFiumExt_CloseFileWriter",1),i["_PDFiumExt_SaveAsCopy"]=ae("PDFiumExt_SaveAsCopy",2),i["_FPDF_SaveAsCopy"]=ae("FPDF_SaveAsCopy",3),i["_PDFiumExt_OpenFormFillInfo"]=ae("PDFiumExt_OpenFormFillInfo",0),i["_PDFiumExt_CloseFormFillInfo"]=ae("PDFiumExt_CloseFormFillInfo",1),i["_PDFiumExt_InitFormFillEnvironment"]=ae("PDFiumExt_InitFormFillEnvironment",2),i["_FPDFDOC_InitFormFillEnvironment"]=ae("FPDFDOC_InitFormFillEnvironment",2),i["_PDFiumExt_ExitFormFillEnvironment"]=ae("PDFiumExt_ExitFormFillEnvironment",1),i["_FPDFDOC_ExitFormFillEnvironment"]=ae("FPDFDOC_ExitFormFillEnvironment",1),i["_EPDFNamedDest_SetDest"]=ae("EPDFNamedDest_SetDest",3),i["_EPDFNamedDest_Remove"]=ae("EPDFNamedDest_Remove",2),i["_EPDFDest_CreateView"]=ae("EPDFDest_CreateView",4),i["_EPDFDest_CreateXYZ"]=ae("EPDFDest_CreateXYZ",7),i["_EPDFDest_CreateRemoteView"]=ae("EPDFDest_CreateRemoteView",5),i["_EPDFDest_CreateRemoteXYZ"]=ae("EPDFDest_CreateRemoteXYZ",8),i["_EPDFAction_CreateGoTo"]=ae("EPDFAction_CreateGoTo",2),i["_EPDFAction_CreateGoToNamed"]=ae("EPDFAction_CreateGoToNamed",2),i["_EPDFAction_CreateLaunch"]=ae("EPDFAction_CreateLaunch",2),i["_EPDFAction_CreateRemoteGoToByName"]=ae("EPDFAction_CreateRemoteGoToByName",3),i["_EPDFAction_CreateRemoteGoToDest"]=ae("EPDFAction_CreateRemoteGoToDest",3),i["_EPDFAction_CreateURI"]=ae("EPDFAction_CreateURI",2),i["_EPDFBookmark_Create"]=ae("EPDFBookmark_Create",2),i["_EPDFBookmark_Delete"]=ae("EPDFBookmark_Delete",2),i["_EPDFBookmark_AppendChild"]=ae("EPDFBookmark_AppendChild",3),i["_EPDFBookmark_InsertAfter"]=ae("EPDFBookmark_InsertAfter",4),i["_EPDFBookmark_Clear"]=ae("EPDFBookmark_Clear",1),i["_EPDFBookmark_SetTitle"]=ae("EPDFBookmark_SetTitle",2),i["_EPDFBookmark_SetDest"]=ae("EPDFBookmark_SetDest",3),i["_EPDFBookmark_SetAction"]=ae("EPDFBookmark_SetAction",3),i["_EPDFBookmark_ClearTarget"]=ae("EPDFBookmark_ClearTarget",1),i["_EPDF_PNG_EncodeRGBA"]=ae("EPDF_PNG_EncodeRGBA",6),i["_FPDFAnnot_IsSupportedSubtype"]=ae("FPDFAnnot_IsSupportedSubtype",1),i["_FPDFPage_CreateAnnot"]=ae("FPDFPage_CreateAnnot",2),i["_FPDFPage_GetAnnotCount"]=ae("FPDFPage_GetAnnotCount",1),i["_FPDFPage_GetAnnot"]=ae("FPDFPage_GetAnnot",2),i["_FPDFPage_GetAnnotIndex"]=ae("FPDFPage_GetAnnotIndex",2),i["_FPDFPage_CloseAnnot"]=ae("FPDFPage_CloseAnnot",1),i["_FPDFPage_RemoveAnnot"]=ae("FPDFPage_RemoveAnnot",2),i["_FPDFAnnot_GetSubtype"]=ae("FPDFAnnot_GetSubtype",1),i["_FPDFAnnot_IsObjectSupportedSubtype"]=ae("FPDFAnnot_IsObjectSupportedSubtype",1),i["_FPDFAnnot_UpdateObject"]=ae("FPDFAnnot_UpdateObject",2),i["_FPDFAnnot_AddInkStroke"]=ae("FPDFAnnot_AddInkStroke",3),i["_FPDFAnnot_RemoveInkList"]=ae("FPDFAnnot_RemoveInkList",1),i["_FPDFAnnot_AppendObject"]=ae("FPDFAnnot_AppendObject",2),i["_FPDFAnnot_GetObjectCount"]=ae("FPDFAnnot_GetObjectCount",1),i["_FPDFAnnot_GetObject"]=ae("FPDFAnnot_GetObject",2),i["_FPDFAnnot_RemoveObject"]=ae("FPDFAnnot_RemoveObject",2),i["_FPDFAnnot_SetColor"]=ae("FPDFAnnot_SetColor",6),i["_FPDFAnnot_GetColor"]=ae("FPDFAnnot_GetColor",6),i["_FPDFAnnot_HasAttachmentPoints"]=ae("FPDFAnnot_HasAttachmentPoints",1),i["_FPDFAnnot_SetAttachmentPoints"]=ae("FPDFAnnot_SetAttachmentPoints",3),i["_FPDFAnnot_AppendAttachmentPoints"]=ae("FPDFAnnot_AppendAttachmentPoints",2),i["_FPDFAnnot_CountAttachmentPoints"]=ae("FPDFAnnot_CountAttachmentPoints",1),i["_FPDFAnnot_GetAttachmentPoints"]=ae("FPDFAnnot_GetAttachmentPoints",3),i["_FPDFAnnot_SetRect"]=ae("FPDFAnnot_SetRect",2),i["_FPDFAnnot_GetRect"]=ae("FPDFAnnot_GetRect",2),i["_FPDFAnnot_GetVertices"]=ae("FPDFAnnot_GetVertices",3),i["_FPDFAnnot_GetInkListCount"]=ae("FPDFAnnot_GetInkListCount",1),i["_FPDFAnnot_GetInkListPath"]=ae("FPDFAnnot_GetInkListPath",4),i["_FPDFAnnot_GetLine"]=ae("FPDFAnnot_GetLine",3),i["_FPDFAnnot_SetBorder"]=ae("FPDFAnnot_SetBorder",4),i["_FPDFAnnot_GetBorder"]=ae("FPDFAnnot_GetBorder",4),i["_FPDFAnnot_HasKey"]=ae("FPDFAnnot_HasKey",2),i["_FPDFAnnot_GetValueType"]=ae("FPDFAnnot_GetValueType",2),i["_FPDFAnnot_SetStringValue"]=ae("FPDFAnnot_SetStringValue",3),i["_FPDFAnnot_GetStringValue"]=ae("FPDFAnnot_GetStringValue",4),i["_FPDFAnnot_GetNumberValue"]=ae("FPDFAnnot_GetNumberValue",3),i["_FPDFAnnot_SetAP"]=ae("FPDFAnnot_SetAP",3),i["_FPDFAnnot_GetAP"]=ae("FPDFAnnot_GetAP",4),i["_FPDFAnnot_GetLinkedAnnot"]=ae("FPDFAnnot_GetLinkedAnnot",2),i["_FPDFAnnot_GetFlags"]=ae("FPDFAnnot_GetFlags",1),i["_FPDFAnnot_SetFlags"]=ae("FPDFAnnot_SetFlags",2),i["_FPDFAnnot_GetFormFieldFlags"]=ae("FPDFAnnot_GetFormFieldFlags",2),i["_FPDFAnnot_SetFormFieldFlags"]=ae("FPDFAnnot_SetFormFieldFlags",3),i["_FPDFAnnot_GetFormFieldAtPoint"]=ae("FPDFAnnot_GetFormFieldAtPoint",3),i["_FPDFAnnot_GetFormFieldName"]=ae("FPDFAnnot_GetFormFieldName",4),i["_FPDFAnnot_GetFormFieldType"]=ae("FPDFAnnot_GetFormFieldType",2),i["_FPDFAnnot_GetFormAdditionalActionJavaScript"]=ae("FPDFAnnot_GetFormAdditionalActionJavaScript",5),i["_FPDFAnnot_GetFormFieldAlternateName"]=ae("FPDFAnnot_GetFormFieldAlternateName",4),i["_FPDFAnnot_GetFormFieldValue"]=ae("FPDFAnnot_GetFormFieldValue",4),i["_FPDFAnnot_GetOptionCount"]=ae("FPDFAnnot_GetOptionCount",2),i["_FPDFAnnot_GetOptionLabel"]=ae("FPDFAnnot_GetOptionLabel",5),i["_FPDFAnnot_IsOptionSelected"]=ae("FPDFAnnot_IsOptionSelected",3),i["_FPDFAnnot_GetFontSize"]=ae("FPDFAnnot_GetFontSize",3),i["_FPDFAnnot_SetFontColor"]=ae("FPDFAnnot_SetFontColor",5),i["_FPDFAnnot_GetFontColor"]=ae("FPDFAnnot_GetFontColor",5),i["_FPDFAnnot_IsChecked"]=ae("FPDFAnnot_IsChecked",2),i["_FPDFAnnot_SetFocusableSubtypes"]=ae("FPDFAnnot_SetFocusableSubtypes",3),i["_FPDFAnnot_GetFocusableSubtypesCount"]=ae("FPDFAnnot_GetFocusableSubtypesCount",1),i["_FPDFAnnot_GetFocusableSubtypes"]=ae("FPDFAnnot_GetFocusableSubtypes",3),i["_FPDFAnnot_GetLink"]=ae("FPDFAnnot_GetLink",1),i["_FPDFAnnot_GetFormControlCount"]=ae("FPDFAnnot_GetFormControlCount",2),i["_FPDFAnnot_GetFormControlIndex"]=ae("FPDFAnnot_GetFormControlIndex",2),i["_FPDFAnnot_GetFormFieldExportValue"]=ae("FPDFAnnot_GetFormFieldExportValue",4),i["_FPDFAnnot_SetURI"]=ae("FPDFAnnot_SetURI",2),i["_FPDFAnnot_GetFileAttachment"]=ae("FPDFAnnot_GetFileAttachment",1),i["_FPDFAnnot_AddFileAttachment"]=ae("FPDFAnnot_AddFileAttachment",2),i["_EPDFAnnot_SetColor"]=ae("EPDFAnnot_SetColor",5),i["_EPDFAnnot_GetColor"]=ae("EPDFAnnot_GetColor",5),i["_EPDFAnnot_ClearColor"]=ae("EPDFAnnot_ClearColor",2),i["_EPDFAnnot_SetOpacity"]=ae("EPDFAnnot_SetOpacity",2),i["_EPDFAnnot_GetOpacity"]=ae("EPDFAnnot_GetOpacity",2),i["_EPDFAnnot_GetBorderEffect"]=ae("EPDFAnnot_GetBorderEffect",2),i["_EPDFAnnot_GetRectangleDifferences"]=ae("EPDFAnnot_GetRectangleDifferences",5),i["_EPDFAnnot_GetBorderDashPatternCount"]=ae("EPDFAnnot_GetBorderDashPatternCount",1),i["_EPDFAnnot_GetBorderDashPattern"]=ae("EPDFAnnot_GetBorderDashPattern",3),i["_EPDFAnnot_SetBorderDashPattern"]=ae("EPDFAnnot_SetBorderDashPattern",3),i["_EPDFAnnot_GetBorderStyle"]=ae("EPDFAnnot_GetBorderStyle",2),i["_EPDFAnnot_SetBorderStyle"]=ae("EPDFAnnot_SetBorderStyle",3),i["_EPDFAnnot_GenerateAppearance"]=ae("EPDFAnnot_GenerateAppearance",1),i["_EPDFAnnot_GenerateAppearanceWithBlend"]=ae("EPDFAnnot_GenerateAppearanceWithBlend",2),i["_EPDFAnnot_GetBlendMode"]=ae("EPDFAnnot_GetBlendMode",1),i["_EPDFAnnot_SetIntent"]=ae("EPDFAnnot_SetIntent",2),i["_EPDFAnnot_GetIntent"]=ae("EPDFAnnot_GetIntent",3),i["_EPDFAnnot_GetRichContent"]=ae("EPDFAnnot_GetRichContent",3),i["_EPDFAnnot_SetLineEndings"]=ae("EPDFAnnot_SetLineEndings",3),i["_EPDFAnnot_GetLineEndings"]=ae("EPDFAnnot_GetLineEndings",3),i["_EPDFAnnot_SetVertices"]=ae("EPDFAnnot_SetVertices",3),i["_EPDFAnnot_SetLine"]=ae("EPDFAnnot_SetLine",3),i["_EPDFAnnot_SetDefaultAppearance"]=ae("EPDFAnnot_SetDefaultAppearance",6),i["_EPDFAnnot_GetDefaultAppearance"]=ae("EPDFAnnot_GetDefaultAppearance",6),i["_EPDFAnnot_SetTextAlignment"]=ae("EPDFAnnot_SetTextAlignment",2),i["_EPDFAnnot_GetTextAlignment"]=ae("EPDFAnnot_GetTextAlignment",1),i["_EPDFAnnot_SetVerticalAlignment"]=ae("EPDFAnnot_SetVerticalAlignment",2),i["_EPDFAnnot_GetVerticalAlignment"]=ae("EPDFAnnot_GetVerticalAlignment",1),i["_EPDFPage_GetAnnotByName"]=ae("EPDFPage_GetAnnotByName",2),i["_EPDFPage_RemoveAnnotByName"]=ae("EPDFPage_RemoveAnnotByName",2),i["_EPDFAnnot_SetLinkedAnnot"]=ae("EPDFAnnot_SetLinkedAnnot",3),i["_EPDFPage_GetAnnotCountRaw"]=ae("EPDFPage_GetAnnotCountRaw",2),i["_EPDFPage_GetAnnotRaw"]=ae("EPDFPage_GetAnnotRaw",3),i["_EPDFPage_RemoveAnnotRaw"]=ae("EPDFPage_RemoveAnnotRaw",3),i["_EPDFAnnot_SetIcon"]=ae("EPDFAnnot_SetIcon",2),i["_EPDFAnnot_GetIcon"]=ae("EPDFAnnot_GetIcon",1),i["_EPDFAnnot_UpdateAppearanceToRect"]=ae("EPDFAnnot_UpdateAppearanceToRect",2),i["_EPDFPage_CreateAnnot"]=ae("EPDFPage_CreateAnnot",2),i["_FPDFDoc_GetAttachmentCount"]=ae("FPDFDoc_GetAttachmentCount",1),i["_FPDFDoc_AddAttachment"]=ae("FPDFDoc_AddAttachment",2),i["_FPDFDoc_GetAttachment"]=ae("FPDFDoc_GetAttachment",2),i["_FPDFDoc_DeleteAttachment"]=ae("FPDFDoc_DeleteAttachment",2),i["_FPDFAttachment_GetName"]=ae("FPDFAttachment_GetName",3),i["_FPDFAttachment_HasKey"]=ae("FPDFAttachment_HasKey",2),i["_FPDFAttachment_GetValueType"]=ae("FPDFAttachment_GetValueType",2),i["_FPDFAttachment_SetStringValue"]=ae("FPDFAttachment_SetStringValue",3),i["_FPDFAttachment_GetStringValue"]=ae("FPDFAttachment_GetStringValue",4),i["_FPDFAttachment_SetFile"]=ae("FPDFAttachment_SetFile",4),i["_FPDFAttachment_GetFile"]=ae("FPDFAttachment_GetFile",4),i["_FPDFAttachment_GetSubtype"]=ae("FPDFAttachment_GetSubtype",3),i["_EPDFAttachment_SetSubtype"]=ae("EPDFAttachment_SetSubtype",2),i["_EPDFAttachment_SetDescription"]=ae("EPDFAttachment_SetDescription",2),i["_EPDFAttachment_GetDescription"]=ae("EPDFAttachment_GetDescription",3),i["_EPDFAttachment_GetIntegerValue"]=ae("EPDFAttachment_GetIntegerValue",3),i["_FPDFCatalog_IsTagged"]=ae("FPDFCatalog_IsTagged",1),i["_FPDFCatalog_SetLanguage"]=ae("FPDFCatalog_SetLanguage",2),i["_EPDFCatalog_GetLanguage"]=ae("EPDFCatalog_GetLanguage",3),i["_FPDFAvail_Create"]=ae("FPDFAvail_Create",2),i["_FPDFAvail_Destroy"]=ae("FPDFAvail_Destroy",1),i["_FPDFAvail_IsDocAvail"]=ae("FPDFAvail_IsDocAvail",2),i["_FPDFAvail_GetDocument"]=ae("FPDFAvail_GetDocument",2),i["_FPDFAvail_GetFirstPageNum"]=ae("FPDFAvail_GetFirstPageNum",1),i["_FPDFAvail_IsPageAvail"]=ae("FPDFAvail_IsPageAvail",3),i["_FPDFAvail_IsFormAvail"]=ae("FPDFAvail_IsFormAvail",2),i["_FPDFAvail_IsLinearized"]=ae("FPDFAvail_IsLinearized",1),i["_FPDFBookmark_GetFirstChild"]=ae("FPDFBookmark_GetFirstChild",2),i["_FPDFBookmark_GetNextSibling"]=ae("FPDFBookmark_GetNextSibling",2),i["_FPDFBookmark_GetTitle"]=ae("FPDFBookmark_GetTitle",3),i["_FPDFBookmark_GetCount"]=ae("FPDFBookmark_GetCount",1),i["_FPDFBookmark_Find"]=ae("FPDFBookmark_Find",2),i["_FPDFBookmark_GetDest"]=ae("FPDFBookmark_GetDest",2),i["_FPDFBookmark_GetAction"]=ae("FPDFBookmark_GetAction",1),i["_FPDFAction_GetType"]=ae("FPDFAction_GetType",1),i["_FPDFAction_GetDest"]=ae("FPDFAction_GetDest",2),i["_FPDFAction_GetFilePath"]=ae("FPDFAction_GetFilePath",3),i["_FPDFAction_GetURIPath"]=ae("FPDFAction_GetURIPath",4),i["_FPDFDest_GetDestPageIndex"]=ae("FPDFDest_GetDestPageIndex",2),i["_FPDFDest_GetView"]=ae("FPDFDest_GetView",3),i["_FPDFDest_GetLocationInPage"]=ae("FPDFDest_GetLocationInPage",7),i["_FPDFLink_GetLinkAtPoint"]=ae("FPDFLink_GetLinkAtPoint",3),i["_FPDFLink_GetLinkZOrderAtPoint"]=ae("FPDFLink_GetLinkZOrderAtPoint",3),i["_FPDFLink_GetDest"]=ae("FPDFLink_GetDest",2),i["_FPDFLink_GetAction"]=ae("FPDFLink_GetAction",1),i["_FPDFLink_Enumerate"]=ae("FPDFLink_Enumerate",3),i["_FPDFLink_GetAnnot"]=ae("FPDFLink_GetAnnot",2),i["_FPDFLink_GetAnnotRect"]=ae("FPDFLink_GetAnnotRect",2),i["_FPDFLink_CountQuadPoints"]=ae("FPDFLink_CountQuadPoints",1),i["_FPDFLink_GetQuadPoints"]=ae("FPDFLink_GetQuadPoints",3),i["_FPDF_GetPageAAction"]=ae("FPDF_GetPageAAction",2),i["_FPDF_GetFileIdentifier"]=ae("FPDF_GetFileIdentifier",4),i["_FPDF_GetMetaText"]=ae("FPDF_GetMetaText",4),i["_FPDF_GetPageLabel"]=ae("FPDF_GetPageLabel",4),i["_EPDF_SetMetaText"]=ae("EPDF_SetMetaText",3),i["_EPDF_HasMetaText"]=ae("EPDF_HasMetaText",2),i["_EPDF_GetMetaTrapped"]=ae("EPDF_GetMetaTrapped",1),i["_EPDF_SetMetaTrapped"]=ae("EPDF_SetMetaTrapped",2),i["_EPDF_GetMetaKeyCount"]=ae("EPDF_GetMetaKeyCount",2),i["_EPDF_GetMetaKeyName"]=ae("EPDF_GetMetaKeyName",5),i["_FPDFPageObj_NewImageObj"]=ae("FPDFPageObj_NewImageObj",1),i["_FPDFImageObj_LoadJpegFile"]=ae("FPDFImageObj_LoadJpegFile",4),i["_FPDFImageObj_LoadJpegFileInline"]=ae("FPDFImageObj_LoadJpegFileInline",4),i["_FPDFImageObj_SetMatrix"]=ae("FPDFImageObj_SetMatrix",7),i["_FPDFImageObj_SetBitmap"]=ae("FPDFImageObj_SetBitmap",4),i["_FPDFImageObj_GetBitmap"]=ae("FPDFImageObj_GetBitmap",1),i["_FPDFImageObj_GetRenderedBitmap"]=ae("FPDFImageObj_GetRenderedBitmap",3),i["_FPDFImageObj_GetImageDataDecoded"]=ae("FPDFImageObj_GetImageDataDecoded",3),i["_FPDFImageObj_GetImageDataRaw"]=ae("FPDFImageObj_GetImageDataRaw",3),i["_FPDFImageObj_GetImageFilterCount"]=ae("FPDFImageObj_GetImageFilterCount",1),i["_FPDFImageObj_GetImageFilter"]=ae("FPDFImageObj_GetImageFilter",4),i["_FPDFImageObj_GetImageMetadata"]=ae("FPDFImageObj_GetImageMetadata",3),i["_FPDFImageObj_GetImagePixelSize"]=ae("FPDFImageObj_GetImagePixelSize",3),i["_FPDFImageObj_GetIccProfileDataDecoded"]=ae("FPDFImageObj_GetIccProfileDataDecoded",5),i["_FPDF_CreateNewDocument"]=ae("FPDF_CreateNewDocument",0),i["_FPDFPage_Delete"]=ae("FPDFPage_Delete",2),i["_FPDF_MovePages"]=ae("FPDF_MovePages",4),i["_FPDFPage_New"]=ae("FPDFPage_New",4),i["_FPDFPage_GetRotation"]=ae("FPDFPage_GetRotation",1),i["_FPDFPage_InsertObject"]=ae("FPDFPage_InsertObject",2),i["_FPDFPage_InsertObjectAtIndex"]=ae("FPDFPage_InsertObjectAtIndex",3),i["_FPDFPage_RemoveObject"]=ae("FPDFPage_RemoveObject",2),i["_FPDFPage_CountObjects"]=ae("FPDFPage_CountObjects",1),i["_FPDFPage_GetObject"]=ae("FPDFPage_GetObject",2),i["_FPDFPage_HasTransparency"]=ae("FPDFPage_HasTransparency",1),i["_FPDFPageObj_Destroy"]=ae("FPDFPageObj_Destroy",1),i["_FPDFPageObj_GetMarkedContentID"]=ae("FPDFPageObj_GetMarkedContentID",1),i["_FPDFPageObj_CountMarks"]=ae("FPDFPageObj_CountMarks",1),i["_FPDFPageObj_GetMark"]=ae("FPDFPageObj_GetMark",2),i["_FPDFPageObj_AddMark"]=ae("FPDFPageObj_AddMark",2),i["_FPDFPageObj_RemoveMark"]=ae("FPDFPageObj_RemoveMark",2),i["_FPDFPageObjMark_GetName"]=ae("FPDFPageObjMark_GetName",4),i["_FPDFPageObjMark_CountParams"]=ae("FPDFPageObjMark_CountParams",1),i["_FPDFPageObjMark_GetParamKey"]=ae("FPDFPageObjMark_GetParamKey",5),i["_FPDFPageObjMark_GetParamValueType"]=ae("FPDFPageObjMark_GetParamValueType",2),i["_FPDFPageObjMark_GetParamIntValue"]=ae("FPDFPageObjMark_GetParamIntValue",3),i["_FPDFPageObjMark_GetParamStringValue"]=ae("FPDFPageObjMark_GetParamStringValue",5),i["_FPDFPageObjMark_GetParamBlobValue"]=ae("FPDFPageObjMark_GetParamBlobValue",5),i["_FPDFPageObj_HasTransparency"]=ae("FPDFPageObj_HasTransparency",1),i["_FPDFPageObjMark_SetIntParam"]=ae("FPDFPageObjMark_SetIntParam",5),i["_FPDFPageObjMark_SetStringParam"]=ae("FPDFPageObjMark_SetStringParam",5),i["_FPDFPageObjMark_SetBlobParam"]=ae("FPDFPageObjMark_SetBlobParam",6),i["_FPDFPageObjMark_RemoveParam"]=ae("FPDFPageObjMark_RemoveParam",3),i["_FPDFPageObj_GetType"]=ae("FPDFPageObj_GetType",1),i["_FPDFPageObj_GetIsActive"]=ae("FPDFPageObj_GetIsActive",2),i["_FPDFPageObj_SetIsActive"]=ae("FPDFPageObj_SetIsActive",2),i["_FPDFPage_GenerateContent"]=ae("FPDFPage_GenerateContent",1),i["_FPDFPageObj_Transform"]=ae("FPDFPageObj_Transform",7),i["_FPDFPageObj_TransformF"]=ae("FPDFPageObj_TransformF",2),i["_FPDFPageObj_GetMatrix"]=ae("FPDFPageObj_GetMatrix",2),i["_FPDFPageObj_SetMatrix"]=ae("FPDFPageObj_SetMatrix",2),i["_FPDFPageObj_SetBlendMode"]=ae("FPDFPageObj_SetBlendMode",2),i["_FPDFPage_TransformAnnots"]=ae("FPDFPage_TransformAnnots",7),i["_FPDFPage_SetRotation"]=ae("FPDFPage_SetRotation",2),i["_FPDFPageObj_SetFillColor"]=ae("FPDFPageObj_SetFillColor",5),i["_FPDFPageObj_GetFillColor"]=ae("FPDFPageObj_GetFillColor",5),i["_FPDFPageObj_GetBounds"]=ae("FPDFPageObj_GetBounds",5),i["_FPDFPageObj_GetRotatedBounds"]=ae("FPDFPageObj_GetRotatedBounds",2),i["_FPDFPageObj_SetStrokeColor"]=ae("FPDFPageObj_SetStrokeColor",5),i["_FPDFPageObj_GetStrokeColor"]=ae("FPDFPageObj_GetStrokeColor",5),i["_FPDFPageObj_SetStrokeWidth"]=ae("FPDFPageObj_SetStrokeWidth",2),i["_FPDFPageObj_GetStrokeWidth"]=ae("FPDFPageObj_GetStrokeWidth",2),i["_FPDFPageObj_GetLineJoin"]=ae("FPDFPageObj_GetLineJoin",1),i["_FPDFPageObj_SetLineJoin"]=ae("FPDFPageObj_SetLineJoin",2),i["_FPDFPageObj_GetLineCap"]=ae("FPDFPageObj_GetLineCap",1),i["_FPDFPageObj_SetLineCap"]=ae("FPDFPageObj_SetLineCap",2),i["_FPDFPageObj_GetDashPhase"]=ae("FPDFPageObj_GetDashPhase",2),i["_FPDFPageObj_SetDashPhase"]=ae("FPDFPageObj_SetDashPhase",2),i["_FPDFPageObj_GetDashCount"]=ae("FPDFPageObj_GetDashCount",1),i["_FPDFPageObj_GetDashArray"]=ae("FPDFPageObj_GetDashArray",3),i["_FPDFPageObj_SetDashArray"]=ae("FPDFPageObj_SetDashArray",4),i["_FPDFFormObj_CountObjects"]=ae("FPDFFormObj_CountObjects",1),i["_FPDFFormObj_GetObject"]=ae("FPDFFormObj_GetObject",2),i["_FPDFFormObj_RemoveObject"]=ae("FPDFFormObj_RemoveObject",2),i["_FPDFPageObj_CreateNewPath"]=ae("FPDFPageObj_CreateNewPath",2),i["_FPDFPageObj_CreateNewRect"]=ae("FPDFPageObj_CreateNewRect",4),i["_FPDFPath_CountSegments"]=ae("FPDFPath_CountSegments",1),i["_FPDFPath_GetPathSegment"]=ae("FPDFPath_GetPathSegment",2),i["_FPDFPath_MoveTo"]=ae("FPDFPath_MoveTo",3),i["_FPDFPath_LineTo"]=ae("FPDFPath_LineTo",3),i["_FPDFPath_BezierTo"]=ae("FPDFPath_BezierTo",7),i["_FPDFPath_Close"]=ae("FPDFPath_Close",1),i["_FPDFPath_SetDrawMode"]=ae("FPDFPath_SetDrawMode",3),i["_FPDFPath_GetDrawMode"]=ae("FPDFPath_GetDrawMode",3),i["_FPDFPathSegment_GetPoint"]=ae("FPDFPathSegment_GetPoint",3),i["_FPDFPathSegment_GetType"]=ae("FPDFPathSegment_GetType",1),i["_FPDFPathSegment_GetClose"]=ae("FPDFPathSegment_GetClose",1),i["_FPDFPageObj_NewTextObj"]=ae("FPDFPageObj_NewTextObj",3),i["_FPDFText_SetText"]=ae("FPDFText_SetText",2),i["_FPDFText_SetCharcodes"]=ae("FPDFText_SetCharcodes",3),i["_FPDFText_LoadFont"]=ae("FPDFText_LoadFont",5),i["_FPDFText_LoadStandardFont"]=ae("FPDFText_LoadStandardFont",2),i["_FPDFText_LoadCidType2Font"]=ae("FPDFText_LoadCidType2Font",6),i["_FPDFTextObj_GetFontSize"]=ae("FPDFTextObj_GetFontSize",2),i["_FPDFTextObj_GetText"]=ae("FPDFTextObj_GetText",4),i["_FPDFTextObj_GetRenderedBitmap"]=ae("FPDFTextObj_GetRenderedBitmap",4),i["_FPDFFont_Close"]=ae("FPDFFont_Close",1),i["_FPDFPageObj_CreateTextObj"]=ae("FPDFPageObj_CreateTextObj",3),i["_FPDFTextObj_GetTextRenderMode"]=ae("FPDFTextObj_GetTextRenderMode",1),i["_FPDFTextObj_SetTextRenderMode"]=ae("FPDFTextObj_SetTextRenderMode",2),i["_FPDFTextObj_GetFont"]=ae("FPDFTextObj_GetFont",1),i["_FPDFFont_GetBaseFontName"]=ae("FPDFFont_GetBaseFontName",3),i["_FPDFFont_GetFamilyName"]=ae("FPDFFont_GetFamilyName",3),i["_FPDFFont_GetFontData"]=ae("FPDFFont_GetFontData",4),i["_FPDFFont_GetIsEmbedded"]=ae("FPDFFont_GetIsEmbedded",1),i["_FPDFFont_GetFlags"]=ae("FPDFFont_GetFlags",1),i["_FPDFFont_GetWeight"]=ae("FPDFFont_GetWeight",1),i["_FPDFFont_GetItalicAngle"]=ae("FPDFFont_GetItalicAngle",2),i["_FPDFFont_GetAscent"]=ae("FPDFFont_GetAscent",3),i["_FPDFFont_GetDescent"]=ae("FPDFFont_GetDescent",3),i["_FPDFFont_GetGlyphWidth"]=ae("FPDFFont_GetGlyphWidth",4),i["_FPDFFont_GetGlyphPath"]=ae("FPDFFont_GetGlyphPath",3),i["_FPDFGlyphPath_CountGlyphSegments"]=ae("FPDFGlyphPath_CountGlyphSegments",1),i["_FPDFGlyphPath_GetGlyphPathSegment"]=ae("FPDFGlyphPath_GetGlyphPathSegment",2),i["_EPDFText_RedactInRect"]=ae("EPDFText_RedactInRect",4),i["_EPDFText_RedactInQuads"]=ae("EPDFText_RedactInQuads",5),i["_FPDFDoc_GetPageMode"]=ae("FPDFDoc_GetPageMode",1),i["_FPDFPage_Flatten"]=ae("FPDFPage_Flatten",2),i["_FPDFPage_HasFormFieldAtPoint"]=ae("FPDFPage_HasFormFieldAtPoint",4),i["_FPDFPage_FormFieldZOrderAtPoint"]=ae("FPDFPage_FormFieldZOrderAtPoint",4),i["_malloc"]=ae("malloc",1),i["_free"]=ae("free",1),i["_FORM_OnMouseMove"]=ae("FORM_OnMouseMove",5),i["_FORM_OnMouseWheel"]=ae("FORM_OnMouseWheel",6),i["_FORM_OnFocus"]=ae("FORM_OnFocus",5),i["_FORM_OnLButtonDown"]=ae("FORM_OnLButtonDown",5),i["_FORM_OnLButtonUp"]=ae("FORM_OnLButtonUp",5),i["_FORM_OnLButtonDoubleClick"]=ae("FORM_OnLButtonDoubleClick",5),i["_FORM_OnRButtonDown"]=ae("FORM_OnRButtonDown",5),i["_FORM_OnRButtonUp"]=ae("FORM_OnRButtonUp",5),i["_FORM_OnKeyDown"]=ae("FORM_OnKeyDown",4),i["_FORM_OnKeyUp"]=ae("FORM_OnKeyUp",4),i["_FORM_OnChar"]=ae("FORM_OnChar",4),i["_FORM_GetFocusedText"]=ae("FORM_GetFocusedText",4),i["_FORM_GetSelectedText"]=ae("FORM_GetSelectedText",4),i["_FORM_ReplaceAndKeepSelection"]=ae("FORM_ReplaceAndKeepSelection",3),i["_FORM_ReplaceSelection"]=ae("FORM_ReplaceSelection",3),i["_FORM_SelectAllText"]=ae("FORM_SelectAllText",2),i["_FORM_CanUndo"]=ae("FORM_CanUndo",2),i["_FORM_CanRedo"]=ae("FORM_CanRedo",2),i["_FORM_Undo"]=ae("FORM_Undo",2),i["_FORM_Redo"]=ae("FORM_Redo",2),i["_FORM_ForceToKillFocus"]=ae("FORM_ForceToKillFocus",1),i["_FORM_GetFocusedAnnot"]=ae("FORM_GetFocusedAnnot",3),i["_FORM_SetFocusedAnnot"]=ae("FORM_SetFocusedAnnot",2),i["_FPDF_FFLDraw"]=ae("FPDF_FFLDraw",9),i["_FPDF_SetFormFieldHighlightColor"]=ae("FPDF_SetFormFieldHighlightColor",3),i["_FPDF_SetFormFieldHighlightAlpha"]=ae("FPDF_SetFormFieldHighlightAlpha",2),i["_FPDF_RemoveFormFieldHighlight"]=ae("FPDF_RemoveFormFieldHighlight",1),i["_FORM_OnAfterLoadPage"]=ae("FORM_OnAfterLoadPage",2),i["_FORM_OnBeforeClosePage"]=ae("FORM_OnBeforeClosePage",2),i["_FORM_DoDocumentJSAction"]=ae("FORM_DoDocumentJSAction",1),i["_FORM_DoDocumentOpenAction"]=ae("FORM_DoDocumentOpenAction",1),i["_FORM_DoDocumentAAction"]=ae("FORM_DoDocumentAAction",2),i["_FORM_DoPageAAction"]=ae("FORM_DoPageAAction",3),i["_FORM_SetIndexSelected"]=ae("FORM_SetIndexSelected",4),i["_FORM_IsIndexSelected"]=ae("FORM_IsIndexSelected",3),i["_FPDFDoc_GetJavaScriptActionCount"]=ae("FPDFDoc_GetJavaScriptActionCount",1),i["_FPDFDoc_GetJavaScriptAction"]=ae("FPDFDoc_GetJavaScriptAction",2),i["_FPDFDoc_CloseJavaScriptAction"]=ae("FPDFDoc_CloseJavaScriptAction",1),i["_FPDFJavaScriptAction_GetName"]=ae("FPDFJavaScriptAction_GetName",3),i["_FPDFJavaScriptAction_GetScript"]=ae("FPDFJavaScriptAction_GetScript",3),i["_FPDF_ImportPagesByIndex"]=ae("FPDF_ImportPagesByIndex",5),i["_FPDF_ImportPages"]=ae("FPDF_ImportPages",4),i["_FPDF_ImportNPagesToOne"]=ae("FPDF_ImportNPagesToOne",5),i["_FPDF_NewXObjectFromPage"]=ae("FPDF_NewXObjectFromPage",3),i["_FPDF_CloseXObject"]=ae("FPDF_CloseXObject",1),i["_FPDF_NewFormObjectFromXObject"]=ae("FPDF_NewFormObjectFromXObject",1),i["_FPDF_CopyViewerPreferences"]=ae("FPDF_CopyViewerPreferences",2),i["_FPDF_RenderPageBitmapWithColorScheme_Start"]=ae("FPDF_RenderPageBitmapWithColorScheme_Start",10),i["_FPDF_RenderPageBitmap_Start"]=ae("FPDF_RenderPageBitmap_Start",9),i["_FPDF_RenderPage_Continue"]=ae("FPDF_RenderPage_Continue",2),i["_FPDF_RenderPage_Close"]=ae("FPDF_RenderPage_Close",1),i["_FPDF_SaveWithVersion"]=ae("FPDF_SaveWithVersion",4),i["_FPDFText_GetCharIndexFromTextIndex"]=ae("FPDFText_GetCharIndexFromTextIndex",2),i["_FPDFText_GetTextIndexFromCharIndex"]=ae("FPDFText_GetTextIndexFromCharIndex",2),i["_FPDF_GetSignatureCount"]=ae("FPDF_GetSignatureCount",1),i["_FPDF_GetSignatureObject"]=ae("FPDF_GetSignatureObject",2),i["_FPDFSignatureObj_GetContents"]=ae("FPDFSignatureObj_GetContents",3),i["_FPDFSignatureObj_GetByteRange"]=ae("FPDFSignatureObj_GetByteRange",3),i["_FPDFSignatureObj_GetSubFilter"]=ae("FPDFSignatureObj_GetSubFilter",3),i["_FPDFSignatureObj_GetReason"]=ae("FPDFSignatureObj_GetReason",3),i["_FPDFSignatureObj_GetTime"]=ae("FPDFSignatureObj_GetTime",3),i["_FPDFSignatureObj_GetDocMDPPermission"]=ae("FPDFSignatureObj_GetDocMDPPermission",1),i["_FPDF_StructTree_GetForPage"]=ae("FPDF_StructTree_GetForPage",1),i["_FPDF_StructTree_Close"]=ae("FPDF_StructTree_Close",1),i["_FPDF_StructTree_CountChildren"]=ae("FPDF_StructTree_CountChildren",1),i["_FPDF_StructTree_GetChildAtIndex"]=ae("FPDF_StructTree_GetChildAtIndex",2),i["_FPDF_StructElement_GetAltText"]=ae("FPDF_StructElement_GetAltText",3),i["_FPDF_StructElement_GetActualText"]=ae("FPDF_StructElement_GetActualText",3),i["_FPDF_StructElement_GetID"]=ae("FPDF_StructElement_GetID",3),i["_FPDF_StructElement_GetLang"]=ae("FPDF_StructElement_GetLang",3),i["_FPDF_StructElement_GetAttributeCount"]=ae("FPDF_StructElement_GetAttributeCount",1),i["_FPDF_StructElement_GetAttributeAtIndex"]=ae("FPDF_StructElement_GetAttributeAtIndex",2),i["_FPDF_StructElement_GetStringAttribute"]=ae("FPDF_StructElement_GetStringAttribute",4),i["_FPDF_StructElement_GetMarkedContentID"]=ae("FPDF_StructElement_GetMarkedContentID",1),i["_FPDF_StructElement_GetType"]=ae("FPDF_StructElement_GetType",3),i["_FPDF_StructElement_GetObjType"]=ae("FPDF_StructElement_GetObjType",3),i["_FPDF_StructElement_GetTitle"]=ae("FPDF_StructElement_GetTitle",3),i["_FPDF_StructElement_CountChildren"]=ae("FPDF_StructElement_CountChildren",1),i["_FPDF_StructElement_GetChildAtIndex"]=ae("FPDF_StructElement_GetChildAtIndex",2),i["_FPDF_StructElement_GetChildMarkedContentID"]=ae("FPDF_StructElement_GetChildMarkedContentID",2),i["_FPDF_StructElement_GetParent"]=ae("FPDF_StructElement_GetParent",1),i["_FPDF_StructElement_Attr_GetCount"]=ae("FPDF_StructElement_Attr_GetCount",1),i["_FPDF_StructElement_Attr_GetName"]=ae("FPDF_StructElement_Attr_GetName",5),i["_FPDF_StructElement_Attr_GetValue"]=ae("FPDF_StructElement_Attr_GetValue",2),i["_FPDF_StructElement_Attr_GetType"]=ae("FPDF_StructElement_Attr_GetType",1),i["_FPDF_StructElement_Attr_GetBooleanValue"]=ae("FPDF_StructElement_Attr_GetBooleanValue",2),i["_FPDF_StructElement_Attr_GetNumberValue"]=ae("FPDF_StructElement_Attr_GetNumberValue",2),i["_FPDF_StructElement_Attr_GetStringValue"]=ae("FPDF_StructElement_Attr_GetStringValue",4),i["_FPDF_StructElement_Attr_GetBlobValue"]=ae("FPDF_StructElement_Attr_GetBlobValue",4),i["_FPDF_StructElement_Attr_CountChildren"]=ae("FPDF_StructElement_Attr_CountChildren",1),i["_FPDF_StructElement_Attr_GetChildAtIndex"]=ae("FPDF_StructElement_Attr_GetChildAtIndex",2),i["_FPDF_StructElement_GetMarkedContentIdCount"]=ae("FPDF_StructElement_GetMarkedContentIdCount",1),i["_FPDF_StructElement_GetMarkedContentIdAtIndex"]=ae("FPDF_StructElement_GetMarkedContentIdAtIndex",2),i["_FPDF_AddInstalledFont"]=ae("FPDF_AddInstalledFont",3),i["_FPDF_SetSystemFontInfo"]=ae("FPDF_SetSystemFontInfo",1),i["_FPDF_GetDefaultTTFMap"]=ae("FPDF_GetDefaultTTFMap",0),i["_FPDF_GetDefaultTTFMapCount"]=ae("FPDF_GetDefaultTTFMapCount",0),i["_FPDF_GetDefaultTTFMapEntry"]=ae("FPDF_GetDefaultTTFMapEntry",1),i["_FPDF_GetDefaultSystemFontInfo"]=ae("FPDF_GetDefaultSystemFontInfo",0),i["_FPDF_FreeDefaultSystemFontInfo"]=ae("FPDF_FreeDefaultSystemFontInfo",1),i["_FPDFText_LoadPage"]=ae("FPDFText_LoadPage",1),i["_FPDFText_ClosePage"]=ae("FPDFText_ClosePage",1),i["_FPDFText_CountChars"]=ae("FPDFText_CountChars",1),i["_FPDFText_GetUnicode"]=ae("FPDFText_GetUnicode",2),i["_FPDFText_GetTextObject"]=ae("FPDFText_GetTextObject",2),i["_FPDFText_IsGenerated"]=ae("FPDFText_IsGenerated",2),i["_FPDFText_IsHyphen"]=ae("FPDFText_IsHyphen",2),i["_FPDFText_HasUnicodeMapError"]=ae("FPDFText_HasUnicodeMapError",2),i["_FPDFText_GetFontSize"]=ae("FPDFText_GetFontSize",2),i["_FPDFText_GetFontInfo"]=ae("FPDFText_GetFontInfo",5),i["_FPDFText_GetFontWeight"]=ae("FPDFText_GetFontWeight",2),i["_FPDFText_GetFillColor"]=ae("FPDFText_GetFillColor",6),i["_FPDFText_GetStrokeColor"]=ae("FPDFText_GetStrokeColor",6),i["_FPDFText_GetCharAngle"]=ae("FPDFText_GetCharAngle",2),i["_FPDFText_GetCharBox"]=ae("FPDFText_GetCharBox",6),i["_FPDFText_GetLooseCharBox"]=ae("FPDFText_GetLooseCharBox",3),i["_FPDFText_GetMatrix"]=ae("FPDFText_GetMatrix",3),i["_FPDFText_GetCharOrigin"]=ae("FPDFText_GetCharOrigin",4),i["_FPDFText_GetCharIndexAtPos"]=ae("FPDFText_GetCharIndexAtPos",5),i["_FPDFText_GetText"]=ae("FPDFText_GetText",4),i["_FPDFText_CountRects"]=ae("FPDFText_CountRects",3),i["_FPDFText_GetRect"]=ae("FPDFText_GetRect",6),i["_FPDFText_GetBoundedText"]=ae("FPDFText_GetBoundedText",7),i["_FPDFText_FindStart"]=ae("FPDFText_FindStart",4),i["_FPDFText_FindNext"]=ae("FPDFText_FindNext",1),i["_FPDFText_FindPrev"]=ae("FPDFText_FindPrev",1),i["_FPDFText_GetSchResultIndex"]=ae("FPDFText_GetSchResultIndex",1),i["_FPDFText_GetSchCount"]=ae("FPDFText_GetSchCount",1),i["_FPDFText_FindClose"]=ae("FPDFText_FindClose",1),i["_FPDFLink_LoadWebLinks"]=ae("FPDFLink_LoadWebLinks",1),i["_FPDFLink_CountWebLinks"]=ae("FPDFLink_CountWebLinks",1),i["_FPDFLink_GetURL"]=ae("FPDFLink_GetURL",4),i["_FPDFLink_CountRects"]=ae("FPDFLink_CountRects",2),i["_FPDFLink_GetRect"]=ae("FPDFLink_GetRect",7),i["_FPDFLink_GetTextRange"]=ae("FPDFLink_GetTextRange",4),i["_FPDFLink_CloseWebLinks"]=ae("FPDFLink_CloseWebLinks",1),i["_FPDFPage_GetDecodedThumbnailData"]=ae("FPDFPage_GetDecodedThumbnailData",3),i["_FPDFPage_GetRawThumbnailData"]=ae("FPDFPage_GetRawThumbnailData",3),i["_FPDFPage_GetThumbnailAsBitmap"]=ae("FPDFPage_GetThumbnailAsBitmap",1),i["_FPDFPage_SetMediaBox"]=ae("FPDFPage_SetMediaBox",5),i["_FPDFPage_SetCropBox"]=ae("FPDFPage_SetCropBox",5),i["_FPDFPage_SetBleedBox"]=ae("FPDFPage_SetBleedBox",5),i["_FPDFPage_SetTrimBox"]=ae("FPDFPage_SetTrimBox",5),i["_FPDFPage_SetArtBox"]=ae("FPDFPage_SetArtBox",5),i["_FPDFPage_GetMediaBox"]=ae("FPDFPage_GetMediaBox",5),i["_FPDFPage_GetCropBox"]=ae("FPDFPage_GetCropBox",5),i["_FPDFPage_GetBleedBox"]=ae("FPDFPage_GetBleedBox",5),i["_FPDFPage_GetTrimBox"]=ae("FPDFPage_GetTrimBox",5),i["_FPDFPage_GetArtBox"]=ae("FPDFPage_GetArtBox",5),i["_FPDFPage_TransFormWithClip"]=ae("FPDFPage_TransFormWithClip",3),i["_FPDFPageObj_TransformClipPath"]=ae("FPDFPageObj_TransformClipPath",7),i["_FPDFPageObj_GetClipPath"]=ae("FPDFPageObj_GetClipPath",1),i["_FPDFClipPath_CountPaths"]=ae("FPDFClipPath_CountPaths",1),i["_FPDFClipPath_CountPathSegments"]=ae("FPDFClipPath_CountPathSegments",2),i["_FPDFClipPath_GetPathSegment"]=ae("FPDFClipPath_GetPathSegment",3),i["_FPDF_CreateClipPath"]=ae("FPDF_CreateClipPath",4),i["_FPDF_DestroyClipPath"]=ae("FPDF_DestroyClipPath",1),i["_FPDFPage_InsertClipPath"]=ae("FPDFPage_InsertClipPath",2),i["_FPDF_InitLibrary"]=ae("FPDF_InitLibrary",0),i["_FPDF_DestroyLibrary"]=ae("FPDF_DestroyLibrary",0),i["_FPDF_SetSandBoxPolicy"]=ae("FPDF_SetSandBoxPolicy",2),i["_FPDF_LoadDocument"]=ae("FPDF_LoadDocument",2),i["_FPDF_GetFormType"]=ae("FPDF_GetFormType",1),i["_FPDF_LoadXFA"]=ae("FPDF_LoadXFA",1),i["_FPDF_LoadMemDocument"]=ae("FPDF_LoadMemDocument",3),i["_FPDF_LoadMemDocument64"]=ae("FPDF_LoadMemDocument64",3),i["_FPDF_LoadCustomDocument"]=ae("FPDF_LoadCustomDocument",2),i["_FPDF_GetFileVersion"]=ae("FPDF_GetFileVersion",2),i["_FPDF_DocumentHasValidCrossReferenceTable"]=ae("FPDF_DocumentHasValidCrossReferenceTable",1),i["_FPDF_GetDocPermissions"]=ae("FPDF_GetDocPermissions",1),i["_FPDF_GetDocUserPermissions"]=ae("FPDF_GetDocUserPermissions",1),i["_FPDF_GetSecurityHandlerRevision"]=ae("FPDF_GetSecurityHandlerRevision",1),i["_FPDF_GetPageCount"]=ae("FPDF_GetPageCount",1),i["_FPDF_LoadPage"]=ae("FPDF_LoadPage",2),i["_FPDF_GetPageWidthF"]=ae("FPDF_GetPageWidthF",1),i["_FPDF_GetPageWidth"]=ae("FPDF_GetPageWidth",1),i["_FPDF_GetPageHeightF"]=ae("FPDF_GetPageHeightF",1),i["_FPDF_GetPageHeight"]=ae("FPDF_GetPageHeight",1),i["_FPDF_GetPageBoundingBox"]=ae("FPDF_GetPageBoundingBox",2),i["_FPDF_RenderPageBitmap"]=ae("FPDF_RenderPageBitmap",8),i["_FPDF_RenderPageBitmapWithMatrix"]=ae("FPDF_RenderPageBitmapWithMatrix",5),i["_EPDF_RenderAnnotBitmap"]=ae("EPDF_RenderAnnotBitmap",6),i["_FPDF_ClosePage"]=ae("FPDF_ClosePage",1),i["_FPDF_CloseDocument"]=ae("FPDF_CloseDocument",1),i["_FPDF_GetLastError"]=ae("FPDF_GetLastError",0),i["_FPDF_DeviceToPage"]=ae("FPDF_DeviceToPage",10),i["_FPDF_PageToDevice"]=ae("FPDF_PageToDevice",10),i["_FPDFBitmap_Create"]=ae("FPDFBitmap_Create",3),i["_FPDFBitmap_CreateEx"]=ae("FPDFBitmap_CreateEx",5),i["_FPDFBitmap_GetFormat"]=ae("FPDFBitmap_GetFormat",1),i["_FPDFBitmap_FillRect"]=ae("FPDFBitmap_FillRect",6),i["_FPDFBitmap_GetBuffer"]=ae("FPDFBitmap_GetBuffer",1),i["_FPDFBitmap_GetWidth"]=ae("FPDFBitmap_GetWidth",1),i["_FPDFBitmap_GetHeight"]=ae("FPDFBitmap_GetHeight",1),i["_FPDFBitmap_GetStride"]=ae("FPDFBitmap_GetStride",1),i["_FPDFBitmap_Destroy"]=ae("FPDFBitmap_Destroy",1),i["_FPDF_GetPageSizeByIndexF"]=ae("FPDF_GetPageSizeByIndexF",3),i["_EPDF_GetPageRotationByIndex"]=ae("EPDF_GetPageRotationByIndex",2),i["_FPDF_GetPageSizeByIndex"]=ae("FPDF_GetPageSizeByIndex",4),i["_FPDF_VIEWERREF_GetPrintScaling"]=ae("FPDF_VIEWERREF_GetPrintScaling",1),i["_FPDF_VIEWERREF_GetNumCopies"]=ae("FPDF_VIEWERREF_GetNumCopies",1),i["_FPDF_VIEWERREF_GetPrintPageRange"]=ae("FPDF_VIEWERREF_GetPrintPageRange",1),i["_FPDF_VIEWERREF_GetPrintPageRangeCount"]=ae("FPDF_VIEWERREF_GetPrintPageRangeCount",1),i["_FPDF_VIEWERREF_GetPrintPageRangeElement"]=ae("FPDF_VIEWERREF_GetPrintPageRangeElement",2),i["_FPDF_VIEWERREF_GetDuplex"]=ae("FPDF_VIEWERREF_GetDuplex",1),i["_FPDF_VIEWERREF_GetName"]=ae("FPDF_VIEWERREF_GetName",4),i["_FPDF_CountNamedDests"]=ae("FPDF_CountNamedDests",1),i["_FPDF_GetNamedDestByName"]=ae("FPDF_GetNamedDestByName",2),i["_FPDF_GetNamedDest"]=ae("FPDF_GetNamedDest",4),i["_FPDF_GetXFAPacketCount"]=ae("FPDF_GetXFAPacketCount",1),i["_FPDF_GetXFAPacketName"]=ae("FPDF_GetXFAPacketName",4),i["_FPDF_GetXFAPacketContent"]=ae("FPDF_GetXFAPacketContent",5),i["_FPDF_GetTrailerEnds"]=ae("FPDF_GetTrailerEnds",3);var Dn=ae("fflush",1),bn=ae("emscripten_builtin_memalign",2),fn=ae("strerror",1),pn=ae("setThrew",2),An=()=>(An=hn["emscripten_stack_init"])(),En=()=>(En=hn["emscripten_stack_get_end"])(),yn=e=>(yn=hn["_emscripten_stack_restore"])(e),Mn=e=>(Mn=hn["_emscripten_stack_alloc"])(e),Gn=()=>(Gn=hn["emscripten_stack_get_current"])();function Cn(e,t,n,r){var o=Me();try{Xt(e)(t,n,r)}catch(a){if(ye(o),a!==a+0)throw a;pn(1,0)}}function Sn(e,t){var n=Me();try{return Xt(e)(t)}catch(r){if(ye(n),r!==r+0)throw r;pn(1,0)}}function Tn(e,t,n){var r=Me();try{return Xt(e)(t,n)}catch(o){if(ye(r),o!==o+0)throw o;pn(1,0)}}function xn(e,t,n,r){var o=Me();try{return Xt(e)(t,n,r)}catch(a){if(ye(o),a!==a+0)throw a;pn(1,0)}}function vn(e,t,n,r,o){var a=Me();try{Xt(e)(t,n,r,o)}catch(i){if(ye(a),i!==i+0)throw i;pn(1,0)}}function On(e,t,n,r,o){var a=Me();try{return Xt(e)(t,n,r,o)}catch(i){if(ye(a),i!==i+0)throw i;pn(1,0)}}function wn(e){var t=Me();try{Xt(e)()}catch(n){if(ye(t),n!==n+0)throw n;pn(1,0)}}function kn(e,t,n){var r=Me();try{Xt(e)(t,n)}catch(o){if(ye(r),o!==o+0)throw o;pn(1,0)}}function Rn(e,t,n,r,o,a,i,s,u,m){var F=Me();try{Xt(e)(t,n,r,o,a,i,s,u,m)}catch(l){if(ye(F),l!==l+0)throw l;pn(1,0)}}i["dynCall_ji"]=ae("dynCall_ji",2),i["dynCall_jij"]=ae("dynCall_jij",4),i["dynCall_iiij"]=ae("dynCall_iiij",5),i["dynCall_iij"]=ae("dynCall_iij",4),i["dynCall_j"]=ae("dynCall_j",1),i["dynCall_jji"]=ae("dynCall_jji",4),i["dynCall_iji"]=ae("dynCall_iji",4),i["dynCall_viijii"]=ae("dynCall_viijii",7),i["dynCall_iiji"]=ae("dynCall_iiji",5),i["dynCall_jiji"]=ae("dynCall_jiji",5),i["dynCall_iiiiij"]=ae("dynCall_iiiiij",7),i["dynCall_iiiiijj"]=ae("dynCall_iiiiijj",9),i["dynCall_iiiiiijj"]=ae("dynCall_iiiiiijj",10),i["dynCall_viji"]=ae("dynCall_viji",5),i["wasmExports"]=hn,i["ccall"]=ln,i["cwrap"]=dn,i["addFunction"]=an,i["removeFunction"]=_n,i["setValue"]=Ee,i["getValue"]=pe,i["UTF8ToString"]=Te,i["stringToUTF8"]=ut,i["UTF16ToString"]=Kt,i["stringToUTF16"]=cn;var In=["writeI53ToI64","writeI53ToI64Clamped","writeI53ToI64Signaling","writeI53ToU64Clamped","writeI53ToU64Signaling","readI53FromI64","readI53FromU64","convertI32PairToI53","convertU32PairToI53","getTempRet0","setTempRet0","exitJS","inetPton4","inetNtop4","inetPton6","inetNtop6","readSockaddr","writeSockaddr","emscriptenLog","readEmAsmArgs","jstoi_q","listenOnce","autoResumeAudioContext","dynCallLegacy","getDynCaller","dynCall","handleException","keepRuntimeAlive","runtimeKeepalivePush","runtimeKeepalivePop","callUserCallback","maybeExit","asmjsMangle","HandleAllocator","getNativeTypeSize","STACK_SIZE","STACK_ALIGN","POINTER_SIZE","ASSERTIONS","reallyNegative","unSign","strLen","reSign","formatString","intArrayToString","AsciiToString","lengthBytesUTF16","UTF32ToString","stringToUTF32","lengthBytesUTF32","stringToNewUTF8","registerKeyEventCallback","maybeCStringToJsString","findEventTarget","getBoundingClientRect","fillMouseEventData","registerMouseEventCallback","registerWheelEventCallback","registerUiEventCallback","registerFocusEventCallback","fillDeviceOrientationEventData","registerDeviceOrientationEventCallback","fillDeviceMotionEventData","registerDeviceMotionEventCallback","screenOrientation","fillOrientationChangeEventData","registerOrientationChangeEventCallback","fillFullscreenChangeEventData","registerFullscreenChangeEventCallback","JSEvents_requestFullscreen","JSEvents_resizeCanvasForFullscreen","registerRestoreOldStyle","hideEverythingExceptGivenElement","restoreHiddenElements","setLetterbox","softFullscreenResizeWebGLRenderTarget","doRequestFullscreen","fillPointerlockChangeEventData","registerPointerlockChangeEventCallback","registerPointerlockErrorEventCallback","requestPointerLock","fillVisibilityChangeEventData","registerVisibilityChangeEventCallback","registerTouchEventCallback","fillGamepadEventData","registerGamepadEventCallback","registerBeforeUnloadEventCallback","fillBatteryEventData","battery","registerBatteryEventCallback","setCanvasElementSize","getCanvasElementSize","jsStackTrace","getCallstack","convertPCtoSourceLocation","checkWasiClock","wasiRightsToMuslOFlags","wasiOFlagsToMuslOFlags","createDyncallWrapper","safeSetTimeout","setImmediateWrapped","clearImmediateWrapped","polyfillSetImmediate","registerPostMainLoop","registerPreMainLoop","getPromise","makePromise","idsToPromises","makePromiseCallback","ExceptionInfo","findMatchingCatch","Browser_asyncPrepareDataCounter","safeRequestAnimationFrame","arraySum","addDays","getSocketFromFD","getSocketAddress","FS_unlink","FS_mkdirTree","_setNetworkCallback","heapObjectForWebGLType","toTypedArrayIndex","webgl_enable_ANGLE_instanced_arrays","webgl_enable_OES_vertex_array_object","webgl_enable_WEBGL_draw_buffers","webgl_enable_WEBGL_multi_draw","webgl_enable_EXT_polygon_offset_clamp","webgl_enable_EXT_clip_control","webgl_enable_WEBGL_polygon_mode","emscriptenWebGLGet","computeUnpackAlignedImageSize","colorChannelsInGlTextureFormat","emscriptenWebGLGetTexPixelData","emscriptenWebGLGetUniform","webglGetUniformLocation","webglPrepareUniformLocationsBeforeFirstUse","webglGetLeftBracePos","emscriptenWebGLGetVertexAttrib","__glGetActiveAttribOrUniform","writeGLArray","registerWebGlEventCallback","runAndAbortIfError","ALLOC_NORMAL","ALLOC_STACK","allocate","writeStringToMemory","writeAsciiToMemory","setErrNo","demangle","stackTrace"];In.forEach(De);var jn,Bn,Ln=["run","addOnPreRun","addOnInit","addOnPreMain","addOnExit","addOnPostRun","addRunDependency","removeRunDependency","out","err","callMain","abort","wasmMemory","writeStackCookie","checkStackCookie","convertI32PairToI53Checked","stackSave","stackRestore","stackAlloc","ptrToString","zeroMemory","getHeapMax","growMemory","ENV","ERRNO_CODES","strError","DNS","Protocols","Sockets","initRandomFill","randomFill","timers","warnOnce","readEmAsmArgsArray","jstoi_s","getExecutableName","asyncLoad","alignMemory","mmapAlloc","wasmTable","noExitRuntime","getCFunc","uleb128Encode","sigToWasmTypes","generateFuncType","convertJsFunctionToWasm","freeTableIndexes","functionsInTableMap","getEmptyTableSlot","updateTableMap","getFunctionAddress","PATH","PATH_FS","UTF8Decoder","UTF8ArrayToString","stringToUTF8Array","lengthBytesUTF8","intArrayFromString","stringToAscii","UTF16Decoder","stringToUTF8OnStack","writeArrayToMemory","JSEvents","specialHTMLTargets","findCanvasEventTarget","currentFullscreenStrategy","restoreOldWindowedStyle","UNWIND_CACHE","ExitStatus","getEnvStrings","doReadv","doWritev","promiseMap","uncaughtExceptionCount","exceptionLast","exceptionCaught","Browser","getPreloadedImageData__data","wget","MONTH_DAYS_REGULAR","MONTH_DAYS_LEAP","MONTH_DAYS_REGULAR_CUMULATIVE","MONTH_DAYS_LEAP_CUMULATIVE","isLeapYear","ydayFromDate","SYSCALLS","preloadPlugins","FS_createPreloadedFile","FS_modeStringToFlags","FS_getMode","FS_stdin_getChar_buffer","FS_stdin_getChar","FS_createPath","FS_createDevice","FS_readFile","FS","FS_createDataFile","FS_createLazyFile","MEMFS","TTY","PIPEFS","SOCKFS","tempFixedLengthArray","miniTempWebGLFloatBuffers","miniTempWebGLIntBuffers","GL","AL","GLUT","EGL","GLEW","IDBStore","SDL","SDL_gfx","allocateUTF8","allocateUTF8OnStack","print","printErr"];function Nn(){An(),w()}function Vn(){function e(){jn||(jn=1,i["calledRun"]=1,x||(N(),o(i),i["onRuntimeInitialized"]?.(),v(!i["_main"],'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),V()))}$>0||(Nn(),!Bn&&(Bn=1,L(),$>0)||(i["setStatus"]?(i["setStatus"]("Running..."),setTimeout(()=>{setTimeout(()=>i["setStatus"](""),1),e()},1)):e(),k()))}if(Ln.forEach(be),X=function e(){jn||Vn(),jn||(X=e)},i["preInit"]){"function"==typeof i["preInit"]&&(i["preInit"]=[i["preInit"]]);while(i["preInit"].length>0)i["preInit"].pop()()}Vn(),r=s;for(const e of Object.keys(i))e in t||Object.defineProperty(t,e,{configurable:!0,get(){q(`Access to module property ('${e}') is no longer possible via the module constructor argument; Instead, use the result of the module constructor.`)}});return r}})();const o={EPDF_GetMetaKeyCount:[["number","boolean"],"number"],EPDF_GetMetaKeyName:[["number","number","boolean","number","number"],"number"],EPDF_GetMetaTrapped:[["number"],"number"],EPDF_GetPageRotationByIndex:[["number","number"],"number"],EPDF_HasMetaText:[["number","string"],"boolean"],EPDF_PNG_EncodeRGBA:[["number","number","number","number","number","number"],"number"],EPDF_RenderAnnotBitmap:[["number","number","number","number","number","number"],"boolean"],EPDF_SetMetaText:[["number","string","number"],"boolean"],EPDF_SetMetaTrapped:[["number","number"],"boolean"],EPDFAction_CreateGoTo:[["number","number"],"number"],EPDFAction_CreateGoToNamed:[["number","string"],"number"],EPDFAction_CreateLaunch:[["number","number"],"number"],EPDFAction_CreateRemoteGoToByName:[["number","number","number"],"number"],EPDFAction_CreateRemoteGoToDest:[["number","number","number"],"number"],EPDFAction_CreateURI:[["number","string"],"number"],EPDFAnnot_ClearColor:[["number","number"],"boolean"],EPDFAnnot_GenerateAppearance:[["number"],"boolean"],EPDFAnnot_GenerateAppearanceWithBlend:[["number","number"],"boolean"],EPDFAnnot_GetBlendMode:[["number"],"number"],EPDFAnnot_GetBorderDashPattern:[["number","number","number"],"boolean"],EPDFAnnot_GetBorderDashPatternCount:[["number"],"number"],EPDFAnnot_GetBorderEffect:[["number","number"],"boolean"],EPDFAnnot_GetBorderStyle:[["number","number"],"number"],EPDFAnnot_GetColor:[["number","number","number","number","number"],"boolean"],EPDFAnnot_GetDefaultAppearance:[["number","number","number","number","number","number"],"boolean"],EPDFAnnot_GetIcon:[["number"],"number"],EPDFAnnot_GetIntent:[["number","number","number"],"number"],EPDFAnnot_GetLineEndings:[["number","number","number"],"boolean"],EPDFAnnot_GetOpacity:[["number","number"],"boolean"],EPDFAnnot_GetRectangleDifferences:[["number","number","number","number","number"],"boolean"],EPDFAnnot_GetRichContent:[["number","number","number"],"number"],EPDFAnnot_GetTextAlignment:[["number"],"number"],EPDFAnnot_GetVerticalAlignment:[["number"],"number"],EPDFAnnot_SetBorderDashPattern:[["number","number","number"],"boolean"],EPDFAnnot_SetBorderStyle:[["number","number","number"],"boolean"],EPDFAnnot_SetColor:[["number","number","number","number","number"],"boolean"],EPDFAnnot_SetDefaultAppearance:[["number","number","number","number","number","number"],"boolean"],EPDFAnnot_SetIcon:[["number","number"],"boolean"],EPDFAnnot_SetIntent:[["number","string"],"boolean"],EPDFAnnot_SetLine:[["number","number","number"],"boolean"],EPDFAnnot_SetLineEndings:[["number","number","number"],"boolean"],EPDFAnnot_SetLinkedAnnot:[["number","string","number"],"boolean"],EPDFAnnot_SetOpacity:[["number","number"],"boolean"],EPDFAnnot_SetTextAlignment:[["number","number"],"boolean"],EPDFAnnot_SetVerticalAlignment:[["number","number"],"boolean"],EPDFAnnot_SetVertices:[["number","number","number"],"boolean"],EPDFAnnot_UpdateAppearanceToRect:[["number","number"],"boolean"],EPDFAttachment_GetDescription:[["number","number","number"],"number"],EPDFAttachment_GetIntegerValue:[["number","string","number"],"boolean"],EPDFAttachment_SetDescription:[["number","number"],"boolean"],EPDFAttachment_SetSubtype:[["number","string"],"boolean"],EPDFBookmark_AppendChild:[["number","number","number"],"number"],EPDFBookmark_Clear:[["number"],"boolean"],EPDFBookmark_ClearTarget:[["number"],"boolean"],EPDFBookmark_Create:[["number","number"],"number"],EPDFBookmark_Delete:[["number","number"],"boolean"],EPDFBookmark_InsertAfter:[["number","number","number","number"],"number"],EPDFBookmark_SetAction:[["number","number","number"],"boolean"],EPDFBookmark_SetDest:[["number","number","number"],"boolean"],EPDFBookmark_SetTitle:[["number","number"],"boolean"],EPDFCatalog_GetLanguage:[["number","number","number"],"number"],EPDFDest_CreateRemoteView:[["number","number","number","number","number"],"number"],EPDFDest_CreateRemoteXYZ:[["number","number","boolean","number","boolean","number","boolean","number"],"number"],EPDFDest_CreateView:[["number","number","number","number"],"number"],EPDFDest_CreateXYZ:[["number","boolean","number","boolean","number","boolean","number"],"number"],EPDFNamedDest_Remove:[["number","string"],"boolean"],EPDFNamedDest_SetDest:[["number","string","number"],"boolean"],EPDFPage_CreateAnnot:[["number","number"],"number"],EPDFPage_GetAnnotByName:[["number","number"],"number"],EPDFPage_GetAnnotCountRaw:[["number","number"],"number"],EPDFPage_GetAnnotRaw:[["number","number","number"],"number"],EPDFPage_RemoveAnnotByName:[["number","number"],"boolean"],EPDFPage_RemoveAnnotRaw:[["number","number","number"],"boolean"],EPDFText_RedactInQuads:[["number","number","number","boolean","boolean"],"boolean"],EPDFText_RedactInRect:[["number","number","boolean","boolean"],"boolean"],FORM_CanRedo:[["number","number"],"boolean"],FORM_CanUndo:[["number","number"],"boolean"],FORM_DoDocumentAAction:[["number","number"],null],FORM_DoDocumentJSAction:[["number"],null],FORM_DoDocumentOpenAction:[["number"],null],FORM_DoPageAAction:[["number","number","number"],null],FORM_ForceToKillFocus:[["number"],"boolean"],FORM_GetFocusedAnnot:[["number","number","number"],"boolean"],FORM_GetFocusedText:[["number","number","number","number"],"number"],FORM_GetSelectedText:[["number","number","number","number"],"number"],FORM_IsIndexSelected:[["number","number","number"],"boolean"],FORM_OnAfterLoadPage:[["number","number"],null],FORM_OnBeforeClosePage:[["number","number"],null],FORM_OnChar:[["number","number","number","number"],"boolean"],FORM_OnFocus:[["number","number","number","number","number"],"boolean"],FORM_OnKeyDown:[["number","number","number","number"],"boolean"],FORM_OnKeyUp:[["number","number","number","number"],"boolean"],FORM_OnLButtonDoubleClick:[["number","number","number","number","number"],"boolean"],FORM_OnLButtonDown:[["number","number","number","number","number"],"boolean"],FORM_OnLButtonUp:[["number","number","number","number","number"],"boolean"],FORM_OnMouseMove:[["number","number","number","number","number"],"boolean"],FORM_OnMouseWheel:[["number","number","number","number","number","number"],"boolean"],FORM_OnRButtonDown:[["number","number","number","number","number"],"boolean"],FORM_OnRButtonUp:[["number","number","number","number","number"],"boolean"],FORM_Redo:[["number","number"],"boolean"],FORM_ReplaceAndKeepSelection:[["number","number","number"],null],FORM_ReplaceSelection:[["number","number","number"],null],FORM_SelectAllText:[["number","number"],"boolean"],FORM_SetFocusedAnnot:[["number","number"],"boolean"],FORM_SetIndexSelected:[["number","number","number","boolean"],"boolean"],FORM_Undo:[["number","number"],"boolean"],FPDF_AddInstalledFont:[["number","number","number"],null],FPDF_CloseDocument:[["number"],null],FPDF_ClosePage:[["number"],null],FPDF_CloseXObject:[["number"],null],FPDF_CopyViewerPreferences:[["number","number"],"boolean"],FPDF_CountNamedDests:[["number"],"number"],FPDF_CreateClipPath:[["number","number","number","number"],"number"],FPDF_CreateNewDocument:[[],"number"],FPDF_DestroyClipPath:[["number"],null],FPDF_DestroyLibrary:[[],null],FPDF_DeviceToPage:[["number","number","number","number","number","number","number","number","number","number"],"boolean"],FPDF_DocumentHasValidCrossReferenceTable:[["number"],"boolean"],FPDF_FFLDraw:[["number","number","number","number","number","number","number","number","number"],null],FPDF_FreeDefaultSystemFontInfo:[["number"],null],FPDF_GetDefaultSystemFontInfo:[[],"number"],FPDF_GetDefaultTTFMap:[[],"number"],FPDF_GetDefaultTTFMapCount:[[],"number"],FPDF_GetDefaultTTFMapEntry:[["number"],"number"],FPDF_GetDocPermissions:[["number"],"number"],FPDF_GetDocUserPermissions:[["number"],"number"],FPDF_GetFileIdentifier:[["number","number","number","number"],"number"],FPDF_GetFileVersion:[["number","number"],"boolean"],FPDF_GetFormType:[["number"],"number"],FPDF_GetLastError:[[],"number"],FPDF_GetMetaText:[["number","string","number","number"],"number"],FPDF_GetNamedDest:[["number","number","number","number"],"number"],FPDF_GetNamedDestByName:[["number","string"],"number"],FPDF_GetPageAAction:[["number","number"],"number"],FPDF_GetPageBoundingBox:[["number","number"],"boolean"],FPDF_GetPageCount:[["number"],"number"],FPDF_GetPageHeight:[["number"],"number"],FPDF_GetPageHeightF:[["number"],"number"],FPDF_GetPageLabel:[["number","number","number","number"],"number"],FPDF_GetPageSizeByIndex:[["number","number","number","number"],"number"],FPDF_GetPageSizeByIndexF:[["number","number","number"],"boolean"],FPDF_GetPageWidth:[["number"],"number"],FPDF_GetPageWidthF:[["number"],"number"],FPDF_GetSecurityHandlerRevision:[["number"],"number"],FPDF_GetSignatureCount:[["number"],"number"],FPDF_GetSignatureObject:[["number","number"],"number"],FPDF_GetTrailerEnds:[["number","number","number"],"number"],FPDF_GetXFAPacketContent:[["number","number","number","number","number"],"boolean"],FPDF_GetXFAPacketCount:[["number"],"number"],FPDF_GetXFAPacketName:[["number","number","number","number"],"number"],FPDF_ImportNPagesToOne:[["number","number","number","number","number"],"number"],FPDF_ImportPages:[["number","number","string","number"],"boolean"],FPDF_ImportPagesByIndex:[["number","number","number","number","number"],"boolean"],FPDF_InitLibrary:[[],null],FPDF_InitLibraryWithConfig:[["number"],null],FPDF_LoadCustomDocument:[["number","string"],"number"],FPDF_LoadDocument:[["number","string"],"number"],FPDF_LoadMemDocument:[["number","number","string"],"number"],FPDF_LoadMemDocument64:[["number","number","string"],"number"],FPDF_LoadPage:[["number","number"],"number"],FPDF_LoadXFA:[["number"],"boolean"],FPDF_MovePages:[["number","number","number","number"],"boolean"],FPDF_NewFormObjectFromXObject:[["number"],"number"],FPDF_NewXObjectFromPage:[["number","number","number"],"number"],FPDF_PageToDevice:[["number","number","number","number","number","number","number","number","number","number"],"boolean"],FPDF_RemoveFormFieldHighlight:[["number"],null],FPDF_RenderPage_Close:[["number"],null],FPDF_RenderPage_Continue:[["number","number"],"number"],FPDF_RenderPageBitmap:[["number","number","number","number","number","number","number","number"],null],FPDF_RenderPageBitmap_Start:[["number","number","number","number","number","number","number","number","number"],"number"],FPDF_RenderPageBitmapWithColorScheme_Start:[["number","number","number","number","number","number","number","number","number","number"],"number"],FPDF_RenderPageBitmapWithMatrix:[["number","number","number","number","number"],null],FPDF_SaveAsCopy:[["number","number","number"],"boolean"],FPDF_SaveWithVersion:[["number","number","number","number"],"boolean"],FPDF_SetFormFieldHighlightAlpha:[["number","number"],null],FPDF_SetFormFieldHighlightColor:[["number","number","number"],null],FPDF_SetSandBoxPolicy:[["number","boolean"],null],FPDF_SetSystemFontInfo:[["number"],null],FPDF_StructElement_Attr_CountChildren:[["number"],"number"],FPDF_StructElement_Attr_GetBlobValue:[["number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetBooleanValue:[["number","number"],"boolean"],FPDF_StructElement_Attr_GetChildAtIndex:[["number","number"],"number"],FPDF_StructElement_Attr_GetCount:[["number"],"number"],FPDF_StructElement_Attr_GetName:[["number","number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetNumberValue:[["number","number"],"boolean"],FPDF_StructElement_Attr_GetStringValue:[["number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetType:[["number"],"number"],FPDF_StructElement_Attr_GetValue:[["number","string"],"number"],FPDF_StructElement_CountChildren:[["number"],"number"],FPDF_StructElement_GetActualText:[["number","number","number"],"number"],FPDF_StructElement_GetAltText:[["number","number","number"],"number"],FPDF_StructElement_GetAttributeAtIndex:[["number","number"],"number"],FPDF_StructElement_GetAttributeCount:[["number"],"number"],FPDF_StructElement_GetChildAtIndex:[["number","number"],"number"],FPDF_StructElement_GetChildMarkedContentID:[["number","number"],"number"],FPDF_StructElement_GetID:[["number","number","number"],"number"],FPDF_StructElement_GetLang:[["number","number","number"],"number"],FPDF_StructElement_GetMarkedContentID:[["number"],"number"],FPDF_StructElement_GetMarkedContentIdAtIndex:[["number","number"],"number"],FPDF_StructElement_GetMarkedContentIdCount:[["number"],"number"],FPDF_StructElement_GetObjType:[["number","number","number"],"number"],FPDF_StructElement_GetParent:[["number"],"number"],FPDF_StructElement_GetStringAttribute:[["number","string","number","number"],"number"],FPDF_StructElement_GetTitle:[["number","number","number"],"number"],FPDF_StructElement_GetType:[["number","number","number"],"number"],FPDF_StructTree_Close:[["number"],null],FPDF_StructTree_CountChildren:[["number"],"number"],FPDF_StructTree_GetChildAtIndex:[["number","number"],"number"],FPDF_StructTree_GetForPage:[["number"],"number"],FPDF_VIEWERREF_GetDuplex:[["number"],"number"],FPDF_VIEWERREF_GetName:[["number","string","number","number"],"number"],FPDF_VIEWERREF_GetNumCopies:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRange:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRangeCount:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRangeElement:[["number","number"],"number"],FPDF_VIEWERREF_GetPrintScaling:[["number"],"boolean"],FPDFAction_GetDest:[["number","number"],"number"],FPDFAction_GetFilePath:[["number","number","number"],"number"],FPDFAction_GetType:[["number"],"number"],FPDFAction_GetURIPath:[["number","number","number","number"],"number"],FPDFAnnot_AddFileAttachment:[["number","number"],"number"],FPDFAnnot_AddInkStroke:[["number","number","number"],"number"],FPDFAnnot_AppendAttachmentPoints:[["number","number"],"boolean"],FPDFAnnot_AppendObject:[["number","number"],"boolean"],FPDFAnnot_CountAttachmentPoints:[["number"],"number"],FPDFAnnot_GetAP:[["number","number","number","number"],"number"],FPDFAnnot_GetAttachmentPoints:[["number","number","number"],"boolean"],FPDFAnnot_GetBorder:[["number","number","number","number"],"boolean"],FPDFAnnot_GetColor:[["number","number","number","number","number","number"],"boolean"],FPDFAnnot_GetFileAttachment:[["number"],"number"],FPDFAnnot_GetFlags:[["number"],"number"],FPDFAnnot_GetFocusableSubtypes:[["number","number","number"],"boolean"],FPDFAnnot_GetFocusableSubtypesCount:[["number"],"number"],FPDFAnnot_GetFontColor:[["number","number","number","number","number"],"boolean"],FPDFAnnot_GetFontSize:[["number","number","number"],"boolean"],FPDFAnnot_GetFormAdditionalActionJavaScript:[["number","number","number","number","number"],"number"],FPDFAnnot_GetFormControlCount:[["number","number"],"number"],FPDFAnnot_GetFormControlIndex:[["number","number"],"number"],FPDFAnnot_GetFormFieldAlternateName:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldAtPoint:[["number","number","number"],"number"],FPDFAnnot_GetFormFieldExportValue:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldFlags:[["number","number"],"number"],FPDFAnnot_GetFormFieldName:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldType:[["number","number"],"number"],FPDFAnnot_GetFormFieldValue:[["number","number","number","number"],"number"],FPDFAnnot_GetInkListCount:[["number"],"number"],FPDFAnnot_GetInkListPath:[["number","number","number","number"],"number"],FPDFAnnot_GetLine:[["number","number","number"],"boolean"],FPDFAnnot_GetLink:[["number"],"number"],FPDFAnnot_GetLinkedAnnot:[["number","string"],"number"],FPDFAnnot_GetNumberValue:[["number","string","number"],"boolean"],FPDFAnnot_GetObject:[["number","number"],"number"],FPDFAnnot_GetObjectCount:[["number"],"number"],FPDFAnnot_GetOptionCount:[["number","number"],"number"],FPDFAnnot_GetOptionLabel:[["number","number","number","number","number"],"number"],FPDFAnnot_GetRect:[["number","number"],"boolean"],FPDFAnnot_GetStringValue:[["number","string","number","number"],"number"],FPDFAnnot_GetSubtype:[["number"],"number"],FPDFAnnot_GetValueType:[["number","string"],"number"],FPDFAnnot_GetVertices:[["number","number","number"],"number"],FPDFAnnot_HasAttachmentPoints:[["number"],"boolean"],FPDFAnnot_HasKey:[["number","string"],"boolean"],FPDFAnnot_IsChecked:[["number","number"],"boolean"],FPDFAnnot_IsObjectSupportedSubtype:[["number"],"boolean"],FPDFAnnot_IsOptionSelected:[["number","number","number"],"boolean"],FPDFAnnot_IsSupportedSubtype:[["number"],"boolean"],FPDFAnnot_RemoveInkList:[["number"],"boolean"],FPDFAnnot_RemoveObject:[["number","number"],"boolean"],FPDFAnnot_SetAP:[["number","number","number"],"boolean"],FPDFAnnot_SetAttachmentPoints:[["number","number","number"],"boolean"],FPDFAnnot_SetBorder:[["number","number","number","number"],"boolean"],FPDFAnnot_SetColor:[["number","number","number","number","number","number"],"boolean"],FPDFAnnot_SetFlags:[["number","number"],"boolean"],FPDFAnnot_SetFocusableSubtypes:[["number","number","number"],"boolean"],FPDFAnnot_SetFontColor:[["number","number","number","number","number"],"boolean"],FPDFAnnot_SetFormFieldFlags:[["number","number","number"],"boolean"],FPDFAnnot_SetRect:[["number","number"],"boolean"],FPDFAnnot_SetStringValue:[["number","string","number"],"boolean"],FPDFAnnot_SetURI:[["number","number"],"boolean"],FPDFAnnot_UpdateObject:[["number","number"],"boolean"],FPDFAttachment_GetFile:[["number","number","number","number"],"boolean"],FPDFAttachment_GetName:[["number","number","number"],"number"],FPDFAttachment_GetStringValue:[["number","string","number","number"],"number"],FPDFAttachment_GetSubtype:[["number","number","number"],"number"],FPDFAttachment_GetValueType:[["number","string"],"number"],FPDFAttachment_HasKey:[["number","string"],"boolean"],FPDFAttachment_SetFile:[["number","number","number","number"],"boolean"],FPDFAttachment_SetStringValue:[["number","string","number"],"boolean"],FPDFAvail_Create:[["number","number"],"number"],FPDFAvail_Destroy:[["number"],null],FPDFAvail_GetDocument:[["number","string"],"number"],FPDFAvail_GetFirstPageNum:[["number"],"number"],FPDFAvail_IsDocAvail:[["number","number"],"number"],FPDFAvail_IsFormAvail:[["number","number"],"number"],FPDFAvail_IsLinearized:[["number"],"number"],FPDFAvail_IsPageAvail:[["number","number","number"],"number"],FPDFBitmap_Create:[["number","number","number"],"number"],FPDFBitmap_CreateEx:[["number","number","number","number","number"],"number"],FPDFBitmap_Destroy:[["number"],null],FPDFBitmap_FillRect:[["number","number","number","number","number","number"],"boolean"],FPDFBitmap_GetBuffer:[["number"],"number"],FPDFBitmap_GetFormat:[["number"],"number"],FPDFBitmap_GetHeight:[["number"],"number"],FPDFBitmap_GetStride:[["number"],"number"],FPDFBitmap_GetWidth:[["number"],"number"],FPDFBookmark_Find:[["number","number"],"number"],FPDFBookmark_GetAction:[["number"],"number"],FPDFBookmark_GetCount:[["number"],"number"],FPDFBookmark_GetDest:[["number","number"],"number"],FPDFBookmark_GetFirstChild:[["number","number"],"number"],FPDFBookmark_GetNextSibling:[["number","number"],"number"],FPDFBookmark_GetTitle:[["number","number","number"],"number"],FPDFCatalog_IsTagged:[["number"],"boolean"],FPDFCatalog_SetLanguage:[["number","string"],"boolean"],FPDFClipPath_CountPaths:[["number"],"number"],FPDFClipPath_CountPathSegments:[["number","number"],"number"],FPDFClipPath_GetPathSegment:[["number","number","number"],"number"],FPDFDest_GetDestPageIndex:[["number","number"],"number"],FPDFDest_GetLocationInPage:[["number","number","number","number","number","number","number"],"boolean"],FPDFDest_GetView:[["number","number","number"],"number"],FPDFDoc_AddAttachment:[["number","number"],"number"],FPDFDoc_CloseJavaScriptAction:[["number"],null],FPDFDoc_DeleteAttachment:[["number","number"],"boolean"],FPDFDOC_ExitFormFillEnvironment:[["number"],null],FPDFDoc_GetAttachment:[["number","number"],"number"],FPDFDoc_GetAttachmentCount:[["number"],"number"],FPDFDoc_GetJavaScriptAction:[["number","number"],"number"],FPDFDoc_GetJavaScriptActionCount:[["number"],"number"],FPDFDoc_GetPageMode:[["number"],"number"],FPDFDOC_InitFormFillEnvironment:[["number","number"],"number"],FPDFFont_Close:[["number"],null],FPDFFont_GetAscent:[["number","number","number"],"boolean"],FPDFFont_GetBaseFontName:[["number","number","number"],"number"],FPDFFont_GetDescent:[["number","number","number"],"boolean"],FPDFFont_GetFamilyName:[["number","number","number"],"number"],FPDFFont_GetFlags:[["number"],"number"],FPDFFont_GetFontData:[["number","number","number","number"],"boolean"],FPDFFont_GetGlyphPath:[["number","number","number"],"number"],FPDFFont_GetGlyphWidth:[["number","number","number","number"],"boolean"],FPDFFont_GetIsEmbedded:[["number"],"number"],FPDFFont_GetItalicAngle:[["number","number"],"boolean"],FPDFFont_GetWeight:[["number"],"number"],FPDFFormObj_CountObjects:[["number"],"number"],FPDFFormObj_GetObject:[["number","number"],"number"],FPDFFormObj_RemoveObject:[["number","number"],"boolean"],FPDFGlyphPath_CountGlyphSegments:[["number"],"number"],FPDFGlyphPath_GetGlyphPathSegment:[["number","number"],"number"],FPDFImageObj_GetBitmap:[["number"],"number"],FPDFImageObj_GetIccProfileDataDecoded:[["number","number","number","number","number"],"boolean"],FPDFImageObj_GetImageDataDecoded:[["number","number","number"],"number"],FPDFImageObj_GetImageDataRaw:[["number","number","number"],"number"],FPDFImageObj_GetImageFilter:[["number","number","number","number"],"number"],FPDFImageObj_GetImageFilterCount:[["number"],"number"],FPDFImageObj_GetImageMetadata:[["number","number","number"],"boolean"],FPDFImageObj_GetImagePixelSize:[["number","number","number"],"boolean"],FPDFImageObj_GetRenderedBitmap:[["number","number","number"],"number"],FPDFImageObj_LoadJpegFile:[["number","number","number","number"],"boolean"],FPDFImageObj_LoadJpegFileInline:[["number","number","number","number"],"boolean"],FPDFImageObj_SetBitmap:[["number","number","number","number"],"boolean"],FPDFImageObj_SetMatrix:[["number","number","number","number","number","number","number"],"boolean"],FPDFJavaScriptAction_GetName:[["number","number","number"],"number"],FPDFJavaScriptAction_GetScript:[["number","number","number"],"number"],FPDFLink_CloseWebLinks:[["number"],null],FPDFLink_CountQuadPoints:[["number"],"number"],FPDFLink_CountRects:[["number","number"],"number"],FPDFLink_CountWebLinks:[["number"],"number"],FPDFLink_Enumerate:[["number","number","number"],"boolean"],FPDFLink_GetAction:[["number"],"number"],FPDFLink_GetAnnot:[["number","number"],"number"],FPDFLink_GetAnnotRect:[["number","number"],"boolean"],FPDFLink_GetDest:[["number","number"],"number"],FPDFLink_GetLinkAtPoint:[["number","number","number"],"number"],FPDFLink_GetLinkZOrderAtPoint:[["number","number","number"],"number"],FPDFLink_GetQuadPoints:[["number","number","number"],"boolean"],FPDFLink_GetRect:[["number","number","number","number","number","number","number"],"boolean"],FPDFLink_GetTextRange:[["number","number","number","number"],"boolean"],FPDFLink_GetURL:[["number","number","number","number"],"number"],FPDFLink_LoadWebLinks:[["number"],"number"],FPDFPage_CloseAnnot:[["number"],null],FPDFPage_CountObjects:[["number"],"number"],FPDFPage_CreateAnnot:[["number","number"],"number"],FPDFPage_Delete:[["number","number"],null],FPDFPage_Flatten:[["number","number"],"number"],FPDFPage_FormFieldZOrderAtPoint:[["number","number","number","number"],"number"],FPDFPage_GenerateContent:[["number"],"boolean"],FPDFPage_GetAnnot:[["number","number"],"number"],FPDFPage_GetAnnotCount:[["number"],"number"],FPDFPage_GetAnnotIndex:[["number","number"],"number"],FPDFPage_GetArtBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetBleedBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetCropBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetDecodedThumbnailData:[["number","number","number"],"number"],FPDFPage_GetMediaBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetObject:[["number","number"],"number"],FPDFPage_GetRawThumbnailData:[["number","number","number"],"number"],FPDFPage_GetRotation:[["number"],"number"],FPDFPage_GetThumbnailAsBitmap:[["number"],"number"],FPDFPage_GetTrimBox:[["number","number","number","number","number"],"boolean"],FPDFPage_HasFormFieldAtPoint:[["number","number","number","number"],"number"],FPDFPage_HasTransparency:[["number"],"boolean"],FPDFPage_InsertClipPath:[["number","number"],null],FPDFPage_InsertObject:[["number","number"],null],FPDFPage_InsertObjectAtIndex:[["number","number","number"],"boolean"],FPDFPage_New:[["number","number","number","number"],"number"],FPDFPage_RemoveAnnot:[["number","number"],"boolean"],FPDFPage_RemoveObject:[["number","number"],"boolean"],FPDFPage_SetArtBox:[["number","number","number","number","number"],null],FPDFPage_SetBleedBox:[["number","number","number","number","number"],null],FPDFPage_SetCropBox:[["number","number","number","number","number"],null],FPDFPage_SetMediaBox:[["number","number","number","number","number"],null],FPDFPage_SetRotation:[["number","number"],null],FPDFPage_SetTrimBox:[["number","number","number","number","number"],null],FPDFPage_TransformAnnots:[["number","number","number","number","number","number","number"],null],FPDFPage_TransFormWithClip:[["number","number","number"],"boolean"],FPDFPageObj_AddMark:[["number","string"],"number"],FPDFPageObj_CountMarks:[["number"],"number"],FPDFPageObj_CreateNewPath:[["number","number"],"number"],FPDFPageObj_CreateNewRect:[["number","number","number","number"],"number"],FPDFPageObj_CreateTextObj:[["number","number","number"],"number"],FPDFPageObj_Destroy:[["number"],null],FPDFPageObj_GetBounds:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetClipPath:[["number"],"number"],FPDFPageObj_GetDashArray:[["number","number","number"],"boolean"],FPDFPageObj_GetDashCount:[["number"],"number"],FPDFPageObj_GetDashPhase:[["number","number"],"boolean"],FPDFPageObj_GetFillColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetIsActive:[["number","number"],"boolean"],FPDFPageObj_GetLineCap:[["number"],"number"],FPDFPageObj_GetLineJoin:[["number"],"number"],FPDFPageObj_GetMark:[["number","number"],"number"],FPDFPageObj_GetMarkedContentID:[["number"],"number"],FPDFPageObj_GetMatrix:[["number","number"],"boolean"],FPDFPageObj_GetRotatedBounds:[["number","number"],"boolean"],FPDFPageObj_GetStrokeColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetStrokeWidth:[["number","number"],"boolean"],FPDFPageObj_GetType:[["number"],"number"],FPDFPageObj_HasTransparency:[["number"],"boolean"],FPDFPageObj_NewImageObj:[["number"],"number"],FPDFPageObj_NewTextObj:[["number","string","number"],"number"],FPDFPageObj_RemoveMark:[["number","number"],"boolean"],FPDFPageObj_SetBlendMode:[["number","string"],null],FPDFPageObj_SetDashArray:[["number","number","number","number"],"boolean"],FPDFPageObj_SetDashPhase:[["number","number"],"boolean"],FPDFPageObj_SetFillColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_SetIsActive:[["number","boolean"],"boolean"],FPDFPageObj_SetLineCap:[["number","number"],"boolean"],FPDFPageObj_SetLineJoin:[["number","number"],"boolean"],FPDFPageObj_SetMatrix:[["number","number"],"boolean"],FPDFPageObj_SetStrokeColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_SetStrokeWidth:[["number","number"],"boolean"],FPDFPageObj_Transform:[["number","number","number","number","number","number","number"],null],FPDFPageObj_TransformClipPath:[["number","number","number","number","number","number","number"],null],FPDFPageObj_TransformF:[["number","number"],"boolean"],FPDFPageObjMark_CountParams:[["number"],"number"],FPDFPageObjMark_GetName:[["number","number","number","number"],"boolean"],FPDFPageObjMark_GetParamBlobValue:[["number","string","number","number","number"],"boolean"],FPDFPageObjMark_GetParamIntValue:[["number","string","number"],"boolean"],FPDFPageObjMark_GetParamKey:[["number","number","number","number","number"],"boolean"],FPDFPageObjMark_GetParamStringValue:[["number","string","number","number","number"],"boolean"],FPDFPageObjMark_GetParamValueType:[["number","string"],"number"],FPDFPageObjMark_RemoveParam:[["number","number","string"],"boolean"],FPDFPageObjMark_SetBlobParam:[["number","number","number","string","number","number"],"boolean"],FPDFPageObjMark_SetIntParam:[["number","number","number","string","number"],"boolean"],FPDFPageObjMark_SetStringParam:[["number","number","number","string","string"],"boolean"],FPDFPath_BezierTo:[["number","number","number","number","number","number","number"],"boolean"],FPDFPath_Close:[["number"],"boolean"],FPDFPath_CountSegments:[["number"],"number"],FPDFPath_GetDrawMode:[["number","number","number"],"boolean"],FPDFPath_GetPathSegment:[["number","number"],"number"],FPDFPath_LineTo:[["number","number","number"],"boolean"],FPDFPath_MoveTo:[["number","number","number"],"boolean"],FPDFPath_SetDrawMode:[["number","number","boolean"],"boolean"],FPDFPathSegment_GetClose:[["number"],"boolean"],FPDFPathSegment_GetPoint:[["number","number","number"],"boolean"],FPDFPathSegment_GetType:[["number"],"number"],FPDFSignatureObj_GetByteRange:[["number","number","number"],"number"],FPDFSignatureObj_GetContents:[["number","number","number"],"number"],FPDFSignatureObj_GetDocMDPPermission:[["number"],"number"],FPDFSignatureObj_GetReason:[["number","number","number"],"number"],FPDFSignatureObj_GetSubFilter:[["number","number","number"],"number"],FPDFSignatureObj_GetTime:[["number","number","number"],"number"],FPDFText_ClosePage:[["number"],null],FPDFText_CountChars:[["number"],"number"],FPDFText_CountRects:[["number","number","number"],"number"],FPDFText_FindClose:[["number"],null],FPDFText_FindNext:[["number"],"boolean"],FPDFText_FindPrev:[["number"],"boolean"],FPDFText_FindStart:[["number","number","number","number"],"number"],FPDFText_GetBoundedText:[["number","number","number","number","number","number","number"],"number"],FPDFText_GetCharAngle:[["number","number"],"number"],FPDFText_GetCharBox:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetCharIndexAtPos:[["number","number","number","number","number"],"number"],FPDFText_GetCharIndexFromTextIndex:[["number","number"],"number"],FPDFText_GetCharOrigin:[["number","number","number","number"],"boolean"],FPDFText_GetFillColor:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetFontInfo:[["number","number","number","number","number"],"number"],FPDFText_GetFontSize:[["number","number"],"number"],FPDFText_GetFontWeight:[["number","number"],"number"],FPDFText_GetLooseCharBox:[["number","number","number"],"boolean"],FPDFText_GetMatrix:[["number","number","number"],"boolean"],FPDFText_GetRect:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetSchCount:[["number"],"number"],FPDFText_GetSchResultIndex:[["number"],"number"],FPDFText_GetStrokeColor:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetText:[["number","number","number","number"],"number"],FPDFText_GetTextIndexFromCharIndex:[["number","number"],"number"],FPDFText_GetTextObject:[["number","number"],"number"],FPDFText_GetUnicode:[["number","number"],"number"],FPDFText_HasUnicodeMapError:[["number","number"],"number"],FPDFText_IsGenerated:[["number","number"],"number"],FPDFText_IsHyphen:[["number","number"],"number"],FPDFText_LoadCidType2Font:[["number","number","number","string","number","number"],"number"],FPDFText_LoadFont:[["number","number","number","number","boolean"],"number"],FPDFText_LoadPage:[["number"],"number"],FPDFText_LoadStandardFont:[["number","string"],"number"],FPDFText_SetCharcodes:[["number","number","number"],"boolean"],FPDFText_SetText:[["number","number"],"boolean"],FPDFTextObj_GetFont:[["number"],"number"],FPDFTextObj_GetFontSize:[["number","number"],"boolean"],FPDFTextObj_GetRenderedBitmap:[["number","number","number","number"],"number"],FPDFTextObj_GetText:[["number","number","number","number"],"number"],FPDFTextObj_GetTextRenderMode:[["number"],"number"],FPDFTextObj_SetTextRenderMode:[["number","number"],"boolean"],PDFiumExt_CloseFileWriter:[["number"],null],PDFiumExt_CloseFormFillInfo:[["number"],null],PDFiumExt_ExitFormFillEnvironment:[["number"],null],PDFiumExt_GetFileWriterData:[["number","number","number"],"number"],PDFiumExt_GetFileWriterSize:[["number"],"number"],PDFiumExt_Init:[[],null],PDFiumExt_InitFormFillEnvironment:[["number","number"],"number"],PDFiumExt_OpenFileWriter:[[],"number"],PDFiumExt_OpenFormFillInfo:[[],"number"],PDFiumExt_SaveAsCopy:[["number","number"],"number"]};async function a(e){const t={pdfium:e};for(const n in o){const r=n,a=o[r][0],i=o[r][1];t[r]=e.cwrap(n,i,a)}return t}async function i(e){const t=await r(e);return a(t)}n(1701),n(3110),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698),n(8335);var s=n(1502),u=n(2961),m=n(1726);function F(e,t,n,r=100){let o=e.wasmExports.malloc(r);for(let s=0;s<r;s++)e.HEAP8[o+s]=0;const a=t(o,r);let i;if(a>r){e.wasmExports.free(o),o=e.wasmExports.malloc(a);for(let t=0;t<a;t++)e.HEAP8[o+t]=0;t(o,a),i=n(o)}else i=n(o);return e.wasmExports.free(o),i}function l(e,t){const n=t(0,0),r=e.wasmExports.malloc(n);t(r,n);const o=new ArrayBuffer(n),a=new DataView(o);for(let i=0;i<n;i++)a.setInt8(i,e.getValue(r+i,"i8"));return e.wasmExports.free(r),o}const d=new Set(["Title","Author","Subject","Keywords","Producer","Creator","CreationDate","ModDate","Trapped"]);function _(e){if(!e||e.length>127)return!1;if(d.has(e))return!1;if("/"===e[0])return!1;for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n<32||n>126)return!1}return!0}function c(e,t,n,r){const o=t.origin.x,a=t.origin.y,i=o+t.size.width,u=a+t.size.height,m=n.width,F=n.height,l=Math.hypot(e.a,e.b),d=Math.hypot(e.c,e.d),_=1===(1&r),c=_?Math.max(1,Math.round(F*l)):Math.max(1,Math.round(m*l)),P=_?Math.max(1,Math.round(m*d)):Math.max(1,Math.round(F*d));let g,h;switch(r){case s.pL.Degree0:g=-Math.round(o*l),h=-Math.round(a*d);break;case s.pL.Degree90:g=Math.round((u-F)*l),h=-Math.round(o*d);break;case s.pL.Degree180:g=Math.round((i-m)*l),h=Math.round((u-F)*d);break;case s.pL.Degree270:g=-Math.round(a*l),h=Math.round((i-m)*d);break;default:g=-Math.round(o*l),h=-Math.round(a*d);break}return{startX:g,startY:h,formsWidth:c,formsHeight:P,scaleX:l,scaleY:d}}const P=e=>e,g={pageTtl:5e3,maxPagesPerDocument:10};class h{constructor(e,t,n={}){this.pdfium=e,this.memoryManager=t,this.docs=new Map,this.config={...g,...n}}setDocument(e,t,n){let r=this.docs.get(e);r||(r=new D(t,n,this.pdfium,this.memoryManager,this.config),this.docs.set(e,r))}getContext(e){return this.docs.get(e)}closeDocument(e){const t=this.docs.get(e);return!!t&&(t.dispose(),this.docs.delete(e),!0)}closeAllDocuments(){for(const e of this.docs.values())e.dispose();this.docs.clear()}updateConfig(e){Object.assign(this.config,e);for(const t of this.docs.values())t.updateConfig(this.config)}getCacheStats(){const e={};let t=0;for(const[n,r]of this.docs.entries()){const o=r.getCacheSize();e[n]=o,t+=o}return{documents:this.docs.size,totalPages:t,pagesByDocument:e}}}class D{constructor(e,t,n,r,o){this.filePtr=e,this.docPtr=t,this.memoryManager=r,this.pageCache=new b(n,t,o)}acquirePage(e){return this.pageCache.acquire(e)}borrowPage(e,t){return this.pageCache.borrowPage(e,t)}updateConfig(e){this.pageCache.updateConfig(e)}getCacheSize(){return this.pageCache.size()}dispose(){this.pageCache.forceReleaseAll(),this.pageCache.pdf.FPDF_CloseDocument(this.docPtr),this.memoryManager.free(P(this.filePtr))}}class b{constructor(e,t,n){this.pdf=e,this.docPtr=t,this.cache=new Map,this.accessOrder=[],this.config=n}acquire(e){let t=this.cache.get(e);if(!t){this.evictIfNeeded();const n=this.pdf.FPDF_LoadPage(this.docPtr,e);t=new f(this.pdf,this.docPtr,e,n,this.config.pageTtl,()=>{this.cache.delete(e),this.removeFromAccessOrder(e)}),this.cache.set(e,t)}return this.updateAccessOrder(e),t.clearExpiryTimer(),t.bumpRefCount(),t}borrowPage(e,t){const n=this.cache.has(e),r=this.acquire(e);try{return t(r)}finally{n?r.release():r.disposeImmediate()}}forceReleaseAll(){for(const e of this.cache.values())e.disposeImmediate();this.cache.clear(),this.accessOrder.length=0}updateConfig(e){this.config=e;for(const t of this.cache.values())t.updateTtl(e.pageTtl);this.evictIfNeeded()}size(){return this.cache.size}evictIfNeeded(){while(this.cache.size>=this.config.maxPagesPerDocument){const e=this.accessOrder[0];if(void 0===e)break;{const t=this.cache.get(e);if(t){if(0!==t.getRefCount())break;t.disposeImmediate()}else this.removeFromAccessOrder(e)}}}updateAccessOrder(e){this.removeFromAccessOrder(e),this.accessOrder.push(e)}removeFromAccessOrder(e){const t=this.accessOrder.indexOf(e);t>-1&&this.accessOrder.splice(t,1)}}class f{constructor(e,t,n,r,o,a){this.pdf=e,this.docPtr=t,this.pageIdx=n,this.pagePtr=r,this.onFinalDispose=a,this.refCount=0,this.disposed=!1,this.ttl=o}bumpRefCount(){if(this.disposed)throw new Error("Context already disposed");this.refCount++}getRefCount(){return this.refCount}clearExpiryTimer(){this.expiryTimer&&(clearTimeout(this.expiryTimer),this.expiryTimer=void 0)}updateTtl(e){this.ttl=e,this.expiryTimer&&0===this.refCount&&(this.clearExpiryTimer(),this.expiryTimer=setTimeout(()=>this.disposeImmediate(),this.ttl))}release(){this.disposed||(this.refCount--,0===this.refCount&&(this.expiryTimer=setTimeout(()=>this.disposeImmediate(),this.ttl)))}disposeImmediate(){this.disposed||(this.disposed=!0,this.clearExpiryTimer(),void 0!==this.textPagePtr&&this.pdf.FPDFText_ClosePage(this.textPagePtr),void 0!==this.formHandle&&(this.pdf.FORM_OnBeforeClosePage(this.pagePtr,this.formHandle),this.pdf.PDFiumExt_ExitFormFillEnvironment(this.formHandle)),void 0!==this.formInfoPtr&&this.pdf.PDFiumExt_CloseFormFillInfo(this.formInfoPtr),this.pdf.FPDF_ClosePage(this.pagePtr),this.onFinalDispose())}getTextPage(){return this.ensureAlive(),void 0===this.textPagePtr&&(this.textPagePtr=this.pdf.FPDFText_LoadPage(this.pagePtr)),this.textPagePtr}getFormHandle(){return this.ensureAlive(),void 0===this.formHandle&&(this.formInfoPtr=this.pdf.PDFiumExt_OpenFormFillInfo(),this.formHandle=this.pdf.PDFiumExt_InitFormFillEnvironment(this.docPtr,this.formInfoPtr),this.pdf.FORM_OnAfterLoadPage(this.pagePtr,this.formHandle)),this.formHandle}withAnnotation(e,t){this.ensureAlive();const n=this.pdf.FPDFPage_GetAnnot(this.pagePtr,e);try{return t(n)}finally{this.pdf.FPDFPage_CloseAnnot(n)}}ensureAlive(){if(this.disposed)throw new Error("PageContext already disposed")}}const p={MAX_TOTAL_MEMORY:2147483648},A={MEMORY:p},E="PDFiumEngine",y="MemoryManager";class M{constructor(e,t){this.pdfiumModule=e,this.logger=t,this.allocations=new Map,this.totalAllocated=0}malloc(e){if(this.totalAllocated+e>A.MEMORY.MAX_TOTAL_MEMORY)throw new Error(`Total memory usage would exceed limit: ${this.totalAllocated+e} > ${A.MEMORY.MAX_TOTAL_MEMORY}`);const t=this.pdfiumModule.pdfium.wasmExports.malloc(e);if(!t)throw new Error(`Failed to allocate ${e} bytes`);const n={ptr:P(t),size:e,timestamp:Date.now(),stack:this.logger.isEnabled("debug")?(new Error).stack:void 0};return this.allocations.set(t,n),this.totalAllocated+=e,P(t)}free(e){const t=this.allocations.get(e);t?(this.totalAllocated-=t.size,this.allocations.delete(e)):this.logger.warn(E,y,`Freeing untracked pointer: ${e}`),this.pdfiumModule.pdfium.wasmExports.free(e)}getStats(){return{totalAllocated:this.totalAllocated,allocationCount:this.allocations.size,allocations:this.logger.isEnabled("debug")?Array.from(this.allocations.values()):[]}}checkLeaks(){if(this.allocations.size>0){this.logger.warn(E,y,`Potential memory leak: ${this.allocations.size} unfreed allocations`);for(const[e,t]of this.allocations)this.logger.warn(E,y,`  - ${e}: ${t.size} bytes`,t.stack)}}}const G=36,C=0,S=4,T=8,x=12,v=16,O=20,w=24,k=28,R=32,I="pdfium",j="font-fallback";class B{constructor(e,t=new s.Pv){this.fontHandles=new Map,this.fontCache=new Map,this.nextHandleId=1,this.module=null,this.enabled=!1,this.structPtr=0,this.releaseFnPtr=0,this.enumFontsFnPtr=0,this.mapFontFnPtr=0,this.getFontFnPtr=0,this.getFontDataFnPtr=0,this.getFaceNameFnPtr=0,this.getFontCharsetFnPtr=0,this.deleteFontFnPtr=0,this.fontConfig=e,this.logger=t}initialize(e){if(this.enabled)return void this.logger.warn(I,j,"Font fallback already initialized");this.module=e;const t=e.pdfium;if("function"===typeof t.addFunction)try{if(this.structPtr=t.wasmExports.malloc(G),!this.structPtr)throw new Error("Failed to allocate FPDF_SYSFONTINFO struct");for(let e=0;e<G;e++)t.setValue(this.structPtr+e,0,"i8");this.releaseFnPtr=t.addFunction(e=>{},"vi"),this.enumFontsFnPtr=t.addFunction((e,t)=>{},"vii"),this.mapFontFnPtr=t.addFunction((e,n,r,o,a,i,s)=>{const u=i?t.UTF8ToString(i):"",m=this.mapFont(n,r,o,a,u);return s&&t.setValue(s,0,"i32"),m},"iiiiiiii"),this.getFontFnPtr=t.addFunction((e,n)=>{const r=n?t.UTF8ToString(n):"";return this.mapFont(400,0,0,0,r)},"iii"),this.getFontDataFnPtr=t.addFunction((e,t,n,r,o)=>this.getFontData(t,n,r,o),"iiiiii"),this.getFaceNameFnPtr=t.addFunction((e,t,n,r)=>0,"iiiii"),this.getFontCharsetFnPtr=t.addFunction((e,t)=>{const n=this.fontHandles.get(t);return(null==n?void 0:n.charset)??0},"iii"),this.deleteFontFnPtr=t.addFunction((e,t)=>{this.deleteFont(t)},"vii"),t.setValue(this.structPtr+C,1,"i32"),t.setValue(this.structPtr+S,this.releaseFnPtr,"i32"),t.setValue(this.structPtr+T,this.enumFontsFnPtr,"i32"),t.setValue(this.structPtr+x,this.mapFontFnPtr,"i32"),t.setValue(this.structPtr+v,this.getFontFnPtr,"i32"),t.setValue(this.structPtr+O,this.getFontDataFnPtr,"i32"),t.setValue(this.structPtr+w,this.getFaceNameFnPtr,"i32"),t.setValue(this.structPtr+k,this.getFontCharsetFnPtr,"i32"),t.setValue(this.structPtr+R,this.deleteFontFnPtr,"i32"),e.FPDF_SetSystemFontInfo(this.structPtr),this.enabled=!0,this.logger.info(I,j,"Font fallback system initialized (pure TypeScript)",Object.keys(this.fontConfig.fonts))}catch(n){throw this.logger.error(I,j,"Failed to initialize font fallback",n),this.cleanup(),n}else this.logger.error(I,j,"addFunction not available. Make sure WASM is compiled with -sALLOW_TABLE_GROWTH")}disable(){this.enabled&&this.module&&(this.module.FPDF_SetSystemFontInfo(0),this.cleanup(),this.enabled=!1,this.logger.debug(I,j,"Font fallback system disabled"))}cleanup(){if(!this.module)return;const e=this.module.pdfium;this.structPtr&&(e.wasmExports.free(this.structPtr),this.structPtr=0);const t=t=>{if(t&&"function"===typeof e.removeFunction)try{e.removeFunction(t)}catch{}};t(this.releaseFnPtr),t(this.enumFontsFnPtr),t(this.mapFontFnPtr),t(this.getFontFnPtr),t(this.getFontDataFnPtr),t(this.getFaceNameFnPtr),t(this.getFontCharsetFnPtr),t(this.deleteFontFnPtr),this.releaseFnPtr=0,this.enumFontsFnPtr=0,this.mapFontFnPtr=0,this.getFontFnPtr=0,this.getFontDataFnPtr=0,this.getFaceNameFnPtr=0,this.getFontCharsetFnPtr=0,this.deleteFontFnPtr=0}isEnabled(){return this.enabled}getStats(){return{handleCount:this.fontHandles.size,cacheSize:this.fontCache.size,cachedUrls:Array.from(this.fontCache.keys())}}async preloadFonts(e){const t=e.map(e=>this.getFontUrlForCharset(e)).filter(e=>null!==e),n=[...new Set(t)];await Promise.all(n.map(async e=>{if(!this.fontCache.has(e))try{const t=await this.fetchFontAsync(e);t&&(this.fontCache.set(e,t),this.logger.debug(I,j,`Pre-loaded font: ${e}`))}catch(t){this.logger.warn(I,j,`Failed to pre-load font: ${e}`,t)}}))}mapFont(e,t,n,r,o){const a=0!==t;this.logger.debug(I,j,"MapFont called",{weight:e,italic:a,charset:n,pitchFamily:r,face:o});const i=this.findBestFontMatch(n,e,a);if(!i)return this.logger.debug(I,j,`No font configured for charset ${n}`),0;const s={id:this.nextHandleId++,charset:n,weight:e,italic:a,url:i.url,data:null};return this.fontHandles.set(s.id,s),this.logger.debug(I,j,`Created font handle ${s.id} for ${i.url} (requested: weight=${e}, italic=${a}, matched: weight=${i.matchedWeight}, italic=${i.matchedItalic})`),s.id}getFontData(e,t,n,r){const o=this.fontHandles.get(e);if(!o)return this.logger.warn(I,j,`Unknown font handle: ${e}`),0;if(o.data||(this.fontCache.has(o.url)?o.data=this.fontCache.get(o.url):(o.data=this.fetchFontSync(o.url),o.data&&this.fontCache.set(o.url,o.data))),!o.data)return this.logger.warn(I,j,`Failed to load font: ${o.url}`),0;const a=o.data;if(0!==t)return this.logger.debug(I,j,`Table ${t} requested - returning 0 to request whole file`),0;if(0===n||r<a.length)return a.length;if(this.module){const t=this.module.pdfium.HEAPU8;t.set(a,n),this.logger.debug(I,j,`Copied ${a.length} bytes to buffer for handle ${e}`)}return a.length}deleteFont(e){const t=this.fontHandles.get(e);t&&(this.logger.debug(I,j,`Deleting font handle ${e}`),this.fontHandles.delete(e))}findBestFontMatch(e,t,n){const{fonts:r,defaultFont:o,baseUrl:a}=this.fontConfig,i=r[e]??o;if(!i)return null;const s=this.normalizeToVariants(i);if(0===s.length)return null;const u=this.selectBestVariant(s,t,n);let m=u.url;return!a||m.startsWith("http://")||m.startsWith("https://")||m.startsWith("/")||(m=`${a}/${m}`),{url:m,matchedWeight:u.weight??400,matchedItalic:u.italic??!1}}normalizeToVariants(e){return"string"===typeof e?[{url:e,weight:400,italic:!1}]:Array.isArray(e)?e.map(e=>({url:e.url,weight:e.weight??400,italic:e.italic??!1})):[{url:e.url,weight:e.weight??400,italic:e.italic??!1}]}selectBestVariant(e,t,n){if(1===e.length)return e[0];const r=e.filter(e=>(e.italic??!1)===n),o=r.length>0?r:e;let a=o[0],i=Math.abs((a.weight??400)-t);for(const s of o){const e=s.weight??400,n=Math.abs(e-t);if(n<i)a=s,i=n;else if(n===i){const n=a.weight??400;t>=500?e>n&&(a=s):e<n&&(a=s)}}return a}getFontUrlForCharset(e){const t=this.findBestFontMatch(e,400,!1);return(null==t?void 0:t.url)??null}fetchFontSync(e){if(this.logger.debug(I,j,`Fetching font synchronously: ${e}`),this.fontConfig.fontLoader)try{const t=this.fontConfig.fontLoader(e);return t?this.logger.info(I,j,`Loaded font via custom loader: ${e} (${t.length} bytes)`):this.logger.warn(I,j,`Custom font loader returned null for: ${e}`),t}catch(t){return this.logger.error(I,j,`Error in custom font loader: ${e}`,t),null}try{const t=new XMLHttpRequest;if(t.open("GET",e,!1),t.responseType="arraybuffer",t.send(),200===t.status){const n=new Uint8Array(t.response);return this.logger.info(I,j,`Loaded font: ${e} (${n.length} bytes)`),n}return this.logger.error(I,j,`Failed to load font: ${e} (HTTP ${t.status})`),null}catch(t){return this.logger.error(I,j,`Error fetching font: ${e}`,t),null}}async fetchFontAsync(e){if(this.fontConfig.fontLoader)try{return this.fontConfig.fontLoader(e)}catch{return null}try{const t=await fetch(e);if(t.ok){const e=await t.arrayBuffer();return new Uint8Array(e)}return null}catch{return null}}}const L="PDFiumEngine",N="Engine";class V{constructor(e,t={}){this.pdfiumModule=e,this.memoryLeakCheckInterval=null,this.fontFallbackManager=null;const{logger:n=new s.Pv,fontFallback:r}=t;this.logger=n,this.memoryManager=new M(this.pdfiumModule,this.logger),this.cache=new h(this.pdfiumModule,this.memoryManager),this.logger.isEnabled("debug")&&(this.memoryLeakCheckInterval=setInterval(()=>{this.memoryManager.checkLeaks()},1e4)),this.logger.debug(L,N,"initialize"),this.logger.perf(L,N,"Initialize","Begin","General"),this.pdfiumModule.PDFiumExt_Init(),this.logger.perf(L,N,"Initialize","End","General"),r&&(this.fontFallbackManager=new B(r,this.logger),this.fontFallbackManager.initialize(this.pdfiumModule),this.logger.info(L,N,"Font fallback system enabled"))}destroy(){return this.logger.debug(L,N,"destroy"),this.logger.perf(L,N,"Destroy","Begin","General"),this.fontFallbackManager&&(this.fontFallbackManager.disable(),this.fontFallbackManager=null),this.pdfiumModule.FPDF_DestroyLibrary(),this.memoryLeakCheckInterval&&(clearInterval(this.memoryLeakCheckInterval),this.memoryLeakCheckInterval=null),this.logger.perf(L,N,"Destroy","End","General"),s.m.resolve(!0)}getFontFallbackManager(){return this.fontFallbackManager}withWString(e,t){const n=2*(e.length+1),r=this.memoryManager.malloc(n);try{return this.pdfiumModule.pdfium.stringToUTF16(e,r,n),t(r)}finally{this.memoryManager.free(r)}}withFloatArray(e,t){const n=e??[],r=4*n.length,o=r?this.memoryManager.malloc(r):P(0);try{if(r)for(let e=0;e<n.length;e++)this.pdfiumModule.pdfium.setValue(o+4*e,n[e],"float");return t(o,n.length)}finally{r&&this.memoryManager.free(o)}}openDocumentBuffer(e,t){this.logger.debug(L,N,"openDocumentBuffer",e,t),this.logger.perf(L,N,"OpenDocumentBuffer","Begin",e.id);const n=new Uint8Array(e.content),r=n.length,o=this.memoryManager.malloc(r);this.pdfiumModule.pdfium.HEAPU8.set(n,o);const a=this.pdfiumModule.FPDF_LoadMemDocument(o,r,(null==t?void 0:t.password)??"");if(!a){const t=this.pdfiumModule.FPDF_GetLastError();return this.logger.error(L,N,`FPDF_LoadMemDocument failed with ${t}`),this.memoryManager.free(o),this.logger.perf(L,N,"OpenDocumentBuffer","End",e.id),s.m.reject({code:t,message:"FPDF_LoadMemDocument failed"})}const i=this.pdfiumModule.FPDF_GetPageCount(a),u=[],m=this.memoryManager.malloc(8);for(let l=0;l<i;l++){const t=this.pdfiumModule.FPDF_GetPageSizeByIndexF(a,l,m);if(!t){const t=this.pdfiumModule.FPDF_GetLastError();return this.logger.error(L,N,`FPDF_GetPageSizeByIndexF failed with ${t}`),this.memoryManager.free(m),this.pdfiumModule.FPDF_CloseDocument(a),this.memoryManager.free(o),this.logger.perf(L,N,"OpenDocumentBuffer","End",e.id),s.m.reject({code:t,message:"FPDF_GetPageSizeByIndexF failed"})}const n=this.pdfiumModule.EPDF_GetPageRotationByIndex(a,l),r={index:l,size:{width:this.pdfiumModule.pdfium.getValue(m,"float"),height:this.pdfiumModule.pdfium.getValue(m+4,"float")},rotation:n};u.push(r)}this.memoryManager.free(m);const F={id:e.id,pageCount:i,pages:u};return this.cache.setDocument(e.id,o,a),this.logger.perf(L,N,"OpenDocumentBuffer","End",e.id),s.m.resolve(F)}getMetadata(e){this.logger.debug(L,N,"getMetadata",e),this.logger.perf(L,N,"GetMetadata","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(L,N,"GetMetadata","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const n=this.readMetaText(t.docPtr,"CreationDate"),r=this.readMetaText(t.docPtr,"ModDate"),o={title:this.readMetaText(t.docPtr,"Title"),author:this.readMetaText(t.docPtr,"Author"),subject:this.readMetaText(t.docPtr,"Subject"),keywords:this.readMetaText(t.docPtr,"Keywords"),producer:this.readMetaText(t.docPtr,"Producer"),creator:this.readMetaText(t.docPtr,"Creator"),creationDate:n?(0,s.oj)(n)??null:null,modificationDate:r?(0,s.oj)(r)??null:null,trapped:this.getMetaTrapped(t.docPtr),custom:this.readAllMeta(t.docPtr,!0)};return this.logger.perf(L,N,"GetMetadata","End",e.id),s.m.resolve(o)}setMetadata(e,t){this.logger.debug(L,N,"setMetadata",e,t),this.logger.perf(L,N,"SetMetadata","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(L,N,"SetMetadata","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const r=[["title","Title"],["author","Author"],["subject","Subject"],["keywords","Keywords"],["producer","Producer"],["creator","Creator"]];let o=!0;for(const[i,s]of r){const e=t[i];if(void 0===e)continue;const r=null===e?null:e;this.setMetaText(n.docPtr,s,r)||(o=!1)}const a=(e,r)=>{const a=t[e];if(void 0===a)return;if(null===a)return void(this.setMetaText(n.docPtr,r,null)||(o=!1));const i=a,u=(0,s._B)(i);this.setMetaText(n.docPtr,r,u)||(o=!1)};if(a("creationDate","CreationDate"),a("modificationDate","ModDate"),void 0!==t.trapped&&(this.setMetaTrapped(n.docPtr,t.trapped??null)||(o=!1)),void 0!==t.custom)for(const[i,s]of Object.entries(t.custom))_(i)?this.setMetaText(n.docPtr,i,s??null)||(o=!1):this.logger.warn(L,N,"Invalid custom metadata key skipped",i);return this.logger.perf(L,N,"SetMetadata","End",e.id),o?s.m.resolve(!0):s.m.reject({code:s.iW.Unknown,message:"one or more metadata fields could not be written"})}getDocPermissions(e){this.logger.debug(L,N,"getDocPermissions",e),this.logger.perf(L,N,"getDocPermissions","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(L,N,"getDocPermissions","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const n=this.pdfiumModule.FPDF_GetDocPermissions(t.docPtr);return s.m.resolve(n)}getDocUserPermissions(e){this.logger.debug(L,N,"getDocUserPermissions",e),this.logger.perf(L,N,"getDocUserPermissions","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(L,N,"getDocUserPermissions","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const n=this.pdfiumModule.FPDF_GetDocUserPermissions(t.docPtr);return s.m.resolve(n)}getSignatures(e){this.logger.debug(L,N,"getSignatures",e),this.logger.perf(L,N,"GetSignatures","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(L,N,"GetSignatures","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const n=[],r=this.pdfiumModule.FPDF_GetSignatureCount(t.docPtr);for(let o=0;o<r;o++){const e=this.pdfiumModule.FPDF_GetSignatureObject(t.docPtr,o),r=l(this.pdfiumModule.pdfium,(t,n)=>this.pdfiumModule.FPDFSignatureObj_GetContents(e,t,n)),a=l(this.pdfiumModule.pdfium,(t,n)=>4*this.pdfiumModule.FPDFSignatureObj_GetByteRange(e,t,n)),i=l(this.pdfiumModule.pdfium,(t,n)=>this.pdfiumModule.FPDFSignatureObj_GetSubFilter(e,t,n)),s=F(this.pdfiumModule.pdfium,(t,n)=>this.pdfiumModule.FPDFSignatureObj_GetReason(e,t,n),this.pdfiumModule.pdfium.UTF16ToString),u=F(this.pdfiumModule.pdfium,(t,n)=>this.pdfiumModule.FPDFSignatureObj_GetTime(e,t,n),this.pdfiumModule.pdfium.UTF8ToString),m=this.pdfiumModule.FPDFSignatureObj_GetDocMDPPermission(e);n.push({contents:r,byteRange:a,subFilter:i,reason:s,time:u,docMDP:m})}return this.logger.perf(L,N,"GetSignatures","End",e.id),s.m.resolve(n)}getBookmarks(e){this.logger.debug(L,N,"getBookmarks",e),this.logger.perf(L,N,"GetBookmarks","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(L,N,"getBookmarks","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const n=this.readPdfBookmarks(t.docPtr,0);return this.logger.perf(L,N,"GetBookmarks","End",e.id),s.m.resolve({bookmarks:n})}setBookmarks(e,t){this.logger.debug(L,N,"setBookmarks",e,t),this.logger.perf(L,N,"SetBookmarks","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(L,N,"SetBookmarks","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});if(!this.pdfiumModule.EPDFBookmark_Clear(n.docPtr))return this.logger.perf(L,N,"SetBookmarks","End",e.id),s.m.reject({code:s.iW.Unknown,message:"failed to clear existing bookmarks"});const r=(e,t)=>{var o;for(const a of t){const t=this.withWString(a.title??"",t=>this.pdfiumModule.EPDFBookmark_AppendChild(n.docPtr,e,t));if(!t)return!1;if(a.target){const e=this.applyBookmarkTarget(n.docPtr,t,a.target);if(!e)return!1}if(null==(o=a.children)?void 0:o.length){const e=r(t,a.children);if(!e)return!1}}return!0},o=r(0,t);return this.logger.perf(L,N,"SetBookmarks","End",e.id),o?s.m.resolve(!0):s.m.reject({code:s.iW.Unknown,message:"failed to build bookmark tree"})}deleteBookmarks(e){this.logger.debug(L,N,"deleteBookmarks",e),this.logger.perf(L,N,"DeleteBookmarks","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(L,N,"DeleteBookmarks","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const n=this.pdfiumModule.EPDFBookmark_Clear(t.docPtr);return this.logger.perf(L,N,"DeleteBookmarks","End",e.id),n?s.m.resolve(!0):s.m.reject({code:s.iW.Unknown,message:"failed to clear bookmarks"})}renderPageRaw(e,t,n){this.logger.debug(L,N,"renderPage",e,t,n),this.logger.perf(L,N,"RenderPage","Begin",`${e.id}-${t.index}`);const r={origin:{x:0,y:0},size:t.size},o=this.renderRectEncoded(e,t,r,n);return this.logger.perf(L,N,"RenderPage","End",`${e.id}-${t.index}`),o}renderPageRect(e,t,n,r){this.logger.debug(L,N,"renderPageRect",e,t,n,r),this.logger.perf(L,N,"RenderPageRect","Begin",`${e.id}-${t.index}`);const o=this.renderRectEncoded(e,t,n,r);return this.logger.perf(L,N,"RenderPageRect","End",`${e.id}-${t.index}`),o}getPageAnnotations(e,t){this.logger.debug(L,N,"getPageAnnotations",e,t),this.logger.perf(L,N,"GetPageAnnotations","Begin",`${e.id}-${t.index}`);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(L,N,"GetPageAnnotations","End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const r=this.readPageAnnotations(n,t);return this.logger.perf(L,N,"GetPageAnnotations","End",`${e.id}-${t.index}`),this.logger.debug(L,N,"GetPageAnnotations",`${e.id}-${t.index}`,r),s.m.resolve(r)}createPageAnnotation(e,t,n,r){this.logger.debug(L,N,"createPageAnnotation",e,t,n),this.logger.perf(L,N,"CreatePageAnnotation","Begin",`${e.id}-${t.index}`);const o=this.cache.getContext(e.id);if(!o)return this.logger.perf(L,N,"CreatePageAnnotation","End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const a=o.acquirePage(t.index),i=this.pdfiumModule.EPDFPage_CreateAnnot(a.pagePtr,n.type);if(!i)return this.logger.perf(L,N,"CreatePageAnnotation","End",`${e.id}-${t.index}`),a.release(),s.m.reject({code:s.iW.CantCreateAnnot,message:"can not create annotation with specified type"});if((0,s._w)(n.id)||(n.id=(0,s.QT)()),!this.setAnnotString(i,"NM",n.id))return this.pdfiumModule.FPDFPage_CloseAnnot(i),a.release(),s.m.reject({code:s.iW.CantSetAnnotString,message:"can not set the name of the annotation"});if(!this.setPageAnnoRect(t,i,n.rect))return this.pdfiumModule.FPDFPage_CloseAnnot(i),a.release(),this.logger.perf(L,N,"CreatePageAnnotation","End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.CantSetAnnotRect,message:"can not set the rect of the annotation"});let u=!1;switch(n.type){case s.C7.INK:u=this.addInkStroke(t,a.pagePtr,i,n);break;case s.C7.STAMP:u=this.addStampContent(o.docPtr,t,a.pagePtr,i,n,null==r?void 0:r.imageData);break;case s.C7.TEXT:u=this.addTextContent(t,a.pagePtr,i,n);break;case s.C7.FREETEXT:u=this.addFreeTextContent(t,a.pagePtr,i,n);break;case s.C7.LINE:u=this.addLineContent(t,a.pagePtr,i,n);break;case s.C7.POLYLINE:case s.C7.POLYGON:u=this.addPolyContent(t,a.pagePtr,i,n);break;case s.C7.CIRCLE:case s.C7.SQUARE:u=this.addShapeContent(t,a.pagePtr,i,n);break;case s.C7.UNDERLINE:case s.C7.STRIKEOUT:case s.C7.SQUIGGLY:case s.C7.HIGHLIGHT:u=this.addTextMarkupContent(t,a.pagePtr,i,n);break}return u?(void 0!==n.blendMode?this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(i,n.blendMode):this.pdfiumModule.EPDFAnnot_GenerateAppearance(i),this.pdfiumModule.FPDFPage_GenerateContent(a.pagePtr),this.pdfiumModule.FPDFPage_CloseAnnot(i),a.release(),this.logger.perf(L,N,"CreatePageAnnotation","End",`${e.id}-${t.index}`),s.m.resolve(n.id)):(this.pdfiumModule.FPDFPage_RemoveAnnot(a.pagePtr,i),a.release(),this.logger.perf(L,N,"CreatePageAnnotation","End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.CantSetAnnotContent,message:"can not add content of the annotation"}))}updatePageAnnotation(e,t,n){this.logger.debug(L,N,"updatePageAnnotation",e,t,n),this.logger.perf(L,N,"UpdatePageAnnotation","Begin",`${e.id}-${t.index}`);const r=this.cache.getContext(e.id);if(!r)return this.logger.perf(L,N,"UpdatePageAnnotation","End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const o=r.acquirePage(t.index),a=this.getAnnotationByName(o.pagePtr,n.id);if(!a)return o.release(),this.logger.perf(L,N,"UpdatePageAnnotation","End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.NotFound,message:"annotation not found"});if(!this.setPageAnnoRect(t,a,n.rect))return this.pdfiumModule.FPDFPage_CloseAnnot(a),o.release(),this.logger.perf(L,N,"UpdatePageAnnotation","End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.CantSetAnnotRect,message:"failed to move annotation"});let i=!1;switch(n.type){case s.C7.INK:if(!this.pdfiumModule.FPDFAnnot_RemoveInkList(a))break;i=this.addInkStroke(t,o.pagePtr,a,n);break;case s.C7.STAMP:i=this.addStampContent(r.docPtr,t,o.pagePtr,a,n);break;case s.C7.TEXT:i=this.addTextContent(t,o.pagePtr,a,n);break;case s.C7.FREETEXT:i=this.addFreeTextContent(t,o.pagePtr,a,n);break;case s.C7.CIRCLE:case s.C7.SQUARE:i=this.addShapeContent(t,o.pagePtr,a,n);break;case s.C7.LINE:i=this.addLineContent(t,o.pagePtr,a,n);break;case s.C7.POLYGON:case s.C7.POLYLINE:i=this.addPolyContent(t,o.pagePtr,a,n);break;case s.C7.HIGHLIGHT:case s.C7.UNDERLINE:case s.C7.STRIKEOUT:case s.C7.SQUIGGLY:i=this.addTextMarkupContent(t,o.pagePtr,a,n);break;default:i=!1}return i&&(void 0!==n.blendMode?this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(a,n.blendMode):this.pdfiumModule.EPDFAnnot_GenerateAppearance(a),this.pdfiumModule.FPDFPage_GenerateContent(o.pagePtr)),this.pdfiumModule.FPDFPage_CloseAnnot(a),o.release(),this.logger.perf(L,N,"UpdatePageAnnotation","End",`${e.id}-${t.index}`),i?s.m.resolve(!0):s.m.reject({code:s.iW.CantSetAnnotContent,message:"failed to update annotation"})}removePageAnnotation(e,t,n){this.logger.debug(L,N,"removePageAnnotation",e,t,n),this.logger.perf(L,N,"RemovePageAnnotation","Begin",`${e.id}-${t.index}`);const r=this.cache.getContext(e.id);if(!r)return this.logger.perf(L,N,"RemovePageAnnotation","End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const o=r.acquirePage(t.index);let a=!1;return a=this.removeAnnotationByName(o.pagePtr,n.id),a?(a=this.pdfiumModule.FPDFPage_GenerateContent(o.pagePtr),a||this.logger.error(L,N,"FPDFPage_GenerateContent Failed",`${e.id}-${t.index}`)):this.logger.error(L,N,"FPDFPage_RemoveAnnot Failed",`${e.id}-${t.index}`),o.release(),this.logger.perf(L,N,"RemovePageAnnotation","End",`${e.id}-${t.index}`),s.m.resolve(a)}getPageTextRects(e,t){this.logger.debug(L,N,"getPageTextRects",e,t),this.logger.perf(L,N,"GetPageTextRects","Begin",`${e.id}-${t.index}`);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(L,N,"GetPageTextRects","End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const r=n.acquirePage(t.index),o=this.pdfiumModule.FPDFText_LoadPage(r.pagePtr),a=this.readPageTextRects(t,r.docPtr,r.pagePtr,o);return this.pdfiumModule.FPDFText_ClosePage(o),r.release(),this.logger.perf(L,N,"GetPageTextRects","End",`${e.id}-${t.index}`),s.m.resolve(a)}renderThumbnailRaw(e,t,n){const{scaleFactor:r=1,...o}=n??{};this.logger.debug(L,N,"renderThumbnail",e,t,n),this.logger.perf(L,N,"RenderThumbnail","Begin",`${e.id}-${t.index}`);const a=this.cache.getContext(e.id);if(!a)return this.logger.perf(L,N,"RenderThumbnail","End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const i=this.renderPageRaw(e,t,{scaleFactor:Math.max(r,.5),...o});return this.logger.perf(L,N,"RenderThumbnail","End",`${e.id}-${t.index}`),i}getAttachments(e){this.logger.debug(L,N,"getAttachments",e),this.logger.perf(L,N,"GetAttachments","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(L,N,"GetAttachments","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const n=[],r=this.pdfiumModule.FPDFDoc_GetAttachmentCount(t.docPtr);for(let o=0;o<r;o++){const e=this.readPdfAttachment(t.docPtr,o);n.push(e)}return this.logger.perf(L,N,"GetAttachments","End",e.id),s.m.resolve(n)}addAttachment(e,t){this.logger.debug(L,N,"addAttachment",e,null==t?void 0:t.name),this.logger.perf(L,N,"AddAttachment","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(L,N,"AddAttachment","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const{name:r,description:o,mimeType:a,data:i}=t??{};if(!r)return this.logger.perf(L,N,"AddAttachment","End",e.id),s.m.reject({code:s.iW.NotFound,message:"attachment name is required"});if(!i||(Uint8Array,0===i.byteLength))return this.logger.perf(L,N,"AddAttachment","End",e.id),s.m.reject({code:s.iW.NotFound,message:"attachment data is empty"});const u=this.withWString(r,e=>this.pdfiumModule.FPDFDoc_AddAttachment(n.docPtr,e));if(!u)return this.logger.perf(L,N,"AddAttachment","End",e.id),s.m.reject({code:s.iW.Unknown,message:`An attachment named "${r}" already exists`});this.withWString(o,e=>this.pdfiumModule.EPDFAttachment_SetDescription(u,e)),this.pdfiumModule.EPDFAttachment_SetSubtype(u,a);const m=i instanceof Uint8Array?i:new Uint8Array(i),F=m.byteLength,l=this.memoryManager.malloc(F);try{this.pdfiumModule.pdfium.HEAPU8.set(m,l);const t=this.pdfiumModule.FPDFAttachment_SetFile(u,n.docPtr,l,F);if(!t)return this.logger.perf(L,N,"AddAttachment","End",e.id),s.m.reject({code:s.iW.Unknown,message:"failed to write attachment bytes"})}finally{this.memoryManager.free(l)}return this.logger.perf(L,N,"AddAttachment","End",e.id),s.m.resolve(!0)}removeAttachment(e,t){this.logger.debug(L,N,"deleteAttachment",e,t),this.logger.perf(L,N,"DeleteAttachment","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(L,N,"DeleteAttachment","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const r=this.pdfiumModule.FPDFDoc_GetAttachmentCount(n.docPtr);if(t.index<0||t.index>=r)return this.logger.perf(L,N,"DeleteAttachment","End",e.id),s.m.reject({code:s.iW.Unknown,message:`attachment index ${t.index} out of range`});const o=this.pdfiumModule.FPDFDoc_DeleteAttachment(n.docPtr,t.index);return this.logger.perf(L,N,"DeleteAttachment","End",e.id),o?s.m.resolve(!0):s.m.reject({code:s.iW.Unknown,message:"failed to delete attachment"})}readAttachmentContent(e,t){this.logger.debug(L,N,"readAttachmentContent",e,t),this.logger.perf(L,N,"ReadAttachmentContent","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(L,N,"ReadAttachmentContent","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const r=this.pdfiumModule.FPDFDoc_GetAttachment(n.docPtr,t.index),o=this.memoryManager.malloc(4);if(!this.pdfiumModule.FPDFAttachment_GetFile(r,0,0,o))return this.memoryManager.free(o),this.logger.perf(L,N,"ReadAttachmentContent","End",e.id),s.m.reject({code:s.iW.CantReadAttachmentSize,message:"can not read attachment size"});const a=this.pdfiumModule.pdfium.getValue(o,"i32")>>>0,i=this.memoryManager.malloc(a);if(!this.pdfiumModule.FPDFAttachment_GetFile(r,i,a,o))return this.memoryManager.free(o),this.memoryManager.free(i),this.logger.perf(L,N,"ReadAttachmentContent","End",e.id),s.m.reject({code:s.iW.CantReadAttachmentContent,message:"can not read attachment content"});const u=new ArrayBuffer(a),m=new DataView(u);for(let s=0;s<a;s++)m.setInt8(s,this.pdfiumModule.pdfium.getValue(i+s,"i8"));return this.memoryManager.free(o),this.memoryManager.free(i),this.logger.perf(L,N,"ReadAttachmentContent","End",e.id),s.m.resolve(u)}setFormFieldValue(e,t,n,r){this.logger.debug(L,N,"SetFormFieldValue",e,n,r),this.logger.perf(L,N,"SetFormFieldValue","Begin",`${e.id}-${n.id}`);const o=this.cache.getContext(e.id);if(!o)return this.logger.debug(L,N,"SetFormFieldValue","document is not opened"),this.logger.perf(L,N,"SetFormFieldValue","End",`${e.id}-${n.id}`),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const a=this.pdfiumModule.PDFiumExt_OpenFormFillInfo(),i=this.pdfiumModule.PDFiumExt_InitFormFillEnvironment(o.docPtr,a),u=o.acquirePage(t.index);this.pdfiumModule.FORM_OnAfterLoadPage(u.pagePtr,i);const m=this.getAnnotationByName(u.pagePtr,n.id);if(!m)return u.release(),this.logger.perf(L,N,"SetFormFieldValue","End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.NotFound,message:"annotation not found"});if(!this.pdfiumModule.FORM_SetFocusedAnnot(i,m))return this.logger.debug(L,N,"SetFormFieldValue","failed to set focused annotation"),this.logger.perf(L,N,"SetFormFieldValue","End",`${e.id}-${n.id}`),this.pdfiumModule.FPDFPage_CloseAnnot(m),this.pdfiumModule.FORM_OnBeforeClosePage(u.pagePtr,i),u.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(i),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(a),s.m.reject({code:s.iW.CantFocusAnnot,message:"failed to set focused annotation"});switch(r.kind){case"text":{if(!this.pdfiumModule.FORM_SelectAllText(i,u.pagePtr))return this.logger.debug(L,N,"SetFormFieldValue","failed to select all text"),this.logger.perf(L,N,"SetFormFieldValue","End",`${e.id}-${n.id}`),this.pdfiumModule.FORM_ForceToKillFocus(i),this.pdfiumModule.FPDFPage_CloseAnnot(m),this.pdfiumModule.FORM_OnBeforeClosePage(u.pagePtr,i),u.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(i),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(a),s.m.reject({code:s.iW.CantSelectText,message:"failed to select all text"});const t=2*(r.text.length+1),o=this.memoryManager.malloc(t);this.pdfiumModule.pdfium.stringToUTF16(r.text,o,t),this.pdfiumModule.FORM_ReplaceSelection(i,u.pagePtr,o),this.memoryManager.free(o)}break;case"selection":if(!this.pdfiumModule.FORM_SetIndexSelected(i,u.pagePtr,r.index,r.isSelected))return this.logger.debug(L,N,"SetFormFieldValue","failed to set index selected"),this.logger.perf(L,N,"SetFormFieldValue","End",`${e.id}-${n.id}`),this.pdfiumModule.FORM_ForceToKillFocus(i),this.pdfiumModule.FPDFPage_CloseAnnot(m),this.pdfiumModule.FORM_OnBeforeClosePage(u.pagePtr,i),u.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(i),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(a),s.m.reject({code:s.iW.CantSelectOption,message:"failed to set index selected"});break;case"checked":{const t=13;if(!this.pdfiumModule.FORM_OnChar(i,u.pagePtr,t,0))return this.logger.debug(L,N,"SetFormFieldValue","failed to set field checked"),this.logger.perf(L,N,"SetFormFieldValue","End",`${e.id}-${n.id}`),this.pdfiumModule.FORM_ForceToKillFocus(i),this.pdfiumModule.FPDFPage_CloseAnnot(m),this.pdfiumModule.FORM_OnBeforeClosePage(u.pagePtr,i),u.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(i),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(a),s.m.reject({code:s.iW.CantCheckField,message:"failed to set field checked"})}break}return this.pdfiumModule.FORM_ForceToKillFocus(i),this.pdfiumModule.FPDFPage_CloseAnnot(m),this.pdfiumModule.FORM_OnBeforeClosePage(u.pagePtr,i),u.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(i),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(a),s.m.resolve(!0)}flattenPage(e,t,n){const{flag:r=s.s_.Display}=n??{};this.logger.debug(L,N,"flattenPage",e,t,r),this.logger.perf(L,N,"flattenPage","Begin",e.id);const o=this.cache.getContext(e.id);if(!o)return this.logger.perf(L,N,"flattenPage","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const a=o.acquirePage(t.index),i=this.pdfiumModule.FPDFPage_Flatten(a.pagePtr,r);return a.release(),this.logger.perf(L,N,"flattenPage","End",e.id),s.m.resolve(i)}extractPages(e,t){this.logger.debug(L,N,"extractPages",e,t),this.logger.perf(L,N,"ExtractPages","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(L,N,"ExtractPages","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const r=this.pdfiumModule.FPDF_CreateNewDocument();if(!r)return this.logger.perf(L,N,"ExtractPages","End",e.id),s.m.reject({code:s.iW.CantCreateNewDoc,message:"can not create new document"});const o=this.memoryManager.malloc(4*t.length);for(let i=0;i<t.length;i++)this.pdfiumModule.pdfium.setValue(o+4*i,t[i],"i32");if(!this.pdfiumModule.FPDF_ImportPagesByIndex(r,n.docPtr,o,t.length,0))return this.pdfiumModule.FPDF_CloseDocument(r),this.logger.perf(L,N,"ExtractPages","End",e.id),s.m.reject({code:s.iW.CantImportPages,message:"can not import pages to new document"});const a=this.saveDocument(r);return this.pdfiumModule.FPDF_CloseDocument(r),this.logger.perf(L,N,"ExtractPages","End",e.id),s.m.resolve(a)}extractText(e,t){this.logger.debug(L,N,"extractText",e,t),this.logger.perf(L,N,"ExtractText","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(L,N,"ExtractText","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const r=[];for(let a=0;a<t.length;a++){const e=n.acquirePage(t[a]),o=this.pdfiumModule.FPDFText_LoadPage(e.pagePtr),i=this.pdfiumModule.FPDFText_CountChars(o),s=this.memoryManager.malloc(2*(i+1));this.pdfiumModule.FPDFText_GetText(o,0,i,s);const u=this.pdfiumModule.pdfium.UTF16ToString(s);this.memoryManager.free(s),r.push(u),this.pdfiumModule.FPDFText_ClosePage(o),e.release()}const o=r.join("\n\n");return this.logger.perf(L,N,"ExtractText","End",e.id),s.m.resolve(o)}getTextSlices(e,t){if(this.logger.debug(L,N,"getTextSlices",e,t),this.logger.perf(L,N,"GetTextSlices","Begin",e.id),0===t.length)return this.logger.perf(L,N,"GetTextSlices","End",e.id),s.m.resolve([]);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(L,N,"GetTextSlices","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});try{const r=new Array(t.length),o=new Map;t.forEach((e,t)=>{(o.get(e.pageIndex)??o.set(e.pageIndex,[]).get(e.pageIndex)).push({slice:e,pos:t})});for(const[e,t]of o){const o=n.acquirePage(e),a=o.getTextPage();for(const{slice:e,pos:n}of t){const t=this.memoryManager.malloc(2*(e.charCount+1));this.pdfiumModule.FPDFText_GetText(a,e.charIndex,e.charCount,t),r[n]=(0,s.qs)(this.pdfiumModule.pdfium.UTF16ToString(t)),this.memoryManager.free(t)}o.release()}return this.logger.perf(L,N,"GetTextSlices","End",e.id),s.m.resolve(r)}catch(r){return this.logger.error(L,N,"getTextSlices error",r),this.logger.perf(L,N,"GetTextSlices","End",e.id),s.m.reject({code:s.iW.Unknown,message:String(r)})}}merge(e){this.logger.debug(L,N,"merge",e);const t=e.map(e=>e.id).join(".");this.logger.perf(L,N,"Merge","Begin",t);const n=this.pdfiumModule.FPDF_CreateNewDocument();if(!n)return this.logger.perf(L,N,"Merge","End",t),s.m.reject({code:s.iW.CantCreateNewDoc,message:"can not create new document"});const r=[];for(const i of e.reverse()){const e=new Uint8Array(i.content),o=e.length,a=this.memoryManager.malloc(o);this.pdfiumModule.pdfium.HEAPU8.set(e,a);const u=this.pdfiumModule.FPDF_LoadMemDocument(a,o,"");if(!u){const e=this.pdfiumModule.FPDF_GetLastError();this.logger.error(L,N,`FPDF_LoadMemDocument failed with ${e}`),this.memoryManager.free(a);for(const t of r)this.pdfiumModule.FPDF_CloseDocument(t.docPtr),this.memoryManager.free(t.filePtr);return this.logger.perf(L,N,"Merge","End",t),s.m.reject({code:e,message:"FPDF_LoadMemDocument failed"})}if(r.push({filePtr:a,docPtr:u}),!this.pdfiumModule.FPDF_ImportPages(n,u,"",0)){this.pdfiumModule.FPDF_CloseDocument(n);for(const e of r)this.pdfiumModule.FPDF_CloseDocument(e.docPtr),this.memoryManager.free(e.filePtr);return this.logger.perf(L,N,"Merge","End",t),s.m.reject({code:s.iW.CantImportPages,message:"can not import pages to new document"})}}const o=this.saveDocument(n);this.pdfiumModule.FPDF_CloseDocument(n);for(const i of r)this.pdfiumModule.FPDF_CloseDocument(i.docPtr),this.memoryManager.free(i.filePtr);const a={id:`${Math.random()}`,content:o};return this.logger.perf(L,N,"Merge","End",t),s.m.resolve(a)}mergePages(e){const t=e.map(e=>`${e.docId}:${e.pageIndices.join(",")}`).join("|");this.logger.debug(L,N,"mergePages",e),this.logger.perf(L,N,"MergePages","Begin",t);const n=this.pdfiumModule.FPDF_CreateNewDocument();if(!n)return this.logger.perf(L,N,"MergePages","End",t),s.m.reject({code:s.iW.CantCreateNewDoc,message:"Cannot create new document"});try{for(const t of[...e].reverse()){const e=this.cache.getContext(t.docId);if(!e){this.logger.warn(L,N,`Document ${t.docId} is not open, skipping`);continue}const r=this.pdfiumModule.FPDF_GetPageCount(e.docPtr),o=t.pageIndices.filter(e=>e>=0&&e<r);if(0===o.length)continue;const a=o.map(e=>e+1).join(",");try{if(!this.pdfiumModule.FPDF_ImportPages(n,e.docPtr,a,0))throw new Error(`Failed to import pages ${a} from document ${t.docId}`)}finally{}}const r=this.saveDocument(n),o={id:`${Math.random()}`,content:r};return this.logger.perf(L,N,"MergePages","End",t),s.m.resolve(o)}catch(r){return this.logger.error(L,N,"mergePages failed",r),this.logger.perf(L,N,"MergePages","End",t),s.m.reject({code:s.iW.CantImportPages,message:r instanceof Error?r.message:"Failed to merge pages"})}finally{n&&this.pdfiumModule.FPDF_CloseDocument(n)}}saveAsCopy(e){this.logger.debug(L,N,"saveAsCopy",e),this.logger.perf(L,N,"SaveAsCopy","Begin",e.id);const t=this.cache.getContext(e.id);if(!t)return this.logger.perf(L,N,"SaveAsCopy","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const n=this.saveDocument(t.docPtr);return this.logger.perf(L,N,"SaveAsCopy","End",e.id),s.m.resolve(n)}closeDocument(e){this.logger.debug(L,N,"closeDocument",e),this.logger.perf(L,N,"CloseDocument","Begin",e.id);const t=this.cache.getContext(e.id);return t?(t.dispose(),this.logger.perf(L,N,"CloseDocument","End",e.id),s.m.resolve(!0)):s.m.resolve(!0)}closeAllDocuments(){return this.logger.debug(L,N,"closeAllDocuments"),this.logger.perf(L,N,"CloseAllDocuments","Begin"),this.cache.closeAllDocuments(),this.logger.perf(L,N,"CloseAllDocuments","End"),s.m.resolve(!0)}addTextContent(e,t,n,r){return!!this.setAnnotString(n,"Contents",r.contents??"")&&(!(r.custom&&!this.setAnnotCustom(n,r.custom))&&(!!this.setAnnotString(n,"T",r.author||"")&&(!(r.modified&&!this.setAnnotationDate(n,"M",r.modified))&&(!(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created))&&(!(r.inReplyToId&&!this.setInReplyToId(t,n,r.inReplyToId))&&(!!this.setAnnotationIcon(n,r.icon||s.l4.Comment)&&(!!this.setAnnotationFlags(n,r.flags||["print","noZoom","noRotate"])&&(!(r.state&&!this.setAnnotString(n,"State",r.state))&&!(r.stateModel&&!this.setAnnotString(n,"StateModel",r.stateModel))))))))))}addFreeTextContent(e,t,n,r){if(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created))return!1;if(r.custom&&!this.setAnnotCustom(n,r.custom))return!1;if(r.flags&&!this.setAnnotationFlags(n,r.flags))return!1;if(r.modified&&!this.setAnnotationDate(n,"M",r.modified))return!1;if(!this.setBorderStyle(n,s.vI.SOLID,0))return!1;if(!this.setAnnotString(n,"Contents",r.contents??""))return!1;if(!this.setAnnotString(n,"T",r.author||""))return!1;if(!this.setAnnotationOpacity(n,r.opacity??1))return!1;if(!this.setAnnotationTextAlignment(n,r.textAlign))return!1;if(!this.setAnnotationVerticalAlignment(n,r.verticalAlign))return!1;if(!this.setAnnotationDefaultAppearance(n,r.fontFamily,r.fontSize,r.fontColor))return!1;if(r.intent&&!this.setAnnotIntent(n,r.intent))return!1;if(r.backgroundColor&&"transparent"!==r.backgroundColor){if(!this.setAnnotationColor(n,r.backgroundColor??"#FFFFFF",s.ZR.Color))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,s.ZR.Color))return!1;return!0}addInkStroke(e,t,n,r){return!(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created))&&(!(r.custom&&!this.setAnnotCustom(n,r.custom))&&(!(r.flags&&!this.setAnnotationFlags(n,r.flags))&&(!(r.modified&&!this.setAnnotationDate(n,"M",r.modified))&&(!!this.setAnnotString(n,"Contents",r.contents??"")&&(!!this.setBorderStyle(n,s.vI.SOLID,r.strokeWidth)&&(!!this.setInkList(e,n,r.inkList)&&(!!this.setAnnotString(n,"T",r.author||"")&&(!!this.setAnnotationOpacity(n,r.opacity??1)&&!!this.setAnnotationColor(n,r.color??"#FFFF00",s.ZR.Color)))))))))}addLineContent(e,t,n,r){var o,a;if(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created))return!1;if(r.custom&&!this.setAnnotCustom(n,r.custom))return!1;if(r.flags&&!this.setAnnotationFlags(n,r.flags))return!1;if(r.modified&&!this.setAnnotationDate(n,"M",r.modified))return!1;if(!this.setLinePoints(e,n,r.linePoints.start,r.linePoints.end))return!1;if(!this.setLineEndings(n,(null==(o=r.lineEndings)?void 0:o.start)??s.gt.None,(null==(a=r.lineEndings)?void 0:a.end)??s.gt.None))return!1;if(!this.setAnnotString(n,"Contents",r.contents??""))return!1;if(!this.setAnnotString(n,"T",r.author||""))return!1;if(!this.setBorderStyle(n,r.strokeStyle,r.strokeWidth))return!1;if(!this.setBorderDashPattern(n,r.strokeDashArray??[]))return!1;if(r.intent&&!this.setAnnotIntent(n,r.intent))return!1;if(r.color&&"transparent"!==r.color){if(!this.setAnnotationColor(n,r.color??"#FFFF00",s.ZR.InteriorColor))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,s.ZR.InteriorColor))return!1;return!!this.setAnnotationOpacity(n,r.opacity??1)&&!!this.setAnnotationColor(n,r.strokeColor??"#FFFF00",s.ZR.Color)}addPolyContent(e,t,n,r){var o,a;if(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created))return!1;if(r.custom&&!this.setAnnotCustom(n,r.custom))return!1;if(r.modified&&!this.setAnnotationDate(n,"M",r.modified))return!1;if(r.flags&&!this.setAnnotationFlags(n,r.flags))return!1;if(r.type===s.C7.POLYLINE&&!this.setLineEndings(n,(null==(o=r.lineEndings)?void 0:o.start)??s.gt.None,(null==(a=r.lineEndings)?void 0:a.end)??s.gt.None))return!1;if(!this.setPdfAnnoVertices(e,n,r.vertices))return!1;if(!this.setAnnotString(n,"Contents",r.contents??""))return!1;if(!this.setAnnotString(n,"T",r.author||""))return!1;if(!this.setBorderStyle(n,r.strokeStyle,r.strokeWidth))return!1;if(!this.setBorderDashPattern(n,r.strokeDashArray??[]))return!1;if(r.intent&&!this.setAnnotIntent(n,r.intent))return!1;if(r.color&&"transparent"!==r.color){if(!this.setAnnotationColor(n,r.color??"#FFFF00",s.ZR.InteriorColor))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,s.ZR.InteriorColor))return!1;return!!this.setAnnotationOpacity(n,r.opacity??1)&&!!this.setAnnotationColor(n,r.strokeColor??"#FFFF00",s.ZR.Color)}addShapeContent(e,t,n,r){if(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created))return!1;if(r.custom&&!this.setAnnotCustom(n,r.custom))return!1;if(r.modified&&!this.setAnnotationDate(n,"M",r.modified))return!1;if(!this.setAnnotString(n,"Contents",r.contents??""))return!1;if(!this.setAnnotString(n,"T",r.author||""))return!1;if(!this.setBorderStyle(n,r.strokeStyle,r.strokeWidth))return!1;if(!this.setBorderDashPattern(n,r.strokeDashArray??[]))return!1;if(!this.setAnnotationFlags(n,r.flags))return!1;if(r.color&&"transparent"!==r.color){if(!this.setAnnotationColor(n,r.color??"#FFFF00",s.ZR.InteriorColor))return!1}else if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,s.ZR.InteriorColor))return!1;return!!this.setAnnotationOpacity(n,r.opacity??1)&&!!this.setAnnotationColor(n,r.strokeColor??"#FFFF00",s.ZR.Color)}addTextMarkupContent(e,t,n,r){return!(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created))&&(!(r.custom&&!this.setAnnotCustom(n,r.custom))&&(!(r.flags&&!this.setAnnotationFlags(n,r.flags))&&(!(r.modified&&!this.setAnnotationDate(n,"M",r.modified))&&(!!this.syncQuadPointsAnno(e,n,r.segmentRects)&&(!!this.setAnnotString(n,"Contents",r.contents??"")&&(!!this.setAnnotString(n,"T",r.author||"")&&(!!this.setAnnotationOpacity(n,r.opacity??1)&&!!this.setAnnotationColor(n,r.color??"#FFFF00",s.ZR.Color))))))))}addStampContent(e,t,n,r,o,a){if(o.created&&!this.setAnnotationDate(r,"CreationDate",o.created))return!1;if(o.custom&&!this.setAnnotCustom(r,o.custom))return!1;if(o.flags&&!this.setAnnotationFlags(r,o.flags))return!1;if(o.modified&&!this.setAnnotationDate(r,"M",o.modified))return!1;if(o.icon&&!this.setAnnotationIcon(r,o.icon))return!1;if(!this.setAnnotString(r,"T",o.author||""))return!1;if(o.subject&&!this.setAnnotString(r,"Subj",o.subject))return!1;if(!this.setAnnotString(r,"Contents",o.contents??""))return!1;if(a){for(let e=this.pdfiumModule.FPDFAnnot_GetObjectCount(r)-1;e>=0;e--)this.pdfiumModule.FPDFAnnot_RemoveObject(r,e);if(!this.addImageObject(e,t,n,r,o.rect,a))return!1}return!!this.pdfiumModule.EPDFAnnot_UpdateAppearanceToRect(r,s.Zn.Cover)}addImageObject(e,t,n,r,o,a){const i=4,s=a.width*a.height,u=this.memoryManager.malloc(i*s);if(!u)return!1;for(let c=0;c<s;c++){const e=a.data[c*i],t=a.data[c*i+1],n=a.data[c*i+2],r=a.data[c*i+3];this.pdfiumModule.pdfium.setValue(u+c*i,n,"i8"),this.pdfiumModule.pdfium.setValue(u+c*i+1,t,"i8"),this.pdfiumModule.pdfium.setValue(u+c*i+2,e,"i8"),this.pdfiumModule.pdfium.setValue(u+c*i+3,r,"i8")}const m=4,F=this.pdfiumModule.FPDFBitmap_CreateEx(a.width,a.height,m,u,0);if(!F)return this.memoryManager.free(u),!1;const l=this.pdfiumModule.FPDFPageObj_NewImageObj(e);if(!l)return this.pdfiumModule.FPDFBitmap_Destroy(F),this.memoryManager.free(u),!1;if(!this.pdfiumModule.FPDFImageObj_SetBitmap(n,0,l,F))return this.pdfiumModule.FPDFBitmap_Destroy(F),this.pdfiumModule.FPDFPageObj_Destroy(l),this.memoryManager.free(u),!1;const d=this.memoryManager.malloc(24);if(this.pdfiumModule.pdfium.setValue(d,a.width,"float"),this.pdfiumModule.pdfium.setValue(d+4,0,"float"),this.pdfiumModule.pdfium.setValue(d+8,0,"float"),this.pdfiumModule.pdfium.setValue(d+12,a.height,"float"),this.pdfiumModule.pdfium.setValue(d+16,0,"float"),this.pdfiumModule.pdfium.setValue(d+20,0,"float"),!this.pdfiumModule.FPDFPageObj_SetMatrix(l,d))return this.memoryManager.free(d),this.pdfiumModule.FPDFBitmap_Destroy(F),this.pdfiumModule.FPDFPageObj_Destroy(l),this.memoryManager.free(u),!1;this.memoryManager.free(d);const _=this.convertDevicePointToPagePoint(t,{x:o.origin.x,y:o.origin.y+a.height});return this.pdfiumModule.FPDFPageObj_Transform(l,1,0,0,1,_.x,_.y),this.pdfiumModule.FPDFAnnot_AppendObject(r,l)?(this.pdfiumModule.FPDFBitmap_Destroy(F),this.memoryManager.free(u),!0):(this.pdfiumModule.FPDFBitmap_Destroy(F),this.pdfiumModule.FPDFPageObj_Destroy(l),this.memoryManager.free(u),!1)}saveDocument(e){const t=this.pdfiumModule.PDFiumExt_OpenFileWriter();this.pdfiumModule.PDFiumExt_SaveAsCopy(e,t);const n=this.pdfiumModule.PDFiumExt_GetFileWriterSize(t),r=this.memoryManager.malloc(n);this.pdfiumModule.PDFiumExt_GetFileWriterData(t,r,n);const o=new ArrayBuffer(n),a=new DataView(o);for(let i=0;i<n;i++)a.setInt8(i,this.pdfiumModule.pdfium.getValue(r+i,"i8"));return this.memoryManager.free(r),this.pdfiumModule.PDFiumExt_CloseFileWriter(t),o}readCatalogLanguage(e){const t=this.pdfiumModule.EPDFCatalog_GetLanguage(e,0,0)>>>0;return 0===t?null:2===t?"":F(this.pdfiumModule.pdfium,(t,n)=>this.pdfiumModule.EPDFCatalog_GetLanguage(e,t,n),this.pdfiumModule.pdfium.UTF16ToString,t)}readMetaText(e,t){const n=!!this.pdfiumModule.EPDF_HasMetaText(e,t);if(!n)return null;const r=this.pdfiumModule.FPDF_GetMetaText(e,t,0,0);return 2===r?"":F(this.pdfiumModule.pdfium,(n,r)=>this.pdfiumModule.FPDF_GetMetaText(e,t,n,r),this.pdfiumModule.pdfium.UTF16ToString,r)}setMetaText(e,t,n){if(null==n||0===n.length){const n=this.pdfiumModule.EPDF_SetMetaText(e,t,0);return!!n}const r=2*(n.length+1),o=this.memoryManager.malloc(r);try{this.pdfiumModule.pdfium.stringToUTF16(n,o,r);const a=this.pdfiumModule.EPDF_SetMetaText(e,t,o);return!!a}finally{this.memoryManager.free(o)}}getMetaTrapped(e){const t=Number(this.pdfiumModule.EPDF_GetMetaTrapped(e));switch(t){case s.L1.NotSet:case s.L1.True:case s.L1.False:case s.L1.Unknown:return t;default:return s.L1.Unknown}}setMetaTrapped(e,t){const n=null==t||void 0===t?s.L1.NotSet:t,r=n===s.L1.NotSet||n===s.L1.True||n===s.L1.False||n===s.L1.Unknown;return!!r&&!!this.pdfiumModule.EPDF_SetMetaTrapped(e,n)}getMetaKeyCount(e,t){return 0|Number(this.pdfiumModule.EPDF_GetMetaKeyCount(e,t))}getMetaKeyName(e,t,n){const r=this.pdfiumModule.EPDF_GetMetaKeyName(e,t,n,0,0);return r?F(this.pdfiumModule.pdfium,(r,o)=>this.pdfiumModule.EPDF_GetMetaKeyName(e,t,n,r,o),this.pdfiumModule.pdfium.UTF8ToString,r):null}readAllMeta(e,t=!0){const n=this.getMetaKeyCount(e,t),r={};for(let o=0;o<n;o++){const n=this.getMetaKeyName(e,o,t);n&&(r[n]=this.readMetaText(e,n))}return r}readPdfBookmarks(e,t=0){let n=this.pdfiumModule.FPDFBookmark_GetFirstChild(e,t);const r=[];while(n){const t=this.readPdfBookmark(e,n);r.push(t);const o=this.pdfiumModule.FPDFBookmark_GetNextSibling(e,n);n=o}return r}readPdfBookmark(e,t){const n=F(this.pdfiumModule.pdfium,(e,n)=>this.pdfiumModule.FPDFBookmark_GetTitle(t,e,n),this.pdfiumModule.pdfium.UTF16ToString),r=this.readPdfBookmarks(e,t),o=this.readPdfBookmarkTarget(e,()=>this.pdfiumModule.FPDFBookmark_GetAction(t),()=>this.pdfiumModule.FPDFBookmark_GetDest(e,t));return{title:n,target:o,children:r}}readPageTextRects(e,t,n,r){const o=this.pdfiumModule.FPDFText_CountRects(r,0,-1),a=[];for(let i=0;i<o;i++){const t=this.memoryManager.malloc(8),o=this.memoryManager.malloc(8),s=this.memoryManager.malloc(8),u=this.memoryManager.malloc(8),m=this.pdfiumModule.FPDFText_GetRect(r,i,o,t,s,u);if(!m){this.memoryManager.free(o),this.memoryManager.free(t),this.memoryManager.free(s),this.memoryManager.free(u);continue}const F=this.pdfiumModule.pdfium.getValue(o,"double"),l=this.pdfiumModule.pdfium.getValue(t,"double"),d=this.pdfiumModule.pdfium.getValue(s,"double"),_=this.pdfiumModule.pdfium.getValue(u,"double");this.memoryManager.free(o),this.memoryManager.free(t),this.memoryManager.free(s),this.memoryManager.free(u);const c=this.memoryManager.malloc(4),P=this.memoryManager.malloc(4);this.pdfiumModule.FPDF_PageToDevice(n,0,0,e.size.width,e.size.height,0,F,l,c,P);const g=this.pdfiumModule.pdfium.getValue(c,"i32"),h=this.pdfiumModule.pdfium.getValue(P,"i32");this.memoryManager.free(c),this.memoryManager.free(P);const D={origin:{x:g,y:h},size:{width:Math.ceil(Math.abs(d-F)),height:Math.ceil(Math.abs(l-_))}},b=this.pdfiumModule.FPDFText_GetBoundedText(r,F,l,d,_,0,0),f=2*(b+1),p=this.memoryManager.malloc(f);this.pdfiumModule.FPDFText_GetBoundedText(r,F,l,d,_,p,b);const A=this.pdfiumModule.pdfium.UTF16ToString(p);this.memoryManager.free(p);const E=this.pdfiumModule.FPDFText_GetCharIndexAtPos(r,F,l,2,2);let y="",M=D.size.height;if(E>=0){M=this.pdfiumModule.FPDFText_GetFontSize(r,E);const e=this.pdfiumModule.FPDFText_GetFontInfo(r,E,0,0,0),t=e+1,n=this.memoryManager.malloc(t),o=this.memoryManager.malloc(4);this.pdfiumModule.FPDFText_GetFontInfo(r,E,n,t,o),y=this.pdfiumModule.pdfium.UTF8ToString(n),this.memoryManager.free(n),this.memoryManager.free(o)}const G={content:A,rect:D,font:{family:y,size:M}};a.push(G)}return a}getPageGeometry(e,t){const n="getPageGeometry";this.logger.perf(L,N,n,"Begin",e.id);const r=this.cache.getContext(e.id);if(!r)return this.logger.perf(L,N,n,"End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const o=r.acquirePage(t.index),a=o.getTextPage(),i=this.pdfiumModule.FPDFText_CountChars(a),u=[];for(let s=0;s<i;s++){const e=this.readGlyphInfo(t,o.pagePtr,a,s);u.push(e)}const m=this.buildRunsFromGlyphs(u,a);return o.release(),this.logger.perf(L,N,n,"End",e.id),s.m.resolve({runs:m})}buildRunsFromGlyphs(e,t){const n=[];let r=null,o=null,a=null;for(let i=0;i<e.length;i++){const s=e[i],u=this.pdfiumModule.FPDFText_GetTextObject(t,i);if(u!==o&&(o=u,r={rect:{x:s.origin.x,y:s.origin.y,width:s.size.width,height:s.size.height},charStart:i,glyphs:[]},a={minX:s.origin.x,minY:s.origin.y,maxX:s.origin.x+s.size.width,maxY:s.origin.y+s.size.height},n.push(r)),r.glyphs.push({x:s.origin.x,y:s.origin.y,width:s.size.width,height:s.size.height,flags:s.isEmpty?2:s.isSpace?1:0}),s.isEmpty)continue;const m=s.origin.x+s.size.width,F=s.origin.y+s.size.height;a.minX=Math.min(a.minX,s.origin.x),a.minY=Math.min(a.minY,s.origin.y),a.maxX=Math.max(a.maxX,m),a.maxY=Math.max(a.maxY,F),r.rect.x=a.minX,r.rect.y=a.minY,r.rect.width=a.maxX-a.minX,r.rect.height=a.maxY-a.minY}return n}readGlyphInfo(e,t,n,r){const o=this.memoryManager.malloc(4),a=this.memoryManager.malloc(4),i=this.memoryManager.malloc(4),s=this.memoryManager.malloc(4),u=this.memoryManager.malloc(16);let m=0,F=0,l=0,d=0,_=!1;if(this.pdfiumModule.FPDFText_GetLooseCharBox(n,r,u)){const c=this.pdfiumModule.pdfium.getValue(u,"float"),P=this.pdfiumModule.pdfium.getValue(u+4,"float"),g=this.pdfiumModule.pdfium.getValue(u+8,"float"),h=this.pdfiumModule.pdfium.getValue(u+12,"float");if(c===g||P===h)return[u,o,a,i,s].forEach(e=>this.memoryManager.free(e)),{origin:{x:0,y:0},size:{width:0,height:0},isEmpty:!0};this.pdfiumModule.FPDF_PageToDevice(t,0,0,e.size.width,e.size.height,0,c,P,o,a),this.pdfiumModule.FPDF_PageToDevice(t,0,0,e.size.width,e.size.height,0,g,h,i,s);const D=this.pdfiumModule.pdfium.getValue(o,"i32"),b=this.pdfiumModule.pdfium.getValue(a,"i32"),f=this.pdfiumModule.pdfium.getValue(i,"i32"),p=this.pdfiumModule.pdfium.getValue(s,"i32");m=Math.min(D,f),F=Math.min(b,p),l=Math.max(1,Math.abs(f-D)),d=Math.max(1,Math.abs(p-b));const A=this.pdfiumModule.FPDFText_GetUnicode(n,r);_=32===A}return[u,o,a,i,s].forEach(e=>this.memoryManager.free(e)),{origin:{x:m,y:F},size:{width:l,height:d},..._&&{isSpace:_}}}getPageGlyphs(e,t){this.logger.debug(L,N,"getPageGlyphs",e,t),this.logger.perf(L,N,"getPageGlyphs","Begin",e.id);const n=this.cache.getContext(e.id);if(!n)return this.logger.perf(L,N,"getPageGlyphs","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const r=n.acquirePage(t.index),o=r.getTextPage(),a=this.pdfiumModule.FPDFText_CountChars(o),i=new Array(a);for(let s=0;s<a;s++){const e=this.readGlyphInfo(t,r.pagePtr,o,s);e.isEmpty||(i[s]={...e})}return r.release(),this.logger.perf(L,N,"getPageGlyphs","End",e.id),s.m.resolve(i)}readCharBox(e,t,n,r){const o=this.memoryManager.malloc(8),a=this.memoryManager.malloc(8),i=this.memoryManager.malloc(8),s=this.memoryManager.malloc(8);let u=0,m=0,F=0,l=0;if(this.pdfiumModule.FPDFText_GetCharBox(n,r,a,s,i,o)){const n=this.pdfiumModule.pdfium.getValue(o,"double"),r=this.pdfiumModule.pdfium.getValue(a,"double"),d=this.pdfiumModule.pdfium.getValue(i,"double"),_=this.pdfiumModule.pdfium.getValue(s,"double"),c=this.memoryManager.malloc(4),P=this.memoryManager.malloc(4);this.pdfiumModule.FPDF_PageToDevice(t,0,0,e.size.width,e.size.height,0,r,n,c,P),u=this.pdfiumModule.pdfium.getValue(c,"i32"),m=this.pdfiumModule.pdfium.getValue(P,"i32"),this.memoryManager.free(c),this.memoryManager.free(P),F=Math.ceil(Math.abs(_-r)),l=Math.ceil(Math.abs(n-d))}return this.memoryManager.free(o),this.memoryManager.free(a),this.memoryManager.free(i),this.memoryManager.free(s),{origin:{x:u,y:m},size:{width:F,height:l}}}readPageAnnotations(e,t){return e.borrowPage(t.index,n=>{const r=this.pdfiumModule.FPDFPage_GetAnnotCount(n.pagePtr),o=[];for(let a=0;a<r;a++)n.withAnnotation(a,r=>{const a=this.readPageAnnotation(e.docPtr,t,r,n);a&&o.push(a)});return o})}readPageAnnotationsRaw(e,t){const n=this.pdfiumModule.EPDFPage_GetAnnotCountRaw(e.docPtr,t.index);if(n<=0)return[];const r=[];for(let o=0;o<n;++o){const n=this.pdfiumModule.EPDFPage_GetAnnotRaw(e.docPtr,t.index,o);if(n)try{const o=this.readPageAnnotation(e.docPtr,t,n);o&&r.push(o)}finally{this.pdfiumModule.FPDFPage_CloseAnnot(n)}}return r}getPageAnnotationsRaw(e,t){this.logger.debug(L,N,"getPageAnnotationsRaw",e,t),this.logger.perf(L,N,"GetPageAnnotationsRaw","Begin",`${e.id}-${t.index}`);const n=this.cache.getContext(e.id);if(!n)return s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const r=this.readPageAnnotationsRaw(n,t);return this.logger.perf(L,N,"GetPageAnnotationsRaw","End",`${e.id}-${t.index}`),this.logger.debug(L,N,"getPageAnnotationsRaw",`${e.id}-${t.index}`,r),s.m.resolve(r)}readPageAnnotation(e,t,n,r){let o=this.getAnnotString(n,"NM");o&&(0,s._w)(o)||(o=(0,s.QT)(),this.setAnnotString(n,"NM",o));const a=this.pdfiumModule.FPDFAnnot_GetSubtype(n);let i;switch(a){case s.C7.TEXT:i=this.readPdfTextAnno(t,n,o);break;case s.C7.FREETEXT:i=this.readPdfFreeTextAnno(t,n,o);break;case s.C7.LINK:i=this.readPdfLinkAnno(t,e,n,o);break;case s.C7.WIDGET:if(r)return this.readPdfWidgetAnno(t,n,r.getFormHandle(),o);case s.C7.FILEATTACHMENT:i=this.readPdfFileAttachmentAnno(t,n,o);break;case s.C7.INK:i=this.readPdfInkAnno(t,n,o);break;case s.C7.POLYGON:i=this.readPdfPolygonAnno(t,n,o);break;case s.C7.POLYLINE:i=this.readPdfPolylineAnno(t,n,o);break;case s.C7.LINE:i=this.readPdfLineAnno(t,n,o);break;case s.C7.HIGHLIGHT:i=this.readPdfHighlightAnno(t,n,o);break;case s.C7.STAMP:i=this.readPdfStampAnno(t,n,o);break;case s.C7.SQUARE:i=this.readPdfSquareAnno(t,n,o);break;case s.C7.CIRCLE:i=this.readPdfCircleAnno(t,n,o);break;case s.C7.UNDERLINE:i=this.readPdfUnderlineAnno(t,n,o);break;case s.C7.SQUIGGLY:i=this.readPdfSquigglyAnno(t,n,o);break;case s.C7.STRIKEOUT:i=this.readPdfStrikeOutAnno(t,n,o);break;case s.C7.CARET:i=this.readPdfCaretAnno(t,n,o);break;default:i=this.readPdfAnno(t,a,n,o);break}return i}readAnnotationColor(e,t=s.ZR.Color){const n=this.memoryManager.malloc(4),r=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),a=this.pdfiumModule.EPDFAnnot_GetColor(e,t,n,r,o);let i;return a&&(i={red:255&this.pdfiumModule.pdfium.getValue(n,"i32"),green:255&this.pdfiumModule.pdfium.getValue(r,"i32"),blue:255&this.pdfiumModule.pdfium.getValue(o,"i32")}),this.memoryManager.free(n),this.memoryManager.free(r),this.memoryManager.free(o),i}getAnnotationColor(e,t=s.ZR.Color){const n=this.readAnnotationColor(e,t);return n?(0,s.Up)(n):void 0}setAnnotationColor(e,t,n=s.ZR.Color){const r=(0,s.I9)(t);return this.pdfiumModule.EPDFAnnot_SetColor(e,n,255&r.red,255&r.green,255&r.blue)}getAnnotationOpacity(e){const t=this.memoryManager.malloc(4),n=this.pdfiumModule.EPDFAnnot_GetOpacity(e,t),r=n?this.pdfiumModule.pdfium.getValue(t,"i32"):255;return this.memoryManager.free(t),(0,s.nR)(r)}setAnnotationOpacity(e,t){const n=(0,s.Vs)(t);return this.pdfiumModule.EPDFAnnot_SetOpacity(e,255&n)}getAnnotationTextAlignment(e){return this.pdfiumModule.EPDFAnnot_GetTextAlignment(e)}setAnnotationTextAlignment(e,t){return!!this.pdfiumModule.EPDFAnnot_SetTextAlignment(e,t)}getAnnotationVerticalAlignment(e){return this.pdfiumModule.EPDFAnnot_GetVerticalAlignment(e)}setAnnotationVerticalAlignment(e,t){return!!this.pdfiumModule.EPDFAnnot_SetVerticalAlignment(e,t)}getAnnotationDefaultAppearance(e){const t=this.memoryManager.malloc(4),n=this.memoryManager.malloc(4),r=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),a=this.memoryManager.malloc(4),i=!!this.pdfiumModule.EPDFAnnot_GetDefaultAppearance(e,t,n,r,o,a);if(!i)return void[t,n,r,o,a].forEach(e=>this.memoryManager.free(e));const u=this.pdfiumModule.pdfium,m=u.getValue(t,"i32"),F=u.getValue(n,"float"),l=255&u.getValue(r,"i32"),d=255&u.getValue(o,"i32"),_=255&u.getValue(a,"i32");return[t,n,r,o,a].forEach(e=>this.memoryManager.free(e)),{fontFamily:m,fontSize:F,fontColor:(0,s.Up)({red:l,green:d,blue:_})}}setAnnotationDefaultAppearance(e,t,n,r){const{red:o,green:a,blue:i}=(0,s.I9)(r);return!!this.pdfiumModule.EPDFAnnot_SetDefaultAppearance(e,t,n,255&o,255&a,255&i)}getBorderStyle(e){const t=this.memoryManager.malloc(4);let n=0,r=s.vI.UNKNOWN,o=!1;return r=this.pdfiumModule.EPDFAnnot_GetBorderStyle(e,t),n=this.pdfiumModule.pdfium.getValue(t,"float"),o=r!==s.vI.UNKNOWN,this.memoryManager.free(t),{ok:o,style:r,width:n}}setBorderStyle(e,t,n){return this.pdfiumModule.EPDFAnnot_SetBorderStyle(e,t,n)}getAnnotationIcon(e){return this.pdfiumModule.EPDFAnnot_GetIcon(e)}setAnnotationIcon(e,t){return this.pdfiumModule.EPDFAnnot_SetIcon(e,t)}getBorderEffect(e){const t=this.memoryManager.malloc(4),n=!!this.pdfiumModule.EPDFAnnot_GetBorderEffect(e,t),r=n?this.pdfiumModule.pdfium.getValue(t,"float"):0;return this.memoryManager.free(t),{ok:n,intensity:r}}getRectangleDifferences(e){const t=this.memoryManager.malloc(4),n=this.memoryManager.malloc(4),r=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),a=!!this.pdfiumModule.EPDFAnnot_GetRectangleDifferences(e,t,n,r,o),i=this.pdfiumModule.pdfium,s=i.getValue(t,"float"),u=i.getValue(n,"float"),m=i.getValue(r,"float"),F=i.getValue(o,"float");return this.memoryManager.free(t),this.memoryManager.free(n),this.memoryManager.free(r),this.memoryManager.free(o),{ok:a,left:s,top:u,right:m,bottom:F}}getAnnotationDate(e,t){const n=this.getAnnotString(e,t);return n?(0,s.oj)(n):void 0}setAnnotationDate(e,t,n){const r=(0,s._B)(n);return this.setAnnotString(e,t,r)}getAttachmentDate(e,t){const n=this.getAttachmentString(e,t);return n?(0,s.oj)(n):void 0}setAttachmentDate(e,t,n){const r=(0,s._B)(n);return this.setAttachmentString(e,t,r)}getBorderDashPattern(e){const t=this.pdfiumModule.EPDFAnnot_GetBorderDashPatternCount(e);if(0===t)return{ok:!1,pattern:[]};const n=this.memoryManager.malloc(4*t),r=!!this.pdfiumModule.EPDFAnnot_GetBorderDashPattern(e,n,t),o=[];if(r){const e=this.pdfiumModule.pdfium;for(let r=0;r<t;r++)o.push(e.getValue(n+4*r,"float"))}return this.memoryManager.free(n),{ok:r,pattern:o}}setBorderDashPattern(e,t){if(!t||0===t.length)return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(e,0,0);const n=t.map(e=>Number.isFinite(e)&&e>0?e:0).filter(e=>e>0);if(0===n.length)return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(e,0,0);const r=4*n.length,o=this.memoryManager.malloc(r);for(let i=0;i<n.length;i++)this.pdfiumModule.pdfium.setValue(o+4*i,n[i],"float");const a=!!this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(e,o,n.length);return this.memoryManager.free(o),a}getLineEndings(e){const t=this.memoryManager.malloc(4),n=this.memoryManager.malloc(4),r=!!this.pdfiumModule.EPDFAnnot_GetLineEndings(e,t,n);if(!r)return this.memoryManager.free(t),void this.memoryManager.free(n);const o=this.pdfiumModule.pdfium.getValue(t,"i32"),a=this.pdfiumModule.pdfium.getValue(n,"i32");return this.memoryManager.free(t),this.memoryManager.free(n),{start:o,end:a}}setLineEndings(e,t,n){return!!this.pdfiumModule.EPDFAnnot_SetLineEndings(e,t,n)}getLinePoints(e,t){const n=this.memoryManager.malloc(8),r=this.memoryManager.malloc(8),o=this.pdfiumModule.FPDFAnnot_GetLine(t,n,r);if(!o)return this.memoryManager.free(n),void this.memoryManager.free(r);const a=this.pdfiumModule.pdfium,i=a.getValue(n+0,"float"),s=a.getValue(n+4,"float"),u=a.getValue(r+0,"float"),m=a.getValue(r+4,"float");this.memoryManager.free(n),this.memoryManager.free(r);const F=this.convertPagePointToDevicePoint(e,{x:i,y:s}),l=this.convertPagePointToDevicePoint(e,{x:u,y:m});return{start:F,end:l}}setLinePoints(e,t,n,r){const o=this.convertDevicePointToPagePoint(e,n),a=this.convertDevicePointToPagePoint(e,r);if(!o||!a)return!1;const i=this.memoryManager.malloc(16),s=this.pdfiumModule.pdfium;s.setValue(i+0,o.x,"float"),s.setValue(i+4,o.y,"float"),s.setValue(i+8,a.x,"float"),s.setValue(i+12,a.y,"float");const u=this.pdfiumModule.EPDFAnnot_SetLine(t,i,i+8);return this.memoryManager.free(i),!!u}getQuadPointsAnno(e,t){const n=this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(t);if(0===n)return[];const r=32,o=[];for(let a=0;a<n;a++){const n=this.memoryManager.malloc(r),i=this.pdfiumModule.FPDFAnnot_GetAttachmentPoints(t,a,n);if(i){const t=[],r=[];for(let e=0;e<4;e++){const o=n+8*e;t.push(this.pdfiumModule.pdfium.getValue(o,"float")),r.push(this.pdfiumModule.pdfium.getValue(o+4,"float"))}const a=this.convertPagePointToDevicePoint(e,{x:t[0],y:r[0]}),i=this.convertPagePointToDevicePoint(e,{x:t[1],y:r[1]}),s=this.convertPagePointToDevicePoint(e,{x:t[2],y:r[2]}),u=this.convertPagePointToDevicePoint(e,{x:t[3],y:r[3]});o.push({p1:a,p2:i,p3:s,p4:u})}this.memoryManager.free(n)}return o.map(s.lw)}syncQuadPointsAnno(e,t,n){const r=32,o=this.pdfiumModule.pdfium,a=this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(t),i=this.memoryManager.malloc(r),u=t=>{const n=(0,s.bJ)(t),r=this.convertDevicePointToPagePoint(e,n.p1),a=this.convertDevicePointToPagePoint(e,n.p2),u=this.convertDevicePointToPagePoint(e,n.p3),m=this.convertDevicePointToPagePoint(e,n.p4);o.setValue(i+0,r.x,"float"),o.setValue(i+4,r.y,"float"),o.setValue(i+8,a.x,"float"),o.setValue(i+12,a.y,"float"),o.setValue(i+16,m.x,"float"),o.setValue(i+20,m.y,"float"),o.setValue(i+24,u.x,"float"),o.setValue(i+28,u.y,"float")},m=Math.min(a,n.length);for(let s=0;s<m;s++)if(u(n[s]),!this.pdfiumModule.FPDFAnnot_SetAttachmentPoints(t,s,i))return this.memoryManager.free(i),!1;for(let s=a;s<n.length;s++)if(u(n[s]),!this.pdfiumModule.FPDFAnnot_AppendAttachmentPoints(t,i))return this.memoryManager.free(i),!1;return this.memoryManager.free(i),!0}redactTextInRects(e,t,n,r){const{recurseForms:o=!0,drawBlackBoxes:a=!1}=r??{};this.logger.debug("PDFiumEngine","Engine","redactTextInQuads",e.id,t.index,n.length);const i="RedactTextInQuads";this.logger.perf("PDFiumEngine","Engine",i,"Begin",`${e.id}-${t.index}`);const u=this.cache.getContext(e.id);if(!u)return this.logger.perf("PDFiumEngine","Engine",i,"End",`${e.id}-${t.index}`),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const m=(n??[]).filter(e=>{var t,n,r,o;return e&&Number.isFinite(null==(t=e.origin)?void 0:t.x)&&Number.isFinite(null==(n=e.origin)?void 0:n.y)&&Number.isFinite(null==(r=e.size)?void 0:r.width)&&Number.isFinite(null==(o=e.size)?void 0:o.height)&&e.size.width>0&&e.size.height>0});if(0===m.length)return this.logger.perf("PDFiumEngine","Engine",i,"End",`${e.id}-${t.index}`),s.m.resolve(!1);const F=u.acquirePage(t.index),{ptr:l,count:d}=this.allocFSQuadsBufferFromRects(t,m);let _=!1;try{_=!!this.pdfiumModule.EPDFText_RedactInQuads(F.pagePtr,l,d,!!o,!!a)}finally{this.memoryManager.free(l)}return _&&(_=!!this.pdfiumModule.FPDFPage_GenerateContent(F.pagePtr)),F.disposeImmediate(),this.logger.perf("PDFiumEngine","Engine",i,"End",`${e.id}-${t.index}`),s.m.resolve(!!_)}allocFSQuadsBufferFromRects(e,t){const n=32,r=t.length,o=this.memoryManager.malloc(n*r),a=this.pdfiumModule.pdfium;for(let i=0;i<r;i++){const r=t[i],u=(0,s.bJ)(r),m=this.convertDevicePointToPagePoint(e,u.p1),F=this.convertDevicePointToPagePoint(e,u.p2),l=this.convertDevicePointToPagePoint(e,u.p3),d=this.convertDevicePointToPagePoint(e,u.p4),_=o+i*n;a.setValue(_+0,m.x,"float"),a.setValue(_+4,m.y,"float"),a.setValue(_+8,F.x,"float"),a.setValue(_+12,F.y,"float"),a.setValue(_+16,d.x,"float"),a.setValue(_+20,d.y,"float"),a.setValue(_+24,l.x,"float"),a.setValue(_+28,l.y,"float")}return{ptr:o,count:r}}getInkList(e,t){const n=[],r=this.pdfiumModule.FPDFAnnot_GetInkListCount(t);if(r<=0)return n;const o=this.pdfiumModule.pdfium,a=8;for(let i=0;i<r;i++){const r=[],s=this.pdfiumModule.FPDFAnnot_GetInkListPath(t,i,0,0);if(s>0){const n=this.memoryManager.malloc(s*a);this.pdfiumModule.FPDFAnnot_GetInkListPath(t,i,n,s);for(let t=0;t<s;t++){const i=n+t*a,s=o.getValue(i+0,"float"),u=o.getValue(i+4,"float"),m=this.convertPagePointToDevicePoint(e,{x:s,y:u});r.push({x:m.x,y:m.y})}this.memoryManager.free(n)}n.push({points:r})}return n}setInkList(e,t,n){const r=this.pdfiumModule.pdfium,o=8;for(const a of n){const n=a.points.length;if(0===n)continue;const i=this.memoryManager.malloc(n*o);for(let t=0;t<n;t++){const n=a.points[t],s=this.convertDevicePointToPagePoint(e,n);r.setValue(i+t*o+0,s.x,"float"),r.setValue(i+t*o+4,s.y,"float")}const s=this.pdfiumModule.FPDFAnnot_AddInkStroke(t,i,n);if(this.memoryManager.free(i),-1===s)return!1}return!0}readPdfTextAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"T"),u=this.getAnnotationDate(t,"M"),m=this.getAnnotationDate(t,"CreationDate"),F=this.getAnnotString(t,"Contents")||"",l=this.getAnnotString(t,"State"),d=this.getAnnotString(t,"StateModel"),_=this.getAnnotationColor(t),c=this.getAnnotationOpacity(t),P=this.getInReplyToId(t),g=this.getAnnotationFlags(t),h=this.getAnnotationIcon(t);return{pageIndex:e.index,custom:r,id:n,type:s.C7.TEXT,flags:g,contents:F,color:_??"#FFFF00",opacity:c,rect:a,inReplyToId:P,author:i,modified:u,created:m,state:l,stateModel:d,icon:h}}readPdfFreeTextAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"Contents")||"",u=this.getAnnotString(t,"T"),m=this.getAnnotationDate(t,"M"),F=this.getAnnotationDate(t,"CreationDate"),l=this.getAnnotString(t,"DS"),d=this.getAnnotationDefaultAppearance(t),_=this.getAnnotationColor(t),c=this.getAnnotationTextAlignment(t),P=this.getAnnotationVerticalAlignment(t),g=this.getAnnotationOpacity(t),h=this.getAnnotRichContent(t),D=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,type:s.C7.FREETEXT,fontFamily:(null==d?void 0:d.fontFamily)??s.p.Unknown,fontSize:(null==d?void 0:d.fontSize)??12,fontColor:(null==d?void 0:d.fontColor)??"#000000",verticalAlign:P,backgroundColor:_,flags:D,opacity:g,textAlign:c,defaultStyle:l,richContent:h,contents:i,author:u,modified:m,created:F,rect:a}}readPdfLinkAnno(e,t,n,r){const o=this.getAnnotCustom(n),a=this.pdfiumModule.FPDFAnnot_GetLink(n);if(!a)return;const i=this.readPageAnnoRect(n),u=this.convertPageRectToDeviceRect(e,i),m=this.getAnnotString(n,"T"),F=this.getAnnotationDate(n,"M"),l=this.getAnnotationDate(n,"CreationDate"),d=this.getAnnotationFlags(n),_=this.readPdfLinkAnnoTarget(t,()=>this.pdfiumModule.FPDFLink_GetAction(a),()=>this.pdfiumModule.FPDFLink_GetDest(t,a));return{pageIndex:e.index,custom:o,id:r,type:s.C7.LINK,flags:d,target:_,rect:u,author:m,modified:F,created:l}}readPdfWidgetAnno(e,t,n,r){const o=this.getAnnotCustom(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),u=this.getAnnotString(t,"T"),m=this.getAnnotationDate(t,"M"),F=this.getAnnotationDate(t,"CreationDate"),l=this.getAnnotationFlags(t),d=this.readPdfWidgetAnnoField(n,t);return{pageIndex:e.index,custom:o,id:r,type:s.C7.WIDGET,flags:l,rect:i,field:d,author:u,modified:m,created:F}}readPdfFileAttachmentAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"T"),u=this.getAnnotationDate(t,"M"),m=this.getAnnotationDate(t,"CreationDate"),F=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,type:s.C7.FILEATTACHMENT,flags:F,rect:a,author:i,modified:u,created:m}}readPdfInkAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"T"),u=this.getAnnotationDate(t,"M"),m=this.getAnnotationDate(t,"CreationDate"),F=this.getAnnotationColor(t),l=this.getAnnotationOpacity(t),{width:d}=this.getBorderStyle(t),_=this.getInkList(e,t),c=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),P=this.getAnnotIntent(t),g=this.getAnnotationFlags(t),h=this.getAnnotString(t,"Contents")||"";return{pageIndex:e.index,custom:r,id:n,type:s.C7.INK,...P&&{intent:P},contents:h,blendMode:c,flags:g,color:F??"#FF0000",opacity:l,strokeWidth:0===d?1:d,rect:a,inkList:_,author:i,modified:u,created:m}}readPdfPolygonAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"T"),u=this.getAnnotationDate(t,"M"),m=this.getAnnotationDate(t,"CreationDate"),F=this.readPdfAnnoVertices(e,t),l=this.getAnnotString(t,"Contents")||"",d=this.getAnnotationFlags(t),_=this.getAnnotationColor(t),c=this.getAnnotationColor(t,s.ZR.InteriorColor),P=this.getAnnotationOpacity(t);let g,{style:h,width:D}=this.getBorderStyle(t);if(h===s.vI.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);e&&(g=n)}if(F.length>1){const e=F[0],t=F[F.length-1];e.x===t.x&&e.y===t.y&&F.pop()}return{pageIndex:e.index,custom:r,id:n,type:s.C7.POLYGON,contents:l,flags:d,strokeColor:_??"#FF0000",color:c??"transparent",opacity:P,strokeWidth:0===D?1:D,strokeStyle:h,strokeDashArray:g,rect:a,vertices:F,author:i,modified:u,created:m}}readPdfPolylineAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"T"),u=this.getAnnotationDate(t,"M"),m=this.getAnnotationDate(t,"CreationDate"),F=this.readPdfAnnoVertices(e,t),l=this.getAnnotString(t,"Contents")||"",d=this.getAnnotationColor(t),_=this.getAnnotationFlags(t),c=this.getAnnotationColor(t,s.ZR.InteriorColor),P=this.getAnnotationOpacity(t);let g,{style:h,width:D}=this.getBorderStyle(t);if(h===s.vI.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);e&&(g=n)}const b=this.getLineEndings(t);return{pageIndex:e.index,custom:r,id:n,type:s.C7.POLYLINE,contents:l,flags:_,strokeColor:d??"#FF0000",color:c??"transparent",opacity:P,strokeWidth:0===D?1:D,strokeStyle:h,strokeDashArray:g,lineEndings:b,rect:a,vertices:F,author:i,modified:u,created:m}}readPdfLineAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"T"),u=this.getAnnotationDate(t,"M"),m=this.getAnnotationDate(t,"CreationDate"),F=this.getLinePoints(e,t),l=this.getLineEndings(t),d=this.getAnnotString(t,"Contents")||"",_=this.getAnnotationColor(t),c=this.getAnnotationFlags(t),P=this.getAnnotationColor(t,s.ZR.InteriorColor),g=this.getAnnotationOpacity(t);let h,{style:D,width:b}=this.getBorderStyle(t);if(D===s.vI.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);e&&(h=n)}return{pageIndex:e.index,custom:r,id:n,type:s.C7.LINE,flags:c,rect:a,contents:d,strokeWidth:0===b?1:b,strokeStyle:D,strokeDashArray:h,strokeColor:_??"#FF0000",color:P??"transparent",opacity:g,linePoints:F||{start:{x:0,y:0},end:{x:0,y:0}},lineEndings:l||{start:s.gt.None,end:s.gt.None},author:i,modified:u,created:m}}readPdfHighlightAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getQuadPointsAnno(e,t),u=this.getAnnotationColor(t),m=this.getAnnotationOpacity(t),F=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),l=this.getAnnotString(t,"T"),d=this.getAnnotationDate(t,"M"),_=this.getAnnotationDate(t,"CreationDate"),c=this.getAnnotString(t,"Contents")||"",P=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,blendMode:F,type:s.C7.HIGHLIGHT,rect:a,flags:P,contents:c,segmentRects:i,color:u??"#FFFF00",opacity:m,author:l,modified:d,created:_}}readPdfUnderlineAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"T"),u=this.getAnnotationDate(t,"M"),m=this.getAnnotationDate(t,"CreationDate"),F=this.getQuadPointsAnno(e,t),l=this.getAnnotString(t,"Contents")||"",d=this.getAnnotationColor(t),_=this.getAnnotationOpacity(t),c=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),P=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,blendMode:c,type:s.C7.UNDERLINE,rect:a,flags:P,contents:l,segmentRects:F,color:d??"#FF0000",opacity:_,author:i,modified:u,created:m}}readPdfStrikeOutAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"T"),u=this.getAnnotationDate(t,"M"),m=this.getAnnotationDate(t,"CreationDate"),F=this.getQuadPointsAnno(e,t),l=this.getAnnotString(t,"Contents")||"",d=this.getAnnotationColor(t),_=this.getAnnotationOpacity(t),c=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),P=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,blendMode:c,type:s.C7.STRIKEOUT,flags:P,rect:a,contents:l,segmentRects:F,color:d??"#FF0000",opacity:_,author:i,modified:u,created:m}}readPdfSquigglyAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"T"),u=this.getAnnotationDate(t,"M"),m=this.getAnnotationDate(t,"CreationDate"),F=this.getQuadPointsAnno(e,t),l=this.getAnnotString(t,"Contents")||"",d=this.getAnnotationColor(t),_=this.getAnnotationOpacity(t),c=this.pdfiumModule.EPDFAnnot_GetBlendMode(t),P=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,blendMode:c,type:s.C7.SQUIGGLY,rect:a,flags:P,contents:l,segmentRects:F,color:d??"#FF0000",opacity:_,author:i,modified:u,created:m}}readPdfCaretAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"T"),u=this.getAnnotationDate(t,"M"),m=this.getAnnotationDate(t,"CreationDate"),F=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,type:s.C7.CARET,rect:a,flags:F,author:i,modified:u,created:m}}readPdfStampAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.readPageAnnoRect(t),a=this.convertPageRectToDeviceRect(e,o),i=this.getAnnotString(t,"T"),u=this.getAnnotationDate(t,"M"),m=this.getAnnotationDate(t,"CreationDate"),F=this.getAnnotationFlags(t),l=this.getAnnotString(t,"Contents")||"";return{pageIndex:e.index,custom:r,id:n,type:s.C7.STAMP,contents:l,rect:a,author:i,modified:u,created:m,flags:F}}readPdfPageObject(e){const t=this.pdfiumModule.FPDFPageObj_GetType(e);switch(t){case s.Tx.PATH:return this.readPathObject(e);case s.Tx.IMAGE:return this.readImageObject(e);case s.Tx.FORM:return this.readFormObject(e)}}readPathObject(e){const t=this.pdfiumModule.FPDFPath_CountSegments(e),n=this.memoryManager.malloc(4),r=this.memoryManager.malloc(4),o=this.memoryManager.malloc(4),a=this.memoryManager.malloc(4);this.pdfiumModule.FPDFPageObj_GetBounds(e,n,r,o,a);const i=this.pdfiumModule.pdfium.getValue(n,"float"),u=this.pdfiumModule.pdfium.getValue(r,"float"),m=this.pdfiumModule.pdfium.getValue(o,"float"),F=this.pdfiumModule.pdfium.getValue(a,"float"),l={left:i,bottom:u,right:m,top:F};this.memoryManager.free(n),this.memoryManager.free(r),this.memoryManager.free(o),this.memoryManager.free(a);const d=[];for(let s=0;s<t;s++){const t=this.readPdfSegment(e,s);d.push(t)}const _=this.readPdfPageObjectTransformMatrix(e);return{type:s.Tx.PATH,bounds:l,segments:d,matrix:_}}readPdfSegment(e,t){const n=this.pdfiumModule.FPDFPath_GetPathSegment(e,t),r=this.pdfiumModule.FPDFPathSegment_GetType(n),o=this.pdfiumModule.FPDFPathSegment_GetClose(n),a=this.memoryManager.malloc(4),i=this.memoryManager.malloc(4);this.pdfiumModule.FPDFPathSegment_GetPoint(n,a,i);const s=this.pdfiumModule.pdfium.getValue(a,"float"),u=this.pdfiumModule.pdfium.getValue(i,"float");return this.memoryManager.free(a),this.memoryManager.free(i),{type:r,point:{x:s,y:u},isClosed:o}}readImageObject(e){const t=this.pdfiumModule.FPDFImageObj_GetBitmap(e),n=this.pdfiumModule.FPDFBitmap_GetBuffer(t),r=this.pdfiumModule.FPDFBitmap_GetWidth(t),o=this.pdfiumModule.FPDFBitmap_GetHeight(t),a=this.pdfiumModule.FPDFBitmap_GetFormat(t),i=r*o,u=4,m=new Uint8ClampedArray(i*u);for(let s=0;s<i;s++)switch(a){case 2:{const e=this.pdfiumModule.pdfium.getValue(n+3*s,"i8"),t=this.pdfiumModule.pdfium.getValue(n+3*s+1,"i8"),r=this.pdfiumModule.pdfium.getValue(n+3*s+2,"i8");m[s*u]=r,m[s*u+1]=t,m[s*u+2]=e,m[s*u+3]=100}break}const F={data:m,width:r,height:o},l=this.readPdfPageObjectTransformMatrix(e);return{type:s.Tx.IMAGE,imageData:F,matrix:l}}readFormObject(e){const t=this.pdfiumModule.FPDFFormObj_CountObjects(e),n=[];for(let o=0;o<t;o++){const t=this.pdfiumModule.FPDFFormObj_GetObject(e,o),r=this.readPdfPageObject(t);r&&n.push(r)}const r=this.readPdfPageObjectTransformMatrix(e);return{type:s.Tx.FORM,objects:n,matrix:r}}readPdfPageObjectTransformMatrix(e){const t=this.memoryManager.malloc(24);if(this.pdfiumModule.FPDFPageObj_GetMatrix(e,t)){const e=this.pdfiumModule.pdfium.getValue(t,"float"),n=this.pdfiumModule.pdfium.getValue(t+4,"float"),r=this.pdfiumModule.pdfium.getValue(t+8,"float"),o=this.pdfiumModule.pdfium.getValue(t+12,"float"),a=this.pdfiumModule.pdfium.getValue(t+16,"float"),i=this.pdfiumModule.pdfium.getValue(t+20,"float");return this.memoryManager.free(t),{a:e,b:n,c:r,d:o,e:a,f:i}}return this.memoryManager.free(t),{a:1,b:0,c:0,d:1,e:0,f:0}}readStampAnnotationContents(e){const t=[],n=this.pdfiumModule.FPDFAnnot_GetObjectCount(e);for(let r=0;r<n;r++){const n=this.pdfiumModule.FPDFAnnot_GetObject(e,r),o=this.readPdfPageObject(n);o&&t.push(o)}return t}getStrokeWidth(e){const t=this.memoryManager.malloc(4),n=this.memoryManager.malloc(4),r=this.memoryManager.malloc(4),o=this.pdfiumModule.FPDFAnnot_GetBorder(e,t,n,r),a=o?this.pdfiumModule.pdfium.getValue(r,"float"):1;return this.memoryManager.free(t),this.memoryManager.free(n),this.memoryManager.free(r),a}getAnnotationFlags(e){const t=this.pdfiumModule.FPDFAnnot_GetFlags(e);return(0,s.h5)(t)}setAnnotationFlags(e,t){const n=(0,s.Z6)(t);return this.pdfiumModule.FPDFAnnot_SetFlags(e,n)}readPdfCircleAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.getAnnotationFlags(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),u=this.getAnnotString(t,"T"),m=this.getAnnotationDate(t,"M"),F=this.getAnnotationDate(t,"CreationDate"),l=this.getAnnotString(t,"Contents")||"",d=this.getAnnotationColor(t,s.ZR.InteriorColor),_=this.getAnnotationColor(t),c=this.getAnnotationOpacity(t);let P,{style:g,width:h}=this.getBorderStyle(t);if(g===s.vI.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);e&&(P=n)}return{pageIndex:e.index,custom:r,id:n,type:s.C7.CIRCLE,flags:o,color:d??"transparent",opacity:c,contents:l,strokeWidth:h,strokeColor:_??"#FF0000",strokeStyle:g,rect:i,author:u,modified:m,created:F,...void 0!==P&&{strokeDashArray:P}}}readPdfSquareAnno(e,t,n){const r=this.getAnnotCustom(t),o=this.getAnnotationFlags(t),a=this.readPageAnnoRect(t),i=this.convertPageRectToDeviceRect(e,a),u=this.getAnnotString(t,"T"),m=this.getAnnotationDate(t,"M"),F=this.getAnnotationDate(t,"CreationDate"),l=this.getAnnotString(t,"Contents")||"",d=this.getAnnotationColor(t,s.ZR.InteriorColor),_=this.getAnnotationColor(t),c=this.getAnnotationOpacity(t);let P,{style:g,width:h}=this.getBorderStyle(t);if(g===s.vI.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);e&&(P=n)}return{pageIndex:e.index,custom:r,id:n,type:s.C7.SQUARE,flags:o,color:d??"transparent",opacity:c,contents:l,strokeColor:_??"#FF0000",strokeWidth:h,strokeStyle:g,rect:i,author:u,modified:m,created:F,...void 0!==P&&{strokeDashArray:P}}}readPdfAnno(e,t,n,r){const o=this.getAnnotCustom(n),a=this.readPageAnnoRect(n),i=this.convertPageRectToDeviceRect(e,a),s=this.getAnnotString(n,"T"),u=this.getAnnotationDate(n,"M"),m=this.getAnnotationDate(n,"CreationDate"),F=this.getAnnotationFlags(n);return{pageIndex:e.index,custom:o,id:r,flags:F,type:t,rect:i,author:s,modified:u,created:m}}getInReplyToId(e){const t=this.pdfiumModule.FPDFAnnot_GetLinkedAnnot(e,"IRT");if(t)return this.getAnnotString(t,"NM")}setInReplyToId(e,t,n){const r=this.getAnnotationByName(e,n);return!!r&&this.pdfiumModule.EPDFAnnot_SetLinkedAnnot(t,"IRT",r)}getAnnotString(e,t){const n=this.pdfiumModule.FPDFAnnot_GetStringValue(e,t,0,0);if(0===n)return;const r=2*(n+1),o=this.memoryManager.malloc(r);this.pdfiumModule.FPDFAnnot_GetStringValue(e,t,o,r);const a=this.pdfiumModule.pdfium.UTF16ToString(o);return this.memoryManager.free(o),a||void 0}getAttachmentString(e,t){const n=this.pdfiumModule.FPDFAttachment_GetStringValue(e,t,0,0);if(0===n)return;const r=2*(n+1),o=this.memoryManager.malloc(r);this.pdfiumModule.FPDFAttachment_GetStringValue(e,t,o,r);const a=this.pdfiumModule.pdfium.UTF16ToString(o);return this.memoryManager.free(o),a||void 0}getAttachmentNumber(e,t){const n=this.memoryManager.malloc(4);try{const r=this.pdfiumModule.EPDFAttachment_GetIntegerValue(e,t,n);if(!r)return;return this.pdfiumModule.pdfium.getValue(n,"i32")>>>0}finally{this.memoryManager.free(n)}}getAnnotCustom(e){const t=this.getAnnotString(e,"EPDFCustom");if(t)try{return JSON.parse(t)}catch(n){return console.warn("Failed to parse annotation custom data as JSON:",n),void console.warn("Invalid JSON string:",t)}}setAnnotCustom(e,t){if(void 0===t||null===t)return this.setAnnotString(e,"EPDFCustom","");try{const n=JSON.stringify(t);return this.setAnnotString(e,"EPDFCustom",n)}catch(n){return console.warn("Failed to stringify annotation custom data as JSON:",n),console.warn("Invalid data object:",t),!1}}getAnnotIntent(e){const t=this.pdfiumModule.EPDFAnnot_GetIntent(e,0,0);if(0===t)return;const n=t+1,r=2*n,o=this.memoryManager.malloc(r);this.pdfiumModule.EPDFAnnot_GetIntent(e,o,r);const a=this.pdfiumModule.pdfium.UTF16ToString(o);return this.memoryManager.free(o),a&&"undefined"!==a?a:void 0}setAnnotIntent(e,t){return this.pdfiumModule.EPDFAnnot_SetIntent(e,t)}getAnnotRichContent(e){const t=this.pdfiumModule.EPDFAnnot_GetRichContent(e,0,0);if(0===t)return;const n=t+1,r=2*n,o=this.memoryManager.malloc(r);this.pdfiumModule.EPDFAnnot_GetRichContent(e,o,r);const a=this.pdfiumModule.pdfium.UTF16ToString(o);return this.memoryManager.free(o),a||void 0}getAnnotationByName(e,t){return this.withWString(t,t=>this.pdfiumModule.EPDFPage_GetAnnotByName(e,t))}removeAnnotationByName(e,t){return this.withWString(t,t=>this.pdfiumModule.EPDFPage_RemoveAnnotByName(e,t))}setAnnotString(e,t,n){return this.withWString(n,n=>this.pdfiumModule.FPDFAnnot_SetStringValue(e,t,n))}setAttachmentString(e,t,n){return this.withWString(n,n=>this.pdfiumModule.FPDFAttachment_SetStringValue(e,t,n))}readPdfAnnoVertices(e,t){const n=[],r=this.pdfiumModule.FPDFAnnot_GetVertices(t,0,0),o=8,a=this.memoryManager.malloc(r*o);this.pdfiumModule.FPDFAnnot_GetVertices(t,a,r);for(let i=0;i<r;i++){const t=this.pdfiumModule.pdfium.getValue(a+i*o,"float"),r=this.pdfiumModule.pdfium.getValue(a+i*o+4,"float"),{x:s,y:u}=this.convertPagePointToDevicePoint(e,{x:t,y:r}),m=n[n.length-1];m&&m.x===s&&m.y===u||n.push({x:s,y:u})}return this.memoryManager.free(a),n}setPdfAnnoVertices(e,t,n){const r=this.pdfiumModule.pdfium,o=8,a=this.memoryManager.malloc(o*n.length);n.forEach((t,n)=>{const i=this.convertDevicePointToPagePoint(e,t);r.setValue(a+n*o+0,i.x,"float"),r.setValue(a+n*o+4,i.y,"float")});const i=this.pdfiumModule.EPDFAnnot_SetVertices(t,a,n.length);return this.memoryManager.free(a),i}readPdfBookmarkTarget(e,t,n){const r=t();if(r){const t=this.readPdfAction(e,r);return{type:"action",action:t}}{const t=n();if(t){const n=this.readPdfDestination(e,t);return{type:"destination",destination:n}}}}readPdfWidgetAnnoField(e,t){const n=this.pdfiumModule.FPDFAnnot_GetFormFieldFlags(e,t),r=this.pdfiumModule.FPDFAnnot_GetFormFieldType(e,t),o=F(this.pdfiumModule.pdfium,(n,r)=>this.pdfiumModule.FPDFAnnot_GetFormFieldName(e,t,n,r),this.pdfiumModule.pdfium.UTF16ToString),a=F(this.pdfiumModule.pdfium,(n,r)=>this.pdfiumModule.FPDFAnnot_GetFormFieldAlternateName(e,t,n,r),this.pdfiumModule.pdfium.UTF16ToString),i=F(this.pdfiumModule.pdfium,(n,r)=>this.pdfiumModule.FPDFAnnot_GetFormFieldValue(e,t,n,r),this.pdfiumModule.pdfium.UTF16ToString),u=[];if(r===s.QX.COMBOBOX||r===s.QX.LISTBOX){const n=this.pdfiumModule.FPDFAnnot_GetOptionCount(e,t);for(let r=0;r<n;r++){const n=F(this.pdfiumModule.pdfium,(n,o)=>this.pdfiumModule.FPDFAnnot_GetOptionLabel(e,t,r,n,o),this.pdfiumModule.pdfium.UTF16ToString),o=this.pdfiumModule.FPDFAnnot_IsOptionSelected(e,t,r);u.push({label:n,isSelected:o})}}let m=!1;return r!==s.QX.CHECKBOX&&r!==s.QX.RADIOBUTTON||(m=this.pdfiumModule.FPDFAnnot_IsChecked(e,t)),{flag:n,type:r,name:o,alternateName:a,value:i,isChecked:m,options:u}}renderPageAnnotationRaw(e,t,n,r){const{scaleFactor:o=1,rotation:a=s.pL.Degree0,dpr:i=1,mode:u=s.ae.Normal}=r??{};this.logger.debug(L,N,"renderPageAnnotation",e,t,n,r),this.logger.perf(L,N,"RenderPageAnnotation","Begin",`${e.id}-${t.index}-${n.id}`);const m=new s.YZ,F=this.cache.getContext(e.id);if(!F)return this.logger.perf(L,N,"RenderPageAnnotation","End",`${e.id}-${t.index}-${n.id}`),s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const l=F.acquirePage(t.index),d=this.getAnnotationByName(l.pagePtr,n.id);if(!d)return this.logger.perf(L,N,"RenderPageAnnotation","End",`${e.id}-${t.index}-${n.id}`),l.release(),s.m.reject({code:s.iW.NotFound,message:"annotation not found"});const _=Math.max(.01,o*i),c=(0,s.Ai)(n.rect),P=(0,s.Ai)((0,s.H5)(t.size,c,a,_)),g=Math.max(1,P.size.width),h=Math.max(1,P.size.height),D=4*g,b=D*h,f=this.memoryManager.malloc(b),p=this.pdfiumModule.FPDFBitmap_CreateEx(g,h,4,f,D);this.pdfiumModule.FPDFBitmap_FillRect(p,0,0,g,h,0);const A=(0,s.Wv)(c,a,g,h),E=this.memoryManager.malloc(24),y=new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,E,6);y.set([A.a,A.b,A.c,A.d,A.e,A.f]);const M=16;let G=!1;try{G=!!this.pdfiumModule.EPDF_RenderAnnotBitmap(p,l.pagePtr,d,u,E,M)}finally{this.memoryManager.free(E),this.pdfiumModule.FPDFBitmap_Destroy(p),this.pdfiumModule.FPDFPage_CloseAnnot(d),l.release()}if(!G)return this.memoryManager.free(f),this.logger.perf(L,N,"RenderPageAnnotation","End",`${e.id}-${t.index}-${n.id}`),s.m.reject({code:s.iW.Unknown,message:"EPDF_RenderAnnotBitmap failed"});const C=this.pdfiumModule.pdfium.HEAPU8.subarray(f,f+b),S={data:new Uint8ClampedArray(C),width:g,height:h};return m.resolve(S),this.memoryManager.free(f),m}renderRectEncoded(e,t,n,r){const o=new s.YZ,a=(null==r?void 0:r.rotation)??s.pL.Degree0,i=this.cache.getContext(e.id);if(!i)return s.m.reject({code:s.iW.DocNotOpen,message:"document does not open"});const u=Math.max(.01,(null==r?void 0:r.scaleFactor)??1),m=Math.max(1,(null==r?void 0:r.dpr)??1),F=u*m,l=n.size.width,d=n.size.height,_=1===(1&a),P=Math.max(1,Math.round((_?d:l)*F)),g=Math.max(1,Math.round((_?l:d)*F)),h=4*P,D=h*g,b=i.acquirePage(t.index),f=(null==r?void 0:r.withForms)??!1,p=f?b.getFormHandle():void 0,A=this.memoryManager.malloc(D),E=this.pdfiumModule.FPDFBitmap_CreateEx(P,g,4,A,h);this.pdfiumModule.FPDFBitmap_FillRect(E,0,0,P,g,4294967295);const y=(0,s.Wv)(n,a,P,g),M=this.memoryManager.malloc(24),G=new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,M,6);G.set([y.a,y.b,y.c,y.d,y.e,y.f]);const C=this.memoryManager.malloc(16),S=new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,C,4);S.set([0,0,P,g]);let T=16;(null==r?void 0:r.withAnnotations)&&(T|=1);try{if(this.pdfiumModule.FPDF_RenderPageBitmapWithMatrix(E,b.pagePtr,M,C,T),void 0!==p){const e=c(y,n,t.size,a),{startX:r,startY:o,formsWidth:i,formsHeight:s,scaleX:u,scaleY:m}=e;this.pdfiumModule.FPDF_FFLDraw(p,E,b.pagePtr,r,o,i,s,a,T)}}finally{b.release(),this.memoryManager.free(M),this.memoryManager.free(C)}this.logger.perf(L,N,"RenderRectEncodedData","Begin",`${e.id}-${t.index}`);const x=this.pdfiumModule.pdfium.HEAPU8.subarray(A,A+D);this.logger.perf(L,N,"RenderRectEncodedData","End",`${e.id}-${t.index}`),this.logger.perf(L,N,"RenderRectEncodedImageData","Begin",`${e.id}-${t.index}`);const v={data:new Uint8ClampedArray(x),width:P,height:g};return this.logger.perf(L,N,"RenderRectEncodedImageData","End",`${e.id}-${t.index}`),o.resolve(v),this.pdfiumModule.FPDFBitmap_Destroy(E),this.memoryManager.free(A),o}readPdfLinkAnnoTarget(e,t,n){const r=n();if(r){const t=this.readPdfDestination(e,r);return{type:"destination",destination:t}}{const n=t();if(n){const t=this.readPdfAction(e,n);return{type:"action",action:t}}}}createLocalDestPtr(e,t){var n,r;const o=this.pdfiumModule.FPDF_LoadPage(e,t.pageIndex);if(!o)return 0;try{if(t.zoom.mode===s.DT.XYZ){const{x:e,y:n,zoom:r}=t.zoom.params;return this.pdfiumModule.EPDFDest_CreateXYZ(o,!0,e,!0,n,!0,r)}let e,a=[];switch(t.zoom.mode){case s.DT.FitPage:e=s.DT.FitPage;break;case s.DT.FitHorizontal:e=s.DT.FitHorizontal,a=[(null==(n=t.view)?void 0:n[0])??0];break;case s.DT.FitVertical:e=s.DT.FitVertical,a=[(null==(r=t.view)?void 0:r[0])??0];break;case s.DT.FitRectangle:{const n=t.view??[];a=[n[0]??0,n[1]??0,n[2]??0,n[3]??0],e=s.DT.FitRectangle}break;case s.DT.Unknown:default:return 0}return this.withFloatArray(a,(t,n)=>this.pdfiumModule.EPDFDest_CreateView(o,e,t,n))}finally{this.pdfiumModule.FPDF_ClosePage(o)}}applyBookmarkTarget(e,t,n){if("destination"===n.type){const r=this.createLocalDestPtr(e,n.destination);if(!r)return!1;const o=this.pdfiumModule.EPDFBookmark_SetDest(e,t,r);return!!o}const r=n.action;switch(r.type){case s.zI.Goto:{const n=this.createLocalDestPtr(e,r.destination);if(!n)return!1;const o=this.pdfiumModule.EPDFAction_CreateGoTo(e,n);return!!o&&!!this.pdfiumModule.EPDFBookmark_SetAction(e,t,o)}case s.zI.URI:{const n=this.pdfiumModule.EPDFAction_CreateURI(e,r.uri);return!!n&&!!this.pdfiumModule.EPDFBookmark_SetAction(e,t,n)}case s.zI.LaunchAppOrOpenFile:{const n=this.withWString(r.path,t=>this.pdfiumModule.EPDFAction_CreateLaunch(e,t));return!!n&&!!this.pdfiumModule.EPDFBookmark_SetAction(e,t,n)}case s.zI.RemoteGoto:return!1;case s.zI.Unsupported:default:return!1}}readPdfAction(e,t){const n=this.pdfiumModule.FPDFAction_GetType(t);let r;switch(n){case s.zI.Unsupported:r={type:s.zI.Unsupported};break;case s.zI.Goto:{const n=this.pdfiumModule.FPDFAction_GetDest(e,t);if(n){const t=this.readPdfDestination(e,n);r={type:s.zI.Goto,destination:t}}else r={type:s.zI.Unsupported}}break;case s.zI.RemoteGoto:r={type:s.zI.Unsupported};break;case s.zI.URI:{const n=F(this.pdfiumModule.pdfium,(n,r)=>this.pdfiumModule.FPDFAction_GetURIPath(e,t,n,r),this.pdfiumModule.pdfium.UTF8ToString);r={type:s.zI.URI,uri:n}}break;case s.zI.LaunchAppOrOpenFile:{const e=F(this.pdfiumModule.pdfium,(e,n)=>this.pdfiumModule.FPDFAction_GetFilePath(t,e,n),this.pdfiumModule.pdfium.UTF8ToString);r={type:s.zI.LaunchAppOrOpenFile,path:e}}break}return r}readPdfDestination(e,t){const n=this.pdfiumModule.FPDFDest_GetDestPageIndex(e,t),r=4,o=this.memoryManager.malloc(r),a=this.memoryManager.malloc(4*r),i=this.pdfiumModule.FPDFDest_GetView(t,o,a),u=this.pdfiumModule.pdfium.getValue(o,"i32"),m=[];for(let s=0;s<u;s++){const e=a+4*s;m.push(this.pdfiumModule.pdfium.getValue(e,"float"))}if(this.memoryManager.free(o),this.memoryManager.free(a),i===s.DT.XYZ){const e=this.memoryManager.malloc(1),r=this.memoryManager.malloc(1),o=this.memoryManager.malloc(1),a=this.memoryManager.malloc(4),s=this.memoryManager.malloc(4),u=this.memoryManager.malloc(4),F=this.pdfiumModule.FPDFDest_GetLocationInPage(t,e,r,o,a,s,u);if(F){const t=this.pdfiumModule.pdfium.getValue(e,"i8"),F=this.pdfiumModule.pdfium.getValue(r,"i8"),l=this.pdfiumModule.pdfium.getValue(o,"i8"),d=t?this.pdfiumModule.pdfium.getValue(a,"float"):0,_=F?this.pdfiumModule.pdfium.getValue(s,"float"):0,c=l?this.pdfiumModule.pdfium.getValue(u,"float"):0;return this.memoryManager.free(e),this.memoryManager.free(r),this.memoryManager.free(o),this.memoryManager.free(a),this.memoryManager.free(s),this.memoryManager.free(u),{pageIndex:n,zoom:{mode:i,params:{x:d,y:_,zoom:c}},view:m}}return this.memoryManager.free(e),this.memoryManager.free(r),this.memoryManager.free(o),this.memoryManager.free(a),this.memoryManager.free(s),this.memoryManager.free(u),{pageIndex:n,zoom:{mode:i,params:{x:0,y:0,zoom:0}},view:m}}return{pageIndex:n,zoom:{mode:i},view:m}}readPdfAttachment(e,t){const n=this.pdfiumModule.FPDFDoc_GetAttachment(e,t),r=F(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.FPDFAttachment_GetName(n,e,t),this.pdfiumModule.pdfium.UTF16ToString),o=F(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.EPDFAttachment_GetDescription(n,e,t),this.pdfiumModule.pdfium.UTF16ToString),a=F(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.FPDFAttachment_GetSubtype(n,e,t),this.pdfiumModule.pdfium.UTF16ToString),i=this.getAttachmentDate(n,"CreationDate"),s=F(this.pdfiumModule.pdfium,(e,t)=>this.pdfiumModule.FPDFAttachment_GetStringValue(n,"Checksum",e,t),this.pdfiumModule.pdfium.UTF16ToString),u=this.getAttachmentNumber(n,"Size");return{index:t,name:r,description:o,mimeType:a,size:u,creationDate:i,checksum:s}}convertDevicePointToPagePoint(e,t){const n=e.size.width,r=e.size.height,o=3&e.rotation;return 0===o?{x:t.x,y:r-t.y}:1===o?{x:t.y,y:t.x}:2===o?{x:n-t.x,y:t.y}:{x:r-t.y,y:n-t.x}}convertPagePointToDevicePoint(e,t){const n=e.size.width,r=e.size.height,o=3&e.rotation;return 0===o?{x:t.x,y:r-t.y}:1===o?{x:t.y,y:t.x}:2===o?{x:n-t.x,y:t.y}:{x:n-t.y,y:r-t.x}}convertPageRectToDeviceRect(e,t){const{x:n,y:r}=this.convertPagePointToDevicePoint(e,{x:t.left,y:t.top}),o={origin:{x:n,y:r},size:{width:Math.abs(t.right-t.left),height:Math.abs(t.top-t.bottom)}};return o}readPageAnnoAppearanceStreams(e){return{normal:this.readPageAnnoAppearanceStream(e,s.ae.Normal),rollover:this.readPageAnnoAppearanceStream(e,s.ae.Rollover),down:this.readPageAnnoAppearanceStream(e,s.ae.Down)}}readPageAnnoAppearanceStream(e,t=s.ae.Normal){const n=this.pdfiumModule.FPDFAnnot_GetAP(e,t,0,0),r=2*(n+1),o=this.memoryManager.malloc(r);this.pdfiumModule.FPDFAnnot_GetAP(e,t,o,r);const a=this.pdfiumModule.pdfium.UTF16ToString(o);return this.memoryManager.free(o),a}setPageAnnoAppearanceStream(e,t=s.ae.Normal,n){const r=2*(n.length+1),o=this.memoryManager.malloc(r);try{this.pdfiumModule.pdfium.stringToUTF16(n,o,r);const a=this.pdfiumModule.FPDFAnnot_SetAP(e,t,o);return!!a}finally{this.memoryManager.free(o)}}setPageAnnoRect(e,t,n){const r=Math.floor(n.origin.x),o=Math.floor(n.origin.y),a=Math.floor(n.origin.x+n.size.width),i=Math.floor(n.origin.y+n.size.height),s=this.convertDevicePointToPagePoint(e,{x:r,y:o}),u=this.convertDevicePointToPagePoint(e,{x:a,y:o}),m=this.convertDevicePointToPagePoint(e,{x:a,y:i}),F=this.convertDevicePointToPagePoint(e,{x:r,y:i});let l=Math.min(s.x,u.x,m.x,F.x),d=Math.max(s.x,u.x,m.x,F.x),_=Math.min(s.y,u.y,m.y,F.y),c=Math.max(s.y,u.y,m.y,F.y);l>d&&([l,d]=[d,l]),_>c&&([_,c]=[c,_]);const P=this.memoryManager.malloc(16),g=this.pdfiumModule.pdfium;g.setValue(P+0,l,"float"),g.setValue(P+4,c,"float"),g.setValue(P+8,d,"float"),g.setValue(P+12,_,"float");const h=this.pdfiumModule.FPDFAnnot_SetRect(t,P);return this.memoryManager.free(P),!!h}readPageAnnoRect(e){const t=this.memoryManager.malloc(16),n={left:0,top:0,right:0,bottom:0};return this.pdfiumModule.FPDFAnnot_GetRect(e,t)&&(n.left=this.pdfiumModule.pdfium.getValue(t,"float"),n.top=this.pdfiumModule.pdfium.getValue(t+4,"float"),n.right=this.pdfiumModule.pdfium.getValue(t+8,"float"),n.bottom=this.pdfiumModule.pdfium.getValue(t+12,"float")),this.memoryManager.free(t),n}getHighlightRects(e,t,n,r){const o=this.pdfiumModule.FPDFText_CountRects(t,n,r),a=[],i=this.memoryManager.malloc(8),s=this.memoryManager.malloc(8),u=this.memoryManager.malloc(8),m=this.memoryManager.malloc(8);for(let F=0;F<o;F++){const n=this.pdfiumModule.FPDFText_GetRect(t,F,i,s,u,m);if(!n)continue;const r=this.pdfiumModule.pdfium.getValue(i,"double"),o=this.pdfiumModule.pdfium.getValue(s,"double"),l=this.pdfiumModule.pdfium.getValue(u,"double"),d=this.pdfiumModule.pdfium.getValue(m,"double"),_=this.convertPagePointToDevicePoint(e,{x:r,y:o}),c=this.convertPagePointToDevicePoint(e,{x:l,y:o}),P=this.convertPagePointToDevicePoint(e,{x:l,y:d}),g=this.convertPagePointToDevicePoint(e,{x:r,y:d}),h=[_.x,c.x,P.x,g.x],D=[_.y,c.y,P.y,g.y],b=Math.min(...h),f=Math.min(...D),p=Math.max(...h)-b,A=Math.max(...D)-f;a.push({origin:{x:b,y:f},size:{width:Math.ceil(p),height:Math.ceil(A)}})}return this.memoryManager.free(i),this.memoryManager.free(s),this.memoryManager.free(u),this.memoryManager.free(m),a}searchInPage(e,t,n,r){this.logger.debug(L,N,"searchInPage",e,t,n,r),this.logger.perf(L,N,"SearchInPage","Begin",`${e.id}-${t.index}`);const o=this.cache.getContext(e.id);if(!o)return this.logger.perf(L,N,"PreparePrintDocument","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"Document is not open"});const a=2*(n.length+1),i=this.memoryManager.malloc(a);this.pdfiumModule.pdfium.stringToUTF16(n,i,a);try{const e=this.searchAllInPage(o,t,i,r);return s.m.resolve(e)}finally{this.memoryManager.free(i)}}getAnnotationsBatch(e,t){this.logger.debug(L,N,"getAnnotationsBatch",e.id,t.length);const n=new s.YZ;return queueMicrotask(()=>{this.logger.perf(L,N,"GetAnnotationsBatch","Begin",e.id);const r=this.cache.getContext(e.id);if(!r)return void n.reject({code:s.iW.DocNotOpen,message:"Document is not open"});const o={},a=t.length;for(let e=0;e<t.length;e++){const i=t[e],s=this.readPageAnnotationsRaw(r,i);o[i.index]=s,n.progress({pageIndex:i.index,result:s,completed:e+1,total:a})}this.logger.perf(L,N,"GetAnnotationsBatch","End",e.id),n.resolve(o)}),n}searchBatch(e,t,n,r){this.logger.debug(L,N,"searchBatch",e.id,t.length,n);const o=new s.YZ;return queueMicrotask(()=>{this.logger.perf(L,N,"SearchBatch","Begin",e.id);const a=this.cache.getContext(e.id);if(!a)return void o.reject({code:s.iW.DocNotOpen,message:"Document is not open"});const i=2*(n.length+1),u=this.memoryManager.malloc(i);this.pdfiumModule.pdfium.stringToUTF16(n,u,i);try{const n={},i=t.length;for(let e=0;e<t.length;e++){const s=t[e],m=this.searchAllInPage(a,s,u,r);n[s.index]=m,o.progress({pageIndex:s.index,result:m,completed:e+1,total:i})}this.logger.perf(L,N,"SearchBatch","End",e.id),o.resolve(n)}finally{this.memoryManager.free(u)}}),o}buildContext(e,t,n,r=30){const o=/[\s\u00A0.,;:!?()\[\]{}<>/\\\-"'`"\u2013\u2014]/,a=t=>{while(t>0&&!o.test(e[t-1]))t--;return t},i=t=>{while(t<e.length&&!o.test(e[t]))t++;return t};let s=t;while(s>0&&o.test(e[s-1]))s--;let u=0;while(s>0&&u<r)s--,o.test(e[s])||u++;s=a(s);let m=t+n;while(m<e.length&&o.test(e[m]))m++;u=0;while(m<e.length&&u<r)o.test(e[m])||u++,m++;m=i(m);const F=e.slice(s,t).replace(/\s+/g," ").trimStart(),l=e.slice(t,t+n),d=e.slice(t+n,m).replace(/\s+/g," ").trimEnd();return{before:this.tidy(F),match:this.tidy(l),after:this.tidy(d),truncatedLeft:s>0,truncatedRight:m<e.length}}tidy(e){return e.replace(/-\uFFFE\s*/g,"").replace(/[\uFFFE\u00AD\u200B\u2060\uFEFF]/g,"").replace(/\s+/g," ")}searchAllInPage(e,t,n,r){return e.borrowPage(t.index,e=>{const o=e.getTextPage(),a=this.pdfiumModule.FPDFText_CountChars(o),i=this.memoryManager.malloc(2*(a+1));this.pdfiumModule.FPDFText_GetText(o,0,a,i);const s=this.pdfiumModule.pdfium.UTF16ToString(i);this.memoryManager.free(i);const u=[],m=this.pdfiumModule.FPDFText_FindStart(o,n,r,0);while(this.pdfiumModule.FPDFText_FindNext(m)){const e=this.pdfiumModule.FPDFText_GetSchResultIndex(m),n=this.pdfiumModule.FPDFText_GetSchCount(m),r=this.getHighlightRects(t,o,e,n),a=this.buildContext(s,e,n);u.push({pageIndex:t.index,charIndex:e,charCount:n,rects:r,context:a})}return this.pdfiumModule.FPDFText_FindClose(m),u})}preparePrintDocument(e,t){const{includeAnnotations:n=!0,pageRange:r=null}=t??{};this.logger.debug(L,N,"preparePrintDocument",e,t),this.logger.perf(L,N,"PreparePrintDocument","Begin",e.id);const o=this.cache.getContext(e.id);if(!o)return this.logger.perf(L,N,"PreparePrintDocument","End",e.id),s.m.reject({code:s.iW.DocNotOpen,message:"Document is not open"});const a=this.pdfiumModule.FPDF_CreateNewDocument();if(!a)return this.logger.perf(L,N,"PreparePrintDocument","End",e.id),s.m.reject({code:s.iW.CantCreateNewDoc,message:"Cannot create print document"});try{const t=this.sanitizePageRange(r,e.pageCount);if(!this.pdfiumModule.FPDF_ImportPages(a,o.docPtr,t??"",0))return this.pdfiumModule.FPDF_CloseDocument(a),this.logger.error(L,N,"Failed to import pages for printing"),this.logger.perf(L,N,"PreparePrintDocument","End",e.id),s.m.reject({code:s.iW.CantImportPages,message:"Failed to import pages for printing"});if(!n){const t=this.removeAnnotationsFromPrintDocument(a);if(!t.success)return this.pdfiumModule.FPDF_CloseDocument(a),this.logger.error(L,N,`Failed to remove annotations: ${t.error}`),this.logger.perf(L,N,"PreparePrintDocument","End",e.id),s.m.reject({code:s.iW.Unknown,message:`Failed to prepare print document: ${t.error}`});this.logger.debug(L,N,`Removed ${t.annotationsRemoved} annotations from ${t.pagesProcessed} pages`)}const i=this.saveDocument(a);return this.pdfiumModule.FPDF_CloseDocument(a),this.logger.perf(L,N,"PreparePrintDocument","End",e.id),s.m.resolve(i)}catch(i){return a&&this.pdfiumModule.FPDF_CloseDocument(a),this.logger.error(L,N,"preparePrintDocument failed",i),this.logger.perf(L,N,"PreparePrintDocument","End",e.id),s.m.reject({code:s.iW.Unknown,message:i instanceof Error?i.message:"Failed to prepare print document"})}}removeAnnotationsFromPrintDocument(e){let t=0,n=0;try{const r=this.pdfiumModule.FPDF_GetPageCount(e);for(let o=0;o<r;o++){const r=this.pdfiumModule.EPDFPage_GetAnnotCountRaw(e,o);if(r<=0){n++;continue}let a=0;for(let n=r-1;n>=0;n--){const r=this.pdfiumModule.EPDFPage_RemoveAnnotRaw(e,o,n);r?(a++,t++):this.logger.warn(L,N,`Failed to remove annotation ${n} from page ${o}`)}if(a>0){const t=this.pdfiumModule.FPDF_LoadPage(e,o);t&&(this.pdfiumModule.FPDFPage_GenerateContent(t),this.pdfiumModule.FPDF_ClosePage(t))}n++}return{success:!0,annotationsRemoved:t,pagesProcessed:n}}catch(r){return{success:!1,annotationsRemoved:t,pagesProcessed:n,error:r instanceof Error?r.message:"Unknown error during annotation removal"}}}sanitizePageRange(e,t){if(!e||""===e.trim())return null;try{const n=[],r=e.split(",");for(const e of r){const r=e.trim();if(r.includes("-")){const[e,o]=r.split("-").map(e=>e.trim()),a=parseInt(e,10),i=parseInt(o,10);if(isNaN(a)||isNaN(i)){this.logger.warn(L,N,`Invalid range: ${r}`);continue}const s=Math.max(1,Math.min(a,t)),u=Math.max(1,Math.min(i,t));for(let t=s;t<=u;t++)n.includes(t)||n.push(t)}else{const e=parseInt(r,10);if(isNaN(e)){this.logger.warn(L,N,`Invalid page number: ${r}`);continue}const o=Math.max(1,Math.min(e,t));n.includes(o)||n.push(o)}}if(0===n.length)return this.logger.warn(L,N,"No valid pages in range, using all pages"),null;n.sort((e,t)=>e-t);const o=[];let a=n[0],i=n[0];for(let e=1;e<n.length;e++)n[e]===i+1||(a===i?o.push(a.toString()):i-a===1?(o.push(a.toString()),o.push(i.toString())):o.push(`${a}-${i}`),a=n[e]),i=n[e];a===i?o.push(a.toString()):i-a===1?(o.push(a.toString()),o.push(i.toString())):o.push(`${a}-${i}`);const s=o.join(",");return this.logger.debug(L,N,`Sanitized page range: "${e}" -> "${s}"`),s}catch(n){return this.logger.error(L,N,`Error sanitizing page range: ${n}`),null}}}async function U(e,t){const n=await fetch(e),r=await n.arrayBuffer(),o=await i({wasmBinary:r}),a=new V(o,{logger:null==t?void 0:t.logger,fontFallback:null==t?void 0:t.fontFallback});return new u.P(a,{imageConverter:m.b,logger:null==t?void 0:t.logger})}}}]);
//# sourceMappingURL=926.cf6a953d.js.map